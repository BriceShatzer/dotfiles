{"created_by":"Tampermonkey","version":"1","scripts":[{"name":"Hacker News collapsible comments","options":{"awareOfChrome":false,"check_for_updates":true,"comment":null,"compat_arrayleft":false,"compat_foreach":false,"compat_forvarin":false,"compat_metadata":false,"compat_uW_gmonkey":false,"compat_wrappedjsobject":false,"compatopts_for_requires":true,"noframes":null,"override":{"merge_connects":true,"merge_excludes":true,"merge_includes":true,"merge_matches":true,"orig_excludes":[],"orig_includes":["https://news.ycombinator.com/item?id=*","https://news.ycombinator.com/threads?*","https://news.ycombinator.com/x?fnid=*"],"orig_matches":["https://news.ycombinator.com/item?id=*","https://news.ycombinator.com/threads?*","https://news.ycombinator.com/x?fnid=*"],"orig_noframes":null,"orig_run_at":"document-idle","use_connects":[],"use_excludes":[],"use_includes":[],"use_matches":[]},"run_at":null},"storage":{"data":{},"ts":1509040351005},"enabled":true,"position":1,"file_url":"https://greasyfork.org/scripts/2960-hacker-news-collapsible-comments/code/Hacker%20News%20collapsible%20comments.user.js","uuid":"7119b1fb-fcf9-4630-8da3-9acfa4cde5cd","source":"Ly8gPT1Vc2VyU2NyaXB0PT0KLy8gQG5hbWUJCQlIYWNrZXIgTmV3cyBjb2xsYXBzaWJsZSBjb21tZW50cwovLyBAbmFtZXNwYWNlICAgICAgICAgICAgICAgICAgIGhhY2tlcm5ld3Njb2xsYXBzZWNvbW1lbnRzCi8vIEBkZXNjcmlwdGlvbgkJICAgICAgICBSZWRkaXQgc3R5bGUgY29sbGFwc2libGUgY29tbWVudHMgZm9yIEhhY2tlciBOZXdzCi8vIEB2ZXJzaW9uCQkJMS4wCi8vIEBhdXRob3IJCQlrYWl4aQovLyBAaG9tZXBhZ2UJCSAgICAgICAgaHR0cDovL3VzZXJzY3JpcHRzLm9yZy9zY3JpcHRzL3Nob3cvMTM4MDM3Ci8vIEBpbmNsdWRlCQkJaHR0cHM6Ly9uZXdzLnljb21iaW5hdG9yLmNvbS9pdGVtP2lkPSoKLy8gQGluY2x1ZGUJCQlodHRwczovL25ld3MueWNvbWJpbmF0b3IuY29tL3RocmVhZHM/KgovLyBAaW5jbHVkZQkJCWh0dHBzOi8vbmV3cy55Y29tYmluYXRvci5jb20veD9mbmlkPSoKLy8gQG1hdGNoCQkJaHR0cHM6Ly9uZXdzLnljb21iaW5hdG9yLmNvbS9pdGVtP2lkPSoKLy8gQG1hdGNoCQkJaHR0cHM6Ly9uZXdzLnljb21iaW5hdG9yLmNvbS90aHJlYWRzPyoKLy8gQG1hdGNoCQkJaHR0cHM6Ly9uZXdzLnljb21iaW5hdG9yLmNvbS94P2ZuaWQ9KgovLyBAZ3JhbnQgICAgICAgICAgIG5vbmUKLy8gPT0vVXNlclNjcmlwdD09Cgp2YXIgaW5pdCA9IGZ1bmN0aW9uKCkgewoJLy8gQ1NTIHN0eWxlcyBmb3IgdGhlIHRvZ2dsZSBidXR0b24KCXZhciBzdHlsZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3N0eWxlJyk7CglzdHlsZS5pbm5lckhUTUwgPSAnLnRvZ2dsZV9idXR0b24geyBjdXJzb3I6IHBvaW50ZXI7IGZvbnQtc2l6ZTogMTBweDsgbWFyZ2luLXJpZ2h0OiA1cHg7IHBhZGRpbmc6IDAgMXB4IDFweDsgfScKCQkJCQkJKyAnIC5ob3ZlciB7IGJhY2tncm91bmQ6ICM4MjgyODI7IGNvbG9yOiAjZjZmNmVmOyB9JzsKCWRvY3VtZW50LmhlYWQuYXBwZW5kQ2hpbGQoc3R5bGUpOwoKCS8vIEZpbmQgYWxsIHRoZSBjb21tZW50cwoJdmFyIGNvbW1lbnRzID0gW107CgkJaSA9IDA7CgkkKCd0ZC5kZWZhdWx0JykuZWFjaChmdW5jdGlvbigpIHsKCQl2YXIgY29tbWVudCA9ICQoJCh0aGlzKS5wYXJlbnRzKCd0cicpWzFdKS5hZGRDbGFzcygnY29sbGFwc2libGUnKS5hdHRyKCdpZCcsIGkgKyAnX2NvbW1lbnQnKTsKCQljb21tZW50cy5wdXNoKHsKCQkJY29udGFpbmVyOiBjb21tZW50LAoJCQlpbmRlbnRhdGlvbjogY29tbWVudC5maW5kKCdpbWcnKS5maXJzdCgpWzBdLndpZHRoCgkJfSk7CgkJKytpOwoJfSk7CgoJJCgnPHNwYW4+PC9zcGFuPicsIHsKCQl0ZXh0OiAnW+KAk10nLAoJCWNsYXNzOiAndG9nZ2xlX2J1dHRvbicKCX0pCgkJLmluc2VydEJlZm9yZSgnZGl2ID4gLmNvbWhlYWQnKQoJCS5vbignbW91c2VlbnRlcicsIGZ1bmN0aW9uKCkgewoJCQkkKHRoaXMpLmFkZENsYXNzKCdob3ZlcicpOwoJCX0pCgkJLm9uKCdtb3VzZWxlYXZlJywgZnVuY3Rpb24oKSB7CgkJCSQodGhpcykucmVtb3ZlQ2xhc3MoJ2hvdmVyJyk7CgkJfSkKCQkub24oJ2NsaWNrJywgZnVuY3Rpb24oKSB7CgkJCXZhciAkdGhpcyA9ICQodGhpcyksCgkJCQljdXJyZW50X2lkID0gcGFyc2VJbnQoJHRoaXMuY2xvc2VzdCgndHIuY29sbGFwc2libGUnKS5hdHRyKCdpZCcpKSwKCQkJCWkgPSBjdXJyZW50X2lkICsgMSwKCQkJCWNoaWxkcmVuX2NvdW50ID0gMDsKCQkJLy8gVG9nZ2xlIGNoaWxkIGNvbW1lbnRzCgkJCXdoaWxlKGkgPCBjb21tZW50cy5sZW5ndGggJiYgY29tbWVudHNbaV0uaW5kZW50YXRpb24gPiBjb21tZW50c1tjdXJyZW50X2lkXS5pbmRlbnRhdGlvbikgewoJCQkJY29tbWVudHNbaV0uY29udGFpbmVyLnRvZ2dsZSgpOwoJCQkJLy8gU2tpcCBjb21tZW50cyB0aGF0IHNob3VsZG4ndCBiZSB0b2dnbGVkCgkJCQlpZiAoL1srXS9pLnRlc3QoY29tbWVudHNbaV0uY29udGFpbmVyLmZpbmQoJ3NwYW4udG9nZ2xlX2J1dHRvbicpLnRleHQoKSkpIHsKCQkJCQl2YXIgaiA9IGkgKyAxOwoJCQkJCXdoaWxlKGogPCBjb21tZW50cy5sZW5ndGggJiYgY29tbWVudHNbal0uaW5kZW50YXRpb24gPiBjb21tZW50c1tpXS5pbmRlbnRhdGlvbikgewoJCQkJCQlqKys7CgkJCQkJfQoJCQkJCWkgPSBqOwoJCQkJfSBlbHNlIHsKCQkJCQlpKys7CgkJCQl9CgkJCX0KCQkJLy8gVG9nZ2xlIGN1cnJlbnQgY29tbWVudCAJCgkJCXZhciBjb250ZW50ID0gY29tbWVudHNbY3VycmVudF9pZF0uY29udGFpbmVyLmZpbmQoJ3NwYW4uY29tbWVudCcpLnRvZ2dsZSgpLm5leHQoKS50b2dnbGUoKS5lbmQoKTsKCQkJaWYgKGNvbnRlbnQuaXMoJzp2aXNpYmxlJykpIHsKCQkJCSR0aGlzLnRleHQoJ1vigJNdJyk7CgkJCX0gZWxzZSB7CgkJCQkkdGhpcy50ZXh0KCdbK10nKTsgICAgICAgICAgICAgICAgICAgCgkJCX0KCQl9KTsKfTsKCi8vIENyZWRpdDogaHR0cDovL2VyaWt2b2xkLmNvbS9ibG9nL2luZGV4LmNmbS8yMDEwLzYvMTQvdXNpbmctanF1ZXJ5LXdpdGgtYS11c2VyLXNjcmlwdAooZnVuY3Rpb24oZm4pIHsKCXZhciBzY3JpcHQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzY3JpcHQnKTsKCXNjcmlwdC5zcmMgPSAnaHR0cHM6Ly9hamF4Lmdvb2dsZWFwaXMuY29tL2FqYXgvbGlicy9qcXVlcnkvMi4wLjMvanF1ZXJ5Lm1pbi5qcyc7CglzY3JpcHQuYWRkRXZlbnRMaXN0ZW5lcignbG9hZCcsIGZ1bmN0aW9uKCkgewoJCXZhciBzY3JpcHQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzY3JpcHQnKTsKCQlzY3JpcHQudGV4dENvbnRlbnQgPSAnalF1ZXJ5Lm5vQ29uZmxpY3QoKTsoZnVuY3Rpb24oJCl7KCcgKyBmbi50b1N0cmluZygpICsgJykoKTt9KShqUXVlcnkpOyc7CgkJZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChzY3JpcHQpOwoJfSwgZmFsc2UpOwoJZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChzY3JpcHQpOwp9KShpbml0KTs="},{"name":"Google Calendar Weekend Highlighter","options":{"awareOfChrome":false,"check_for_updates":true,"comment":null,"compat_arrayleft":false,"compat_foreach":false,"compat_forvarin":false,"compat_metadata":false,"compat_uW_gmonkey":false,"compat_wrappedjsobject":false,"compatopts_for_requires":true,"noframes":null,"override":{"merge_connects":true,"merge_excludes":true,"merge_includes":true,"merge_matches":true,"orig_connects":[],"orig_excludes":[],"orig_includes":[],"orig_matches":["https://calendar.google.com/calendar/*"],"orig_noframes":null,"orig_run_at":"document-idle","use_connects":[],"use_excludes":[],"use_includes":[],"use_matches":[]},"run_at":null},"storage":{"data":{},"ts":1509040351008},"enabled":false,"position":2,"uuid":"eb2f835e-7dfa-4701-ba6d-2c354830f72e","source":"Ly8gPT1Vc2VyU2NyaXB0PT0KLy8gQG5hbWUgICAgICAgICBHb29nbGUgQ2FsZW5kYXIgV2Vla2VuZCBIaWdobGlnaHRlcgovLyBAbmFtZXNwYWNlICAgIGh0dHBzOi8vY2FsZW5kYXIuZ29vZ2xlLmNvbS9jYWxlbmRhci8KLy8gQHZlcnNpb24gICAgICAwLjEKLy8gQGRlc2NyaXB0aW9uICBIaWdobGlnaHQgdGhlIHdlZWtlbmQgZGF5cyBpbiBHb29nbGUgQ2FsZW5kYXIncyBtb250aCB2aWV3Ci8vIEBhdXRob3IgICAgICAgaHR0cHM6Ly9naXRodWIuY29tL0JyaWNlU2hhdHplcgovLyBAbWF0Y2ggICAgICAgIGh0dHBzOi8vY2FsZW5kYXIuZ29vZ2xlLmNvbS9jYWxlbmRhci8qCi8vIEBncmFudCAgICAgICAgR01fYWRkU3R5bGUKLy8gPT0vVXNlclNjcmlwdD09Ci8qIGpzaGludCAtVzA5NyAqLwovLyd1c2Ugc3RyaWN0JzsKCnZhciBjb2x1bW5zVG9DaGFuZ2UgPSBbXTsKdmFyIGxhYmVscyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5tdi1kYXluYW1lJyk7CnZhciByb3dzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLm1vbnRoLXJvdyAuc3QtYmctdGFibGUgdHIsIC5tb250aC1yb3cgLnN0LWdyaWQgdHI6Zmlyc3Qtb2YtdHlwZScpOwp2YXIgYmdDb2xvciA9ICdMaWdodEdvbGRlblJvZFllbGxvdyc7CgpmdW5jdGlvbiBmb3JFYWNoKGFycmF5LCBmdW5jKXsKICAgIEFycmF5LnByb3RvdHlwZS5mb3JFYWNoLmNhbGwoYXJyYXksIGZ1bmMpOwp9Cgpmb3JFYWNoKGxhYmVscywgZnVuY3Rpb24obGFiZWwsaSl7CiAgICBpZihsYWJlbC50aXRsZSA9PT0gIlNhdCIgfHwgbGFiZWwudGl0bGUgPT09ICJTdW4iKXsKICAgICAgICBjb2x1bW5zVG9DaGFuZ2UucHVzaChpKTsKICAgIH0KfSk7Cgpmb3JFYWNoKHJvd3MsIGZ1bmN0aW9uKHJvdyl7CiAgICBjb2x1bW5zVG9DaGFuZ2UuZm9yRWFjaChmdW5jdGlvbih2YWx1ZSl7CiAgICAgICAgdmFsdWUrPTE7CiAgICAgICAgR01fYWRkU3R5bGUoIi5tb250aC1yb3cgLnN0LWJnLXRhYmxlIHRyIHRkOm50aC1vZi10eXBlKCIrdmFsdWUrIiksIC5tb250aC1yb3cgLnN0LWdyaWQgdHI6Zmlyc3Qtb2YtdHlwZSB0ZDpudGgtb2YtdHlwZSgiK3ZhbHVlKyIpe2JhY2tncm91bmQtY29sb3I6IitiZ0NvbG9yKyJ9Iik7CiAgICB9KTsKfSk7Cg=="},{"name":"Improve usablity of docs on sass-lang.com","options":{"awareOfChrome":false,"check_for_updates":true,"comment":null,"compat_arrayleft":false,"compat_foreach":false,"compat_forvarin":false,"compat_metadata":false,"compat_uW_gmonkey":false,"compat_wrappedjsobject":false,"compatopts_for_requires":true,"noframes":null,"override":{"merge_connects":true,"merge_excludes":true,"merge_includes":true,"merge_matches":true,"orig_connects":[],"orig_excludes":[],"orig_includes":[],"orig_matches":["*://sass-lang.com/documentation/file.SASS_REFERENCE.html"],"orig_noframes":null,"orig_run_at":"document-idle","use_connects":[],"use_excludes":[],"use_includes":[],"use_matches":[]},"run_at":null},"storage":{"data":{},"ts":1509040351012},"enabled":true,"position":3,"file_url":"Make sass-docs table of contents usable","uuid":"a6128fe6-cb43-4c2a-98f4-ab865b54741c","source":"Ly8gPT1Vc2VyU2NyaXB0PT0KLy8gQG5hbWUgICAgICAgICBJbXByb3ZlIHVzYWJsaXR5IG9mIGRvY3Mgb24gc2Fzcy1sYW5nLmNvbQovLyBAbmFtZXNwYWNlICAgIGh0dHA6Ly9zYXNzLWxhbmcuY29tL2RvY3VtZW50YXRpb24vCi8vIEB2ZXJzaW9uICAgICAgMS4wCi8vIEBkZXNjcmlwdGlvbiAgTWFrZSBkb2N1bWVudGF0aW9uIHBhZ2Ugb24gc2Fzcy1sYW5nLmNvbSBtb3JlIHVzYWJsZSBieSBmaXhpbmcgdGhlIFRPQyB0byB0aGUgcmlnaHQgc2lkZSBvZiB0aGUgdmlld3BvcnQuCi8vIEBhdXRob3IgICAgICAgaHR0cDovL2dpdGh1Yi5jb20vQnJpY2VTaGF0emVyCi8vIEBtYXRjaCAgICAgICAgKjovL3Nhc3MtbGFuZy5jb20vZG9jdW1lbnRhdGlvbi9maWxlLlNBU1NfUkVGRVJFTkNFLmh0bWwKLy8gQGdyYW50ICAgICAgICBHTV9hZGRTdHlsZQovLyA9PS9Vc2VyU2NyaXB0PT0KLyoganNoaW50IC1XMDk3ICovCid1c2Ugc3RyaWN0JzsKCkdNX2FkZFN0eWxlKCcjdG9je3Bvc2l0aW9uOiBmaXhlZDsgcmlnaHQ6IDA7dG9wOiAwOyBvdmVyZmxvdy15OiBzY3JvbGw7IG1hcmdpbi1sZWZ0OjA7aGVpZ2h0OiAxMDAlO30nKTsKCkdNX2FkZFN0eWxlKCcjY29udGVudHtwYWRkaW5nLXJpZ2h0OicrZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3RvYycpLnNjcm9sbFdpZHRoKydweDt9Jyk7"},{"name":"Fixing issues cause by Lastpass","options":{"awareOfChrome":false,"check_for_updates":true,"comment":null,"compat_arrayleft":false,"compat_foreach":false,"compat_forvarin":false,"compat_metadata":false,"compat_uW_gmonkey":false,"compat_wrappedjsobject":false,"compatopts_for_requires":true,"noframes":null,"override":{"merge_connects":true,"merge_excludes":true,"merge_includes":true,"merge_matches":true,"orig_excludes":[],"orig_includes":[],"orig_matches":["https://timelord.doejo.com/*","https://onlinebanking.ecu.com/*"],"orig_noframes":null,"orig_run_at":"document-idle","use_connects":[],"use_excludes":[],"use_includes":[],"use_matches":[]},"run_at":null},"storage":{"data":{},"ts":1509040351014},"enabled":true,"position":4,"uuid":"9bf0148b-4e85-44af-8d75-7d63ccc53983","source":"Ly8gPT1Vc2VyU2NyaXB0PT0KLy8gQG5hbWUgICAgICAgICBGaXhpbmcgaXNzdWVzIGNhdXNlIGJ5IExhc3RwYXNzCi8vIEBuYW1lc3BhY2UgICAgaHR0cDovL3RhbXBlcm1vbmtleS5uZXQvCi8vIEB2ZXJzaW9uICAgICAgMC4xCi8vIEBkZXNjcmlwdGlvbiAgSGlkZGluZyB0aGUgIkZvcm0gRmlsbCIgaWNvbiB0aGF0IGxhc3QgcGFzcyBhZGRzIHRvIHVucmVjb2duaXphYmxlIGZvcm0gaW5wdXRzCi8vIEBhdXRob3IgICAgICAgQnJpY2VTaGF0emVyCi8vIEBtYXRjaCAgICAgICAgaHR0cHM6Ly90aW1lbG9yZC5kb2Vqby5jb20vKgovLyBAbWF0Y2ggICAgICAgIGh0dHBzOi8vb25saW5lYmFua2luZy5lY3UuY29tLyoKLy8gQGdyYW50ICAgICAgICBHTV9hZGRTdHlsZQovLyA9PS9Vc2VyU2NyaXB0PT0KLyoganNoaW50IC1XMDk3ICovCid1c2Ugc3RyaWN0JzsKCmlmKGRvY3VtZW50LmxvY2F0aW9uLmhvc3RuYW1lLmluZGV4T2YoJ29ubGluZWJhbmtpbmcuZWN1LmNvbScpPi0xKXsgICAgCiAgIEdNX2FkZFN0eWxlKCIjdHJhbnNmZXJfYW1vdW50e3RleHQtYWxpZ246bGVmdH0iKTsKfQoKaWYoZG9jdW1lbnQubG9jYXRpb24uaG9zdG5hbWUuaW5kZXhPZigndGltZWxvcmQuZG9lam8uY29tJyk+LTEpewogICAgR01fYWRkU3R5bGUoImRpdltpZF49J19fbHBmb3JtX2lucHV0J117ZGlzcGxheTpub25lICFpbXBvcnRhbnR9Iik7Cn0KCg=="},{"name":"Add link to hourly view on RescueTime","options":{"awareOfChrome":false,"check_for_updates":true,"comment":null,"compat_arrayleft":false,"compat_foreach":false,"compat_forvarin":false,"compat_metadata":false,"compat_uW_gmonkey":false,"compat_wrappedjsobject":false,"compatopts_for_requires":true,"noframes":null,"override":{"merge_connects":true,"merge_excludes":true,"merge_includes":true,"merge_matches":true,"orig_excludes":[],"orig_includes":[],"orig_matches":["https://www.rescuetime.com/dashboard?*","https://www.rescuetime.com/dashboard/for/the/day/of/*"],"orig_noframes":null,"orig_run_at":"document-idle","use_connects":[],"use_excludes":[],"use_includes":[],"use_matches":[]},"run_at":null},"storage":{"data":{},"ts":1509040351016},"enabled":true,"position":5,"uuid":"52630e59-1bcc-424a-9dac-6ddce3c10ec0","source":"Ly8gPT1Vc2VyU2NyaXB0PT0KLy8gQG5hbWUgICAgICAgICBBZGQgbGluayB0byBob3VybHkgdmlldyBvbiBSZXNjdWVUaW1lCi8vIEBuYW1lc3BhY2UgICAgaHR0cHM6Ly93d3cucmVzY3VldGltZS5jb20vZGFzaGJvYXJkCi8vIEB2ZXJzaW9uICAgICAgMC4xCi8vIEBkZXNjcmlwdGlvbiAgSW5qZWN0IGEgbGluayB0byB0aGUgaG91cmx5IHZpZXcgb24gdGhlIFJlc2N1ZVRpbWUgZGFzaGJvYXJkIHBhZ2VzLgovLyBAYXV0aG9yICAgICAgIGh0dHA6Ly9naXRodWIuY29tL0JyaWNlU2hhdHplcgovLyBAbWF0Y2ggICAgICAgIGh0dHBzOi8vd3d3LnJlc2N1ZXRpbWUuY29tL2Rhc2hib2FyZD8qCi8vIEBtYXRjaCAgICAgICAgaHR0cHM6Ly93d3cucmVzY3VldGltZS5jb20vZGFzaGJvYXJkL2Zvci90aGUvZGF5L29mLyoKLy8gQGdyYW50ICAgICAgICBub25lCi8vID09L1VzZXJTY3JpcHQ9PQovKiBqc2hpbnQgLVcwOTcgKi8KJ3VzZSBzdHJpY3QnOwoKdmFyIHBhdGggPSBkb2N1bWVudC5sb2NhdGlvbi5wYXRobmFtZQp2YXIgbGluayA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EnKTsKdmFyIGRhdGUgPSAnJzsKCmZ1bmN0aW9uIHBhcnNlT3V0RGF0ZShzdHJpbmcpewogICAgcmV0dXJuIHN0cmluZy5zdWJzdHJpbmcoc3RyaW5nLmxhc3RJbmRleE9mKCcvJykrMSk7Cn0KCgppZiAoIC9kYXNoYm9hcmRcL2ZvclwvdGhlXC9kYXlcL29mLy50ZXN0LnBhdGggKXsKICAgIGRhdGUgPSBwYXJzZU91dERhdGUocGF0aCk7Cn0gZWxzZSB7CiAgICBkYXRlID0gcGFyc2VPdXREYXRlKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNkYXNoYm9hcmQtb3ZlcnZpZXctbGlzdCBhJykuaHJlZik7Cn0KLy9zZXQgbGluayBhdHRyaWJ1dGVzIApsaW5rLmFwcGVuZENoaWxkKCBkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZSgnU2VlIEhvdXJseSBPdmVydmlldycpICkKbGluay5zdHlsZT0gJ2ZvbnQtd2VpZ2h0OmJvbGQ7JysKICAgICAgICAgICAgJ2ZvbnQtc2l6ZToyMHB4OycrCiAgICAgICAgICAgICdtYXJnaW4tbGVmdDogMjBweDsnKwogICAgICAgICAgICAncGFkZGluZzoxMHB4OycrCiAgICAgICAgICAgICdjb2xvcjogIzg4ODsnKwogICAgICAgICAgICAnYmFja2dyb3VuZC1jb2xvcjogI2ZmZjsnKwogICAgICAgICAgICAnYm9yZGVyLXJhZGl1czogM3B4OycrCiAgICAgICAgICAgICdib3JkZXI6c29saWQgMXB4ICM2Mzc3ODc7JwpsaW5rLmhyZWY9ICdodHRwczovL3d3dy5yZXNjdWV0aW1lLmNvbS9icm93c2Uvb3ZlcnZpZXcvYnkvaG91ci9mb3IvdGhlL2RheS9vZi8nK2RhdGU7CgoKZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI3BhZ2UtY29udGVudC1oZWFkZXIgaDEnKS5hcHBlbmRDaGlsZChsaW5rKTsK"},{"name":"Auto-set Timecalc to today","options":{"awareOfChrome":false,"check_for_updates":true,"comment":null,"compat_arrayleft":false,"compat_foreach":false,"compat_forvarin":false,"compat_metadata":false,"compat_uW_gmonkey":false,"compat_wrappedjsobject":false,"compatopts_for_requires":true,"noframes":null,"override":{"merge_connects":true,"merge_excludes":true,"merge_includes":true,"merge_matches":true,"orig_excludes":[],"orig_includes":[],"orig_matches":["http://www.timeanddate.com/date/timeduration.html"],"orig_noframes":null,"orig_run_at":"document-idle","use_connects":[],"use_excludes":[],"use_includes":[],"use_matches":[]},"run_at":null},"storage":{"data":{},"ts":1509040351019},"enabled":true,"position":6,"uuid":"98fb6504-d21a-4eff-87b0-30630f679fd8","source":"Ly8gPT1Vc2VyU2NyaXB0PT0KLy8gQG5hbWUgICAgICAgICBBdXRvLXNldCBUaW1lY2FsYyB0byB0b2RheQovLyBAbmFtZXNwYWNlICAgIGh0dHA6Ly93d3cudGltZWFuZGRhdGUuY29tL2RhdGUvdGltZWR1cmF0aW9uLmh0bWwKLy8gQHZlcnNpb24gICAgICAwLjEKLy8gQGRlc2NyaXB0aW9uICBUcmlnZ2VyIHRoZSAnVG9kYXknIGNsaWNrIGhhbmRsZXJzIGZvciB0aGUgU3RhcnQgJiBFbmQgZGF0ZXMgb24gbG9hZAovLyBAYXV0aG9yICAgICAgIGh0dHBzOi8vZ2l0aHViLmNvbS9CcmljZVNoYXR6ZXIKLy8gQG1hdGNoICAgICAgICBodHRwOi8vd3d3LnRpbWVhbmRkYXRlLmNvbS9kYXRlL3RpbWVkdXJhdGlvbi5odG1sCi8vIEBncmFudCAgICAgICAgbm9uZQovLyA9PS9Vc2VyU2NyaXB0PT0KLyoganNoaW50IC1XMDk3ICovCid1c2Ugc3RyaWN0JzsKCnZhciB0b2RheUxpbmtzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnYVt0aXRsZSQ9IkRhdGUgdG8gdG9kYXlcJ3MgZGF0ZS4iXScpOwoKdG9kYXlMaW5rc1swXS5vbmNsaWNrLmFwcGx5KHRvZGF5TGlua3NbMF0pOwp0b2RheUxpbmtzWzFdLm9uY2xpY2suYXBwbHkodG9kYXlMaW5rc1sxXSk7CgppZih0b2RheUxpbmtzLmxlbmd0aD4yKXsKICAgIGFsZXJ0KCd0aGUgdXNlcnNjcmlwdCB0aGF0IGhhcyBiZWVuIHNldHVwIGZvciB0aGlzIHBhZ2UgbWF5IG5vIGxvbmdlciBiZSB2YWxpZCAnKTsKfQ=="},{"name":"GitHub Pull Request File View - Collapse All","options":{"awareOfChrome":false,"check_for_updates":true,"comment":null,"compat_arrayleft":false,"compat_foreach":false,"compat_forvarin":false,"compat_metadata":false,"compat_uW_gmonkey":false,"compat_wrappedjsobject":false,"compatopts_for_requires":true,"noframes":null,"override":{"merge_connects":true,"merge_excludes":true,"merge_includes":true,"merge_matches":true,"orig_connects":[],"orig_excludes":[],"orig_includes":[],"orig_matches":["https://github.com/*/pull/*/files","https://github.com/*/pull/*/commits","https://github.com/*/commit/*","https://github.com/*/commits/*"],"orig_noframes":null,"orig_run_at":"document-idle","use_blockers":[],"use_connects":[],"use_excludes":[],"use_includes":[],"use_matches":[]},"run_at":null},"storage":{"ts":1509400832430,"data":{}},"enabled":false,"position":7,"uuid":"e97c43de-914f-4107-895d-c558c8fba783","source":"Ly8gPT1Vc2VyU2NyaXB0PT0KLy8gQG5hbWUgICAgICAgICBHaXRIdWIgUHVsbCBSZXF1ZXN0IEZpbGUgVmlldyAtIENvbGxhcHNlIEFsbAovLyBAbmFtZXNwYWNlICAgIGh0dHBzOi8vZ2l0aHViLmNvbS8KLy8gQHZlcnNpb24gICAgICAwLjEKLy8gQGRlc2NyaXB0aW9uICBTZWUgTmFtZQovLyBAYXV0aG9yICAgICAgIGh0dHBzOi8vZ2l0aHViLmNvbS9CcmljZVNoYXR6ZXIKLy8gQG1hdGNoICAgICAgICBodHRwczovL2dpdGh1Yi5jb20vKi9wdWxsLyovZmlsZXMKLy8gQG1hdGNoICAgICAgICBodHRwczovL2dpdGh1Yi5jb20vKi9wdWxsLyovY29tbWl0cwovLyBAbWF0Y2ggICAgICAgIGh0dHBzOi8vZ2l0aHViLmNvbS8qL2NvbW1pdC8qCi8vIEBtYXRjaCAgICAgICAgaHR0cHM6Ly9naXRodWIuY29tLyovY29tbWl0cy8qCi8vIEBncmFudCAgICAgICAgbm9uZQovLyA9PS9Vc2VyU2NyaXB0PT0KCihmdW5jdGlvbigpIHsKLy8gICAgJ3VzZSBzdHJpY3QnOwoKICAgIGxldCBlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicpOwogICAgZWwuc2V0QXR0cmlidXRlKCdzdHlsZScsJ3Bvc2l0aW9uOmZpeGVkO2xlZnQ6MnJlbTtib3R0b206NTB2aDt6LWluZGV4OjU7Jyk7CiAgICBlbC5zZXRBdHRyaWJ1dGUoJ2NsYXNzJywgJ2J0bicpOwogICAgZWwuaW5uZXJIVE1MID0gJ0NvbGxhcHNlIERpZmZzJzsKICAgIGVsLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywoKT0+ewoKICAgICAgICBpZihlbC5pbm5lckhUTUwgPT09ICdDb2xsYXBzZSBEaWZmcycpewogICAgICAgICAgICBjb2xsYXBzZURpZmZzKCk7CiAgICAgICAgICAgIGVsLmlubmVySFRNTCA9ICdFeHBhbmQgRGlmZnMnOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGV4cGFuZERpZmZzKCk7CiAgICAgICAgICAgIGVsLmlubmVySFRNTCA9ICdDb2xsYXBzZSBEaWZmcyc7CiAgICAgICAgfQoKICAgIH0pOwogICAgZG9jdW1lbnQuYm9keS5hcHBlbmQoZWwpOwoKCiAgICBmdW5jdGlvbiBleHBhbmREaWZmcygpIHsKICAgICAgICBsZXQgY29sbGFwc2VkRWxlbWVudHMgPSBPYmplY3QudmFsdWVzKGdldEVsZW1lbnRzKCkpLmZpbHRlcihlbD0+IGVsLmdldEF0dHJpYnV0ZSgnYXJpYS1leHBhbmRlZCcpPT09J2ZhbHNlJyk7CiAgICAgICAgY2xpY2tFbGVtZW50cyhjb2xsYXBzZWRFbGVtZW50cyk7CiAgICB9CgogICAgZnVuY3Rpb24gY29sbGFwc2VEaWZmcygpIHsKICAgICAgICBsZXQgZXhwYW5kZWRFbGVtZW50cyA9IE9iamVjdC52YWx1ZXMoZ2V0RWxlbWVudHMoKSkuZmlsdGVyKGVsPT4gZWwuZ2V0QXR0cmlidXRlKCdhcmlhLWV4cGFuZGVkJyk9PT0ndHJ1ZScpOwogICAgICAgIGNsaWNrRWxlbWVudHMoZXhwYW5kZWRFbGVtZW50cyk7CiAgICB9CgogICAgZnVuY3Rpb24gZ2V0RWxlbWVudHMoKSB7CiAgICAgICAgbGV0IGFsbEVsZW1lbnRzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnYnV0dG9uW2FyaWEtbGFiZWw9IlRvZ2dsZSBkaWZmIHRleHQiXScpOwogICAgICAgIHJldHVybiBhbGxFbGVtZW50czsKICAgIH0KCiAgICBmdW5jdGlvbiBjbGlja0VsZW1lbnRzKGVsZW1lbnRzQXJyKSB7CiAgICAgICAgZWxlbWVudHNBcnIuZm9yRWFjaCgoZWwpPT57CiAgICAgICAgICAgIGVsLmNsaWNrKCk7CiAgICAgICAgfSk7CiAgICB9Cgp9KSgpOw=="},{"name":"Universal GitHub Tasks","options":{"awareOfChrome":false,"check_for_updates":true,"comment":null,"compat_arrayleft":false,"compat_foreach":false,"compat_forvarin":false,"compat_metadata":false,"compat_uW_gmonkey":false,"compat_wrappedjsobject":false,"compatopts_for_requires":true,"noframes":null,"override":{"merge_connects":true,"merge_excludes":true,"merge_includes":true,"merge_matches":true,"orig_connects":[],"orig_excludes":[],"orig_includes":[],"orig_matches":["https://github.com/*"],"orig_noframes":null,"orig_run_at":"document-idle","use_blockers":[],"use_connects":[],"use_excludes":[],"use_includes":[],"use_matches":[]},"run_at":null},"storage":{"ts":1509991450224,"data":{}},"enabled":true,"position":8,"uuid":"a54d5ecf-4e53-4472-a139-fee85e21c7eb","source":"Ly8gPT1Vc2VyU2NyaXB0PT0KLy8gQG5hbWUgICAgICAgICBVbml2ZXJzYWwgR2l0SHViIFRhc2tzCi8vIEBuYW1lc3BhY2UgICAgaHR0cDovL3RhbXBlcm1vbmtleS5uZXQvCi8vIEB2ZXJzaW9uICAgICAgMC4yCi8vIEBkZXNjcmlwdGlvbiAgTWFraW5nIEdpdEh1YiB3b3JrIG1vcmUgdG8gbXkgbGlraW5nLi4uCi8vIEBhdXRob3IgICAgICAgaHR0cHM6Ly9naXRodWIuY29tL0JyaWNlU2hhdHplcgovLyBAbWF0Y2ggICAgICAgIGh0dHBzOi8vZ2l0aHViLmNvbS8qCi8vIEBncmFudCAgICAgICAgbm9uZQovLyA9PS9Vc2VyU2NyaXB0PT0KCihmdW5jdGlvbigpIHsKICAgICd1c2Ugc3RyaWN0JzsKCiAgICBsZXQgc3RhdGVfY29tbWl0VGltZXNDb252ZXJ0ZWQgPSBmYWxzZTsKICAgIGxldCBzdGF0ZV9kaWZmQ29sbGFwc2VyQ3JlYXRlZCA9IGZhbHNlOwogICAgbGV0IHN0YXRlX3VzZXJuYW1lc0NvbnZlcnRlZCA9IGZhbHNlOwogICAgbGV0IHN0YXRlX2dpdGh1YklzV2lkZSA9IGZhbHNlCgogICAgdXBkYXRlU3RhdGUoKTsKCiAgICAvL2V4dGVuZGluZyBoaXN0b3J5LnB1c2hTdGF0ZSB0byBydW4gdXBkYXRlU3RhdGUsIGJlY2F1c2UgZ2l0aHViIGRvZXNuJ3QgZmlyZSBhIHBvcHN0YXRlIGluIG1hbnkgaW5zdGFuY2VzCiAgICAoZnVuY3Rpb24oaGlzdG9yeSl7CiAgICB2YXIgcHVzaFN0YXRlID0gaGlzdG9yeS5wdXNoU3RhdGU7CiAgICBoaXN0b3J5LnB1c2hTdGF0ZSA9IGZ1bmN0aW9uKHN0YXRlKSB7CiAgICAgICAgaWYgKHR5cGVvZiBoaXN0b3J5Lm9ucHVzaHN0YXRlID09ICJmdW5jdGlvbiIpIHsKICAgICAgICAgICAgaGlzdG9yeS5vbnB1c2hzdGF0ZSh7c3RhdGU6IHN0YXRlfSk7CiAgICAgICAgfQogICAgICAgIGNvbnNvbGUubG9nKCdoaXN0b3J5Lm9ucHVzaHN0YXRlIGZpcmVkJyk7CiAgICAgICAgdXBkYXRlU3RhdGUoKTsKICAgICAgICByZXR1cm4gcHVzaFN0YXRlLmFwcGx5KGhpc3RvcnksIGFyZ3VtZW50cyk7CiAgICB9CiAgICB9KSh3aW5kb3cuaGlzdG9yeSk7CgoKICAgIGZ1bmN0aW9uIHVwZGF0ZVN0YXRlKCkgewogICAgICAgIHN0YXRlX2NvbW1pdFRpbWVzQ29udmVydGVkID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgncmVsYXRpdmUtdGltZScpLmxlbmd0aCA+IDAgPyB0cnVlIDogZmFsc2U7CiAgICAgICAgc3RhdGVfZGlmZkNvbGxhcHNlckNyZWF0ZWQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZGlmZkNvbGxhcHNlcicpID8gdHJ1ZSA6IGZhbHNlOwogICAgICAgIHN0YXRlX3VzZXJuYW1lc0NvbnZlcnRlZCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ3JlYWwtbmFtZScpLmxlbmd0aCA+IDAgPyB0cnVlIDogZmFsc2U7CiAgICAgICAgc3RhdGVfZ2l0aHViSXNXaWRlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21ha2VHaXRodWJXaWRlJykgPyB0cnVlIDogZmFsc2U7CgogICAgICAgIGNvbnNvbGUubG9nKCdzdGF0ZXMgdXBkYXRlZDonKTsKICAgICAgICAvLyBjb25zb2xlLmxvZygnY29tbWl0VGltZXNDb252ZXJ0ZWQtJytzdGF0ZV9jb21taXRUaW1lc0NvbnZlcnRlZCk7CiAgICAgICAgLy8gY29uc29sZS5sb2coJ2RpZmZDb2xsYXBzZXJDcmVhdGVkLScrc3RhdGVfZGlmZkNvbGxhcHNlckNyZWF0ZWQpOwogICAgICAgIC8vIGNvbnNvbGUubG9nKCd1c2VybmFtZXNDb252ZXJ0ZWQtJytzdGF0ZV91c2VybmFtZXNDb252ZXJ0ZWQpOwogICAgICAgIC8vIGNvbnNvbGUubG9nKCdnaXRodWJJc1dpZGUtJytzdGF0ZV9naXRodWJJc1dpZGUpOwoKICAgICAgICBjcmVhdGVEaWZmQ29sbGFwc2VyKCk7CiAgICAgICAgY29udmVydENvbW1pdFRpbWVzKCk7CiAgICAgICAgLy9jb252ZXJ0VXNlcm5hbWVzVG9SZWFsTmFtZXMoKTsKICAgICAgICBtYWtlR2l0aHViV2lkZSgpOwogICAgICAgIGF0dGFjaEN1c3RvbUNvbnRyb2xzVG9QYWdlKCk7CiAgICB9Ci8qIOCyoF/gsqAKICAgIGZ1bmN0aW9uIHNob3dXaWtpQnV0dG9ucygpIHsKICAgICAgICBsZXQgd2lraUJ1dHRvbnMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZ29sbHVtLWVkaXRvci1mdW5jdGlvbi1idXR0b25zJyk7CiAgICAgICAgaWYod2lraUJ1dHRvbnMpe3dpa2lCdXR0b25zLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snO30KICAgIH0KKi8KCgovKiBBdHRhY2ggY3VzdG9tIGNvbnRyb2xzIHRvIHRoZSBwYWdlICovCiAgICBmdW5jdGlvbiBhdHRhY2hDdXN0b21Db250cm9sc1RvUGFnZSgpewogICAgICAgIGxldCBvbGRDb250cm9scyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjdXN0b21Db250cm9scycpOwogICAgICAgIGxldCByZXBvSW5mbzsKCiAgICAgICAgaWYgKGRvY3VtZW50LmhlYWQucXVlcnlTZWxlY3RvcigiW25hbWU9b2N0b2x5dGljcy1kaW1lbnNpb24tcmVwb3NpdG9yeV9ud29dW2NvbnRlbnRdIikpIHsKICAgICAgICAgICAgcmVwb0luZm8gPSBkb2N1bWVudC5oZWFkLnF1ZXJ5U2VsZWN0b3IoIltuYW1lPW9jdG9seXRpY3MtZGltZW5zaW9uLXJlcG9zaXRvcnlfbndvXVtjb250ZW50XSIpLmNvbnRlbnQ7CiAgICAgICAgfQoKICAgICAgICBpZiAob2xkQ29udHJvbHMpewogICAgICAgICAgICBkb2N1bWVudC5ib2R5LnJlbW92ZUNoaWxkKG9sZENvbnRyb2xzKQogICAgICAgIH0KCiAgICAgICAgbGV0IHN0eWxlcyA9IGAKICAgICAgICAgICAgLnNlYXJjaFRvZ2dsZUNvbnRyb2wgewogICAgICAgICAgICAgICAgbWFyZ2luOiAwIDAuNXJlbTsKICAgICAgICAgICAgICAgIGN1cnNvcjogcG9pbnRlcgogICAgICAgICAgICB9CiAgICAgICAgICAgIC5zZWFyY2hUb2dnbGVDb250cm9sOmhvdmVyIHsKICAgICAgICAgICAgICAgIHRleHQtZGVjb3JhdGlvbjogbm9uZTsKICAgICAgICAgICAgfQogICAgICAgICAgICAjc2VhcmNoQ29udHJvbHMgewogICAgICAgICAgICAgICAgZGlzcGxheTogaW5saW5lLWZsZXg7CiAgICAgICAgICAgICAgICB0cmFuc2l0aW9uOiB3aWR0aCAzMDBtcyBlYXNlOwogICAgICAgICAgICAgICAgd2lkdGg6IDA7CiAgICAgICAgICAgICAgICBvdmVyZmxvdzogaGlkZGVuOwogICAgICAgICAgICB9CiAgICAgICAgICAgICNzZWFyY2hDb250cm9scy5vcGVuIHsKICAgICAgICAgICAgICAgIHdpZHRoOiAxNjBweDsKICAgICAgICAgICAgfQogICAgICAgICAgICAjc2VhcmNoQ29udHJvbHMgaW5wdXRbdHlwZT0ndGV4dCddewogICAgICAgICAgICAgICAgd2lkdGg6IDEyMHB4OwogICAgICAgICAgICAgICAgbWFyZ2luLXJpZ2h0OiAwLjVyZW07CiAgICAgICAgICAgIH0KICAgICAgICAgICAgI2N1c3RvbUNvbnRyb2xzIHsKICAgICAgICAgICAgICAgIHBvc2l0aW9uOmZpeGVkOwogICAgICAgICAgICAgICAgdG9wOjE2cHg7CiAgICAgICAgICAgICAgICBsZWZ0OjE2cHg7CiAgICAgICAgICAgICAgICB6LWluZGV4OjUwOwogICAgICAgICAgICB9CiAgICAgICAgYAoKICAgICAgICBpZighZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NvbnRyb2xTdHlsZXMnKSkgewogICAgICAgICAgICBhdHRhY2hBU3R5bGVTaGVldChzdHlsZXMsJ2NvbnRyb2xTdHlsZXMnKTsKICAgICAgICB9CgoKICAgIC8qIENyZWF0ZSBUYW1wZXJtb25rZXkgUmUtcnVuIEJ1dHRvbiAqLwogICAgICAgIGxldCByZVJ1bkJ1dHRvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2ltZycpOwogICAgICAgIHJlUnVuQnV0dG9uLnNldEF0dHJpYnV0ZSgnc3JjJywnaHR0cHM6Ly9jYW1vLmdpdGh1YnVzZXJjb250ZW50LmNvbS85OTE5YmM3ZTIyMGY2OTE5Y2RhYzJkOWVjMDBiOTljYWE5NzkxYzNiLzY4NzQ3NDcwM2EyZjJmNjkyZTY5NmQ2Nzc1NzIyZTYzNmY2ZDJmMzUzOTU2Njc2NjQ1N2EyZTcwNmU2NycpOwogICAgICAgIHJlUnVuQnV0dG9uLnNldEF0dHJpYnV0ZSgnc3R5bGUnLCdjdXJzb3I6cG9pbnRlcjttYXgtd2lkdGg6MTZweCcpOwogICAgICAgIHJlUnVuQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gewogICAgICAgICAgICB1cGRhdGVTdGF0ZSgpOwogICAgICAgIH0pOwogICAgICAgIC8vZG9jdW1lbnQuYm9keS5hcHBlbmQocmVSdW5CdXR0b24pOwoKICAgIC8qIENyZWF0ZSBSZXBvIFNlYXJjaCBDb250cm9sICovCiAgICAgICAgbGV0IHNlYXJjaFRvZ2dsZUNvbnRyb2wgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhJyk7CiAgICAgICAgc2VhcmNoVG9nZ2xlQ29udHJvbC50ZXh0Q29udGVudCA9ICfwn5SNJzsKICAgICAgICBzZWFyY2hUb2dnbGVDb250cm9sLmNsYXNzTGlzdC5hZGQoJ3NlYXJjaFRvZ2dsZUNvbnRyb2wnKTsKICAgICAgICBzZWFyY2hUb2dnbGVDb250cm9sLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gewogICAgICAgICAgICBsZXQgY29udHJvbHMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2VhcmNoQ29udHJvbHMnKTsKICAgICAgICAgICAgY29udHJvbHMuY2xhc3NMaXN0LnRvZ2dsZSgnb3BlbicpOwogICAgICAgIH0pOwoKCiAgICAgICAgbGV0IHNlYXJjaEZpZWxkID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW5wdXQnKTsKICAgICAgICBzZWFyY2hGaWVsZC5zZXRBdHRyaWJ1dGUoJ3R5cGUnLCd0ZXh0Jyk7CiAgICAgICAgc2VhcmNoRmllbGQuc2V0QXR0cmlidXRlKCdpZCcsJ3NlYXJjaEZpZWxkJyk7CgoKICAgICAgIGxldCBzZWFyY2hCdXR0b24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKTsKICAgICAgICBzZWFyY2hCdXR0b24udGV4dENvbnRlbnQgPSAnwrsnOwogICAgICAgIHNlYXJjaEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHsKICAgICAgICAgICAgbGV0IHNlYXJjaFZhbHVlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NlYXJjaEZpZWxkJykudmFsdWU7CiAgICAgICAgICAgIHNlYXJjaFZhbHVlID0gc2VhcmNoVmFsdWUuc3BsaXQoJyAnKS5qb2luKCcrJyk7CgogICAgICAgICAgICBsZXQgc2VhcmNoVXJsID0gJ2h0dHBzOi8vZ2l0aHViLmNvbS8nICsgcmVwb0luZm8gKyAnL3NlYXJjaD9xPScgKyBzZWFyY2hWYWx1ZTsKCiAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbiA9IHNlYXJjaFVybDsKICAgICAgICB9KTsKCgogICAgICAgIGxldCBzZWFyY2hDb250cm9scyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOwogICAgICAgIHNlYXJjaENvbnRyb2xzLnNldEF0dHJpYnV0ZSgnaWQnLCdzZWFyY2hDb250cm9scycpOwogICAgICAgIHNlYXJjaENvbnRyb2xzLmFwcGVuZChzZWFyY2hGaWVsZCk7CiAgICAgICAgc2VhcmNoQ29udHJvbHMuYXBwZW5kKHNlYXJjaEJ1dHRvbik7CgoKICAgICAgICBsZXQgY3VzdG9tQ29udHJvbHMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsKICAgICAgICBjdXN0b21Db250cm9scy5zZXRBdHRyaWJ1dGUoJ2lkJywgJ2N1c3RvbUNvbnRyb2xzJyk7CiAgICAgICAgY3VzdG9tQ29udHJvbHMuYXBwZW5kKHJlUnVuQnV0dG9uKTsKICAgICAgICBpZiAocmVwb0luZm8pIHsKICAgICAgICAgICAgY3VzdG9tQ29udHJvbHMuYXBwZW5kKHNlYXJjaFRvZ2dsZUNvbnRyb2wpOwogICAgICAgICAgICBjdXN0b21Db250cm9scy5hcHBlbmQoc2VhcmNoQ29udHJvbHMpOwogICAgICAgIH0KCiAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmQoY3VzdG9tQ29udHJvbHMpOwogICAgfQoKLyogQ29udmVydCBDb21taXQgVGltZXMgVG8gTm9uLXJlYWx0aXZlICovCiAgICBmdW5jdGlvbiBjb252ZXJ0Q29tbWl0VGltZXMoKSB7CiAgICAgICAgaWYoc3RhdGVfY29tbWl0VGltZXNDb252ZXJ0ZWQgPT09IGZhbHNlKSB7CiAgICAgICAgICAgIHdpbmRvdy5zZXRUaW1lb3V0KGNvbnZlcnRDb21taXRUaW1lcywgNzUwKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBzdGF0ZV9jb21taXRUaW1lc0NvbnZlcnRlZCA9IHRydWU7CiAgICAgICAgICAgIGxldCBjb21taXRUaW1lcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ3JlbGF0aXZlLXRpbWUnKTsKICAgICAgICAgICAgY29tbWl0VGltZXMuZm9yRWFjaCgoZWwpPT57CiAgICAgICAgICAgICAgICBsZXQgZnVsbFRpbWUgPSBlbC50aXRsZTsKICAgICAgICAgICAgICAgIGVsLmlubmVySFRNTCA9ICc8c3Ryb25nPicrZnVsbFRpbWUrJzwvc3Ryb25nPic7CiAgICAgICAgICAgIH0pOwogICAgICAgIH0KICAgIH0KCi8qIENyZWF0ZSBEaWZmIENvbGxhcHNlciAqLwogICAgZnVuY3Rpb24gY3JlYXRlRGlmZkNvbGxhcHNlcigpIHsKICAgICAgICBpZihzdGF0ZV9kaWZmQ29sbGFwc2VyQ3JlYXRlZCA9PT0gZmFsc2UgJiYgZ2V0Q29sbGFwc2libGVFbGVtZW50cygpLmxlbmd0aCkgewogICAgICAgIC8vICAgICB3aW5kb3cuc2V0VGltZW91dChjcmVhdGVEaWZmQ29sbGFwc2VyLCA3NTApOwogICAgICAgIC8vIH0gZWxzZSB7CiAgICAgICAgICAgIHN0YXRlX2RpZmZDb2xsYXBzZXJDcmVhdGVkID0gdHJ1ZTsKICAgICAgICAgICAgbGV0IHN0YWxlRWxlbWVudHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcjZGlmZkNvbGxhcHNlcicpOwogICAgICAgICAgICBpZihzdGFsZUVsZW1lbnRzLmxlbmd0aD4wKXsKICAgICAgICAgICAgICAgIHN0YWxlRWxlbWVudHMuZm9yRWFjaCgoZWwpPT57CiAgICAgICAgICAgICAgICAgICAgZWwucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChlbCk7CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfQogICAgICAgICAgICBsZXQgZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbWcnKTsKICAgICAgICAgICAgLy9sZXQgZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKTsKICAgICAgICAgICAgLy9sZXQgc3R5bGVUZXh0ID0gJ3Bvc2l0aW9uOmZpeGVkO2xlZnQ6MnJlbTtib3R0b206NTB2aDt6LWluZGV4OjUwO21pbi13aWR0aDoxcmVtOycKCiAgICAgICAgICAgIGVsLnNyYyA9ICJodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vd2ViZG9nL29jdGljb25zLXBuZy9tYXN0ZXIvYmxhY2svZm9sZC5wbmciOwogICAgICAgICAgICBlbC5hbHQgPSJDb2xsYXBzZS9FeHBhbmQgRGlmZnMiOwogICAgICAgICAgICBlbC5pZCAgPSAiZGlmZkNvbGxhcHNlciI7CiAgICAgICAgICAgIGxldCBzdHlsZVRleHQgPSBgCiAgICAgICAgICAgICAgICBwb3NpdGlvbjpmaXhlZDsKICAgICAgICAgICAgICAgIGxlZnQ6LjVyZW07CiAgICAgICAgICAgICAgICBib3R0b206NTB2aDsKICAgICAgICAgICAgICAgIG1heC13aWR0aDoxcmVtOwogICAgICAgICAgICAgICAgei1pbmRleDo1MDsKICAgICAgICAgICAgICAgIGN1cnNvcjpwb2ludGVyCiAgICAgICAgICAgICAgICBgOwoKICAgICAgICAgICAgZWwuc2V0QXR0cmlidXRlKCdzdHlsZScsc3R5bGVUZXh0KTsKICAgICAgICAgICAgLy9lbAogICAgICAgICAgICAvL2VsLnNldEF0dHJpYnV0ZSgnY2xhc3MnLCAnYnRuJyk7CiAgICAgICAgICAgIC8vZWwuaW5uZXJIVE1MID0gJ0NvbGxhcHNlIERpZmZzJzsKICAgICAgICAgICAgZWwuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCgpPT57CiAgICAgICAgICAgICAgICBmdW5jdGlvbiBzZXRTdGF0dXMoc3RhdHVzKSB7CiAgICAgICAgICAgICAgICAgICAgZWwuc2V0QXR0cmlidXRlKCdkYXRhLXN0YXR1cycsc3RhdHVzKTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBpZihlbC5nZXRBdHRyaWJ1dGUoJ2RhdGEtc3RhdHVzJykgPT09ICdDb2xsYXBzZScpewogICAgICAgICAgICAgICAgICAgIGNvbGxhcHNlRGlmZnMoKTsKICAgICAgICAgICAgICAgICAgICBzZXRTdGF0dXMoJ0V4cGFuZCcpOwogICAgICAgICAgICAgICAgICAgIC8vZWwuaW5uZXJIVE1MID0gJ0V4cGFuZCBEaWZmcyc7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIGV4cGFuZERpZmZzKCk7CiAgICAgICAgICAgICAgICAgICAgc2V0U3RhdHVzKCdDb2xsYXBzZScpOwogICAgICAgICAgICAgICAgICAgIC8vZWwuaW5uZXJIVE1MID0gJ0NvbGxhcHNlIERpZmZzJzsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgIH0pOwogICAgICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZChlbCk7CiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiBleHBhbmREaWZmcygpIHsKICAgICAgICAgICAgbGV0IGNvbGxhcHNlZEVsZW1lbnRzID0gZ2V0Q29sbGFwc2libGVFbGVtZW50cygpLmZpbHRlcihlbD0+IGVsLmdldEF0dHJpYnV0ZSgnYXJpYS1leHBhbmRlZCcpPT09J2ZhbHNlJyk7CiAgICAgICAgICAgIGNsaWNrRWxlbWVudHMoY29sbGFwc2VkRWxlbWVudHMpOwogICAgICAgIH0KCiAgICAgICAgZnVuY3Rpb24gY29sbGFwc2VEaWZmcygpIHsKICAgICAgICAgICAgbGV0IGV4cGFuZGVkRWxlbWVudHMgPSBnZXRDb2xsYXBzaWJsZUVsZW1lbnRzKCkuZmlsdGVyKGVsPT4gZWwuZ2V0QXR0cmlidXRlKCdhcmlhLWV4cGFuZGVkJyk9PT0ndHJ1ZScpOwogICAgICAgICAgICBjbGlja0VsZW1lbnRzKGV4cGFuZGVkRWxlbWVudHMpOwogICAgICAgIH0KCgoKICAgICAgICBmdW5jdGlvbiBjbGlja0VsZW1lbnRzKGVsZW1lbnRzQXJyKSB7CiAgICAgICAgICAgIGVsZW1lbnRzQXJyLmZvckVhY2goKGVsKT0+ewogICAgICAgICAgICAgICAgZWwuY2xpY2soKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgfQoKICAgICAgICBmdW5jdGlvbiBnZXRDb2xsYXBzaWJsZUVsZW1lbnRzKCkgewogICAgICAgICAgICBsZXQgYWxsRWxlbWVudHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCdidXR0b25bYXJpYS1sYWJlbD0iVG9nZ2xlIGRpZmYgY29udGVudHMiXScpOwogICAgICAgICAgICByZXR1cm4gT2JqZWN0LnZhbHVlcyhhbGxFbGVtZW50cyk7CiAgICAgICAgfQogICAgfQoKLyogV2lkZS1HaXRodWIgKi8KLy8gc291cmNlOiBodHRwczovL2dpdGh1Yi5jb20veHRoZXhkZXIvd2lkZS1naXRodWIKICAgIGZ1bmN0aW9uIG1ha2VHaXRodWJXaWRlKCkgewogICAgICAgIHZhciBzdHlsZVNoZWV0ID0gIiIgKwogICAgICAgICIuaGVhZGVyIC5jb250YWluZXIgeyIgKwogICAgICAgICAgIndpZHRoOiBhdXRvICFpbXBvcnRhbnQ7IiArCiAgICAgICAgICAibWFyZ2luLWxlZnQ6IDIwcHggIWltcG9ydGFudDsiICsKICAgICAgICAgICJtYXJnaW4tcmlnaHQ6IDIwcHggIWltcG9ydGFudDsiICsKICAgICAgICAgICJtaW4td2lkdGg6IDk4MHB4OyIgKwogICAgICAgICJ9IiArCiAgICAgICAgIiNqcy1yZXBvLXBqYXgtY29udGFpbmVyIC5jb250YWluZXIgeyIgKwogICAgICAgICAgIndpZHRoOiBhdXRvICFpbXBvcnRhbnQ7IiArCiAgICAgICAgICAibWFyZ2luLWxlZnQ6IDIwcHggIWltcG9ydGFudDsiICsKICAgICAgICAgICJtYXJnaW4tcmlnaHQ6IDIwcHggIWltcG9ydGFudDsiICsKICAgICAgICAgICJtaW4td2lkdGg6IDk4MHB4OyIgKwogICAgICAgICJ9IiArCiAgICAgICAgIi5mdWxsLXdpZHRoIC5jb250YWluZXIgeyIgKwogICAgICAgICAgInBhZGRpbmctbGVmdDogMHB4ICFpbXBvcnRhbnQ7IiArCiAgICAgICAgICAicGFkZGluZy1yaWdodDogMHB4ICFpbXBvcnRhbnQ7IiArCiAgICAgICAgIn0iICsKCiAgICAgICAgLy8gTmV3IFBSIHNwbGl0IGRpZmYKICAgICAgICAiLmZ1bGwtd2lkdGggLm5ldy1wci1mb3JtIHsiICsKICAgICAgICAgICJtYXgtd2lkdGg6IG5vbmUgIWltcG9ydGFudDsiICsKICAgICAgICAifSIgKwoKICAgICAgICAvLyBSZXBvc2l0b3J5IElzc3VlcwogICAgICAgICIjanMtcmVwby1wamF4LWNvbnRhaW5lciAucmVwb3NpdG9yeS1jb250ZW50IC5kaXNjdXNzaW9uLXRpbWVsaW5lIHsiICsgIC8vIElzc3VlIGJvZHkKICAgICAgICAgICJtYXJnaW4tbGVmdDogLTIyMHB4OyIgKwogICAgICAgICAgInBhZGRpbmctbGVmdDogMjIwcHg7IiArCiAgICAgICAgICAid2lkdGg6IDEwMCUgIWltcG9ydGFudDsiICsKICAgICAgICAifSIgKwogICAgICAgICIucmVwb3NpdG9yeS1jb250ZW50IC5kaXNjdXNzaW9uLXNpZGViYXIgeyIgKwogICAgICAgICAgIndpZHRoOiAyMDBweCAhaW1wb3J0YW50OyIgKwogICAgICAgICJ9IiArCiAgICAgICAgIi5yZXBvc2l0b3J5LWNvbnRlbnQgLnRpbWVsaW5lLW5ldy1jb21tZW50IHsiICsgLy8gTmV3IElzc3VlIC8gaXNzdWUgY29tbWVudCBmb3JtCiAgICAgICAgICAibWF4LXdpZHRoOiAxMDAlICFpbXBvcnRhbnQ7IiArCiAgICAgICAgIn0iICsKICAgICAgICAiLnJlcG9zaXRvcnktY29udGVudCAuaW5saW5lLWNvbW1lbnRzIC5jb21tZW50LWhvbGRlciB7IiArIC8vIERpZmYgLyBjb2RlIGNvbW1lbnRzCiAgICAgICAgICAibWF4LXdpZHRoOiA5NjBweCAhaW1wb3J0YW50OyIgKwogICAgICAgICJ9IiArCiAgICAgICAgIi5yZXBvc2l0b3J5LWNvbnRlbnQgLmlubGluZS1jb21tZW50cyAuaW5saW5lLWNvbW1lbnQtZm9ybS1jb250YWluZXIgeyIgKwogICAgICAgICAgIm1heC13aWR0aDogOTYwcHggIWltcG9ydGFudDsiICsKICAgICAgICAifSIgKwogICAgICAgICIucmVwb3NpdG9yeS1jb250ZW50IC5pbmxpbmUtY29tbWVudHMgLmlubGluZS1jb21tZW50LWZvcm0geyIgKwogICAgICAgICAgIm1heC13aWR0aDogOTYwcHggIWltcG9ydGFudDsiICsKICAgICAgICAifSIgKwoKICAgICAgICAvLyBSZXBvc2l0b3J5IHB1bHNlIHBhZ2UKICAgICAgICAiLnJlcG9zaXRvcnktY29udGVudCAuYXV0aG9ycy1hbmQtY29kZSAuc2VjdGlvbiB7IiArIC8vIENvbnRyaWJ1dG9ycyBiYXIgZ3JhcGgKICAgICAgICAgICJ3aWR0aDogNTAlOyIgKwogICAgICAgICAgImhlaWdodDogMTgwcHg7IiArCiAgICAgICAgIn0iICsKICAgICAgICAiLnJlcG9zaXRvcnktY29udGVudCAuYXV0aG9ycy1hbmQtY29kZSAuc2VjdGlvbiBzdmcgeyIgKwogICAgICAgICAgImhlaWdodDogMTgwcHg7IiArCiAgICAgICAgIn0iICsKCiAgICAgICAgLy8gUmVwb3NpdG9yeSBncmFwaCBwYWdlCiAgICAgICAgIi5yZXBvc2l0b3J5LWNvbnRlbnQgLmNhcHBlZC1jYXJkIHsiICsgLy8gR3JhcGggY2FyZHMgb24gY29udHJpYnV0b3JzIC8gZ3JhcGggbGlzdAogICAgICAgICAgIm1hcmdpbjoxMHB4IDEwcHggMCAwICFpbXBvcnRhbnQ7IiArCiAgICAgICAgIn0iICsKCiAgICAgICAgLy8gR2lzdHMKICAgICAgICAiLmdpc3QtY29udGVudC13cmFwcGVyIC5jb250YWluZXIgeyIgKwogICAgICAgICAgIndpZHRoOiBhdXRvICFpbXBvcnRhbnQ7IiArCiAgICAgICAgICAibWFyZ2luLWxlZnQ6IDIwcHggIWltcG9ydGFudDsiICsKICAgICAgICAgICJtYXJnaW4tcmlnaHQ6IDIwcHggIWltcG9ydGFudDsiICsKICAgICAgICAgICJtaW4td2lkdGg6IDk4MHB4OyIgKwogICAgICAgICJ9IiArCgogICAgICAgIC8vIHVsdHJhd2lkZSBtYXJnaW5zCiAgICAgICAgIkBtZWRpYSAobWluLXdpZHRoOiAxMjgwcHgpIHsgIisKICAgICAgICAgICAgIi5oZWFkZXIgLmNvbnRhaW5lciwgIiArCiAgICAgICAgICAgICIjanMtcmVwby1wamF4LWNvbnRhaW5lciAuY29udGFpbmVyLCAiICsKICAgICAgICAgICAgIi5naXN0LWNvbnRlbnQtd3JhcHBlciAuY29udGFpbmVyIHsiICsKICAgICAgICAgICAgICAibWFyZ2luLWxlZnQ6IDMlICFpbXBvcnRhbnQ7IiArCiAgICAgICAgICAgICAgIm1hcmdpbi1yaWdodDogMyUgIWltcG9ydGFudDsiICsKICAgICAgICAgICAgIn0iKwogICAgICAgICJ9IisKCiAgICAgICAgIiI7CiAgICAgICAgaWYoIWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtYWtlR2l0aHViV2lkZScpKXsKICAgICAgICAgICAgYXR0YWNoQVN0eWxlU2hlZXQoc3R5bGVTaGVldCwnbWFrZUdpdGh1YldpZGUnKTsKICAgICAgICB9CgogICAgICAgIC8vIChmdW5jdGlvbiAoKSB7CiAgICAgICAgLy8gICB2YXIgcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3N0eWxlJyk7CiAgICAgICAgLy8gICBzLmlkID0gIm1ha2VHaXRodWJXaWRlIjsKICAgICAgICAvLyAgIHMudHlwZSA9ICJ0ZXh0L2NzcyI7CiAgICAgICAgLy8gICBzLmlubmVySFRNTCA9IHN0eWxlU2hlZXQ7CiAgICAgICAgLy8gICAoZG9jdW1lbnQuaGVhZCB8fCBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQpLmFwcGVuZENoaWxkKHMpOwogICAgICAgIC8vIH0pKCk7CiAgICB9CgovKiBVdGlsaXR5IGZ1bmN0aW9uIHdoaWNoIHdyaXRlcyBhIHN0eWxlc2hlZXQgdG8gdGhlIHBhZ2UqLwogICAgZnVuY3Rpb24gYXR0YWNoQVN0eWxlU2hlZXQoc3R5bGVTaGVldCxpZCkgewogICAgICAgICAgICAoZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgIHZhciBzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3R5bGUnKTsKICAgICAgICAgICAgICBpZihpZCl7IHMuaWQgPSBpZDt9CiAgICAgICAgICAgICAgcy50eXBlID0gInRleHQvY3NzIjsKICAgICAgICAgICAgICBzLmlubmVySFRNTCA9IHN0eWxlU2hlZXQ7CiAgICAgICAgICAgICAgKGRvY3VtZW50LmhlYWQgfHwgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50KS5hcHBlbmRDaGlsZChzKTsKICAgICAgICAgICAgfSkoKTsKICAgIH0KCi8qIENvbnZlcnQgVXNlcm5hbWVzIHRvIFJlYWwgTmFtZXMgPyhXSVApPyAqLwogICAgZnVuY3Rpb24gY29udmVydFVzZXJuYW1lc1RvUmVhbE5hbWVzKCkgewogICAgICAgIGNvbnN0IHVzZXJuYW1lcyA9IFsuLi5kb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuYXV0aG9yJyldOwoKICAgICAgICB1c2VybmFtZXMuZm9yRWFjaCggKGVsZW1lbnQpID0+IHsKICAgICAgICAgICAgbGV0IHVybCA9ICdodHRwczovL2FwaS5naXRodWIuY29tL3VzZXJzLycrZWxlbWVudC5pbm5lclRleHQ7CiAgICAgICAgICAgIGxldCByZXF1ZXN0ID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7CiAgICAgICAgICAgIHJlcXVlc3Qub3BlbignR0VUJywgdXJsLCB0cnVlKTsKCiAgICAgICAgICAgIHJlcXVlc3Qub25sb2FkID0gZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgaWYgKHRoaXMuc3RhdHVzID49IDIwMCAmJiB0aGlzLnN0YXR1cyA8IDQwMCkgewogICAgICAgICAgICAgICAgLy8gU3VjY2VzcyEKICAgICAgICAgICAgICAgIHZhciByZXNwID0gdGhpcy5yZXNwb25zZTsKICAgICAgICAgICAgICAgIHZhciB1c2VyT2JqID0gSlNPTi5wYXJzZShyZXNwKTsKICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHVzZXJPYmopOwoKICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2coIHJlc3ApOwoKICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ0xvb2tzIGxpa2UgdGhlcmUgd2FzIGEgcHJvYmxlbS4gU3RhdHVzIENvZGU6ICcgKyB0aGlzLnN0YXR1cyk7CiAgICAgICAgICAgICAgICAvLyBXZSByZWFjaGVkIG91ciB0YXJnZXQgc2VydmVyLCBidXQgaXQgcmV0dXJuZWQgYW4gZXJyb3IKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH07CgogICAgICAgICAgICByZXF1ZXN0Lm9uZXJyb3IgPSBmdW5jdGlvbihlcnIpIHsKICAgICAgICAgICAgICAvLyBUaGVyZSB3YXMgYSBjb25uZWN0aW9uIGVycm9yIG9mIHNvbWUgc29ydAogICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdGZXRjaCBFcnJvciA6LVMnLCBlcnIpOwoKICAgICAgICAgICAgfTsKICAgICAgICAgICAgcmVxdWVzdC5zZW5kKCk7CgoKICAgICAgICAgICAgLy8tLSB0cnlpbmcgdG8gdXNlIGZldGNoCi8qCiAgICAgICAgICAgIGxldCBuZXdOYW1lID0gZmV0Y2godXJsKQogICAgICAgICAgICAgICAgLnRoZW4oIChyZXNwb25zZSkgPT4gewogICAgICAgICAgICAgICAgICAgIGlmIChyZXNwb25zZS5zdGF0dXMgIT09IDIwMCkgewogICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnTG9va3MgbGlrZSB0aGVyZSB3YXMgYSBwcm9ibGVtLiBTdGF0dXMgQ29kZTogJyArIHJlc3BvbnNlLnN0YXR1cyk7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAnRXJyb3JJblJldHJpdmlhbCc7CiAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICByZXNwb25zZS5qc29uKCkudGhlbihmdW5jdGlvbihkYXRhKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGRhdGEubmFtZSk7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBkYXRhLm5hbWU7CiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgLmNhdGNoKGZ1bmN0aW9uKGVycikgewogICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdGZXRjaCBFcnJvciA6LVMnLCBlcnIpOwogICAgICAgICAgICAgICAgICAgIHJldHVybiAnRXJyb3JJblJldHJpdmlhbCc7CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgaWYgKG5ld05hbWUgIT09ICdFcnJvckluUmV0cml2aWFsJykgewogICAgICAgICAgICAgICAgZWxlbWVudC5pbm5lclRleHQgPSBuZXdOYW1lOwogICAgICAgICAgICAgICAgZWxlbWVudC5jbGFzc0xpc3QuYWRkKCdyZWFsLW5hbWUnKTsKICAgICAgICAgICAgfQoqLwoKICAgICAgICB9KTsgLy8gdXNlcm5hbWVzLmZvckVhY2goKSBlbmQKICAgIH0KCgoKCgogICAgLy8gLS0gYWR2ZW50dXJlcyBpbiBtdXRhdGlvbk9ic2VydmluZwovKgogICAgbGV0IHRhcmdldCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2Rpdltyb2xlPSJtYWluIl0nKTsKICAgIGxldCBjb25maWcgPSB7IGF0dHJpYnV0ZXM6IHRydWUsIGNoaWxkTGlzdDogdHJ1ZSwgY2hhcmFjdGVyRGF0YTogdHJ1ZSB9OwogICAgbGV0IG9ic2VydmVyID0gbmV3IE11dGF0aW9uT2JzZXJ2ZXIoZnVuY3Rpb24obXV0YXRpb25zKSB7CiAgICAgICAgbXV0YXRpb25zLmZvckVhY2goZnVuY3Rpb24obXV0YXRpb24pIHsKICAgICAgICAgICAgY29uc29sZS5sb2cobXV0YXRpb24udHlwZSk7CiAgICAgICAgfSk7CiAgICB9KTsKICAgIG9ic2VydmVyLm9ic2VydmUodGFyZ2V0LCBjb25maWcpOwoqLwoKCgogICAgLy8gLS0gc2V0dGluZyBzdGF0ZSBhdCBhbiBpbnRlcnZhbAovKiAgICB3aW5kb3cuc2V0SW50ZXJ2YWwoZnVuY3Rpb24oKXsKICAgICAgICBjb25zb2xlLmxvZygnc3RhdGVfY29tbWl0VGltZXNDb252ZXJ0ZWQ6ICcgKyBzdGF0ZV9jb21taXRUaW1lc0NvbnZlcnRlZCk7CiAgICAgICAgY29uc29sZS5sb2coJ3N0YXRlX2RpZmZDb2xsYXBzZXJDcmVhdGVkOiAnICsgc3RhdGVfZGlmZkNvbGxhcHNlckNyZWF0ZWQpOwogICAgfSwgMzAwMCk7CiovCgoKfSkoKTs="},{"name":"Chicago Suntimes Paywall Killer","options":{"check_for_updates":true,"comment":null,"compatopts_for_requires":true,"compat_wrappedjsobject":false,"compat_metadata":false,"compat_foreach":false,"compat_arrayleft":false,"compat_uW_gmonkey":false,"compat_forvarin":false,"noframes":null,"awareOfChrome":false,"run_at":null,"override":{"use_includes":[],"orig_includes":[],"merge_includes":true,"use_matches":[],"orig_matches":["https://chicago.suntimes.com/*"],"merge_matches":true,"use_excludes":[],"orig_excludes":[],"merge_excludes":true,"use_connects":[],"merge_connects":true,"use_blockers":[],"orig_run_at":"document-idle","orig_noframes":null,"orig_connects":[]}},"storage":{"ts":1541527710076,"data":{}},"enabled":true,"position":9,"uuid":"270cb634-5123-42b3-942b-ac1acf4a73a9","source":"Ly8gPT1Vc2VyU2NyaXB0PT0KLy8gQG5hbWUgICAgICAgICBDaGljYWdvIFN1bnRpbWVzIFBheXdhbGwgS2lsbGVyCi8vIEBuYW1lc3BhY2UgICAgaHR0cHM6Ly9jaGljYWdvLnN1bnRpbWVzLmNvbS8qCi8vIEB2ZXJzaW9uICAgICAgMC4xCi8vIEBkZXNjcmlwdGlvbiAgSW50ZXJtaXR0ZW50bHkgbnVrZXMgdGhlaXIgbW9kYWwvYmFja2Ryb3AgdGhleSBwdXQgdXAKLy8gQGF1dGhvciAgICAgICBodHRwczovL2dpdGh1Yi5jb20vQnJpY2VTaGF0emVyCi8vIEBtYXRjaCAgICAgICAgaHR0cHM6Ly9jaGljYWdvLnN1bnRpbWVzLmNvbS8qCi8vIEBncmFudCAgICAgICAgbm9uZQovLyA9PS9Vc2VyU2NyaXB0PT0KCihmdW5jdGlvbigpIHsKICAgICd1c2Ugc3RyaWN0JzsKICAgIHNldEludGVydmFsKGZ1bmN0aW9uKCl7CiAgICAgICAgdmFyIG1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnRwLW1vZGFsJyk7CiAgICAgICAgdmFyIG92ZXJsYXkgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcudHAtYmFja2Ryb3AnKTsKICAgICAgICB2YXIgYm9keSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2JvZHknKTsKICAgICAgICBvdmVybGF5LnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQob3ZlcmxheSk7CiAgICAgICAgbW9kYWwucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChtb2RhbCk7CiAgICAgICAgYm9keS5jbGFzc0xpc3QucmVtb3ZlKCd0cC1tb2RhbC1vcGVuJyk7CiAgICB9LCAyNTAwKTsKfSkoKTs="},{"name":"Anti-Adblock Killer | Reek","options":{"awareOfChrome":false,"check_for_updates":true,"comment":null,"compat_arrayleft":false,"compat_foreach":false,"compat_forvarin":false,"compat_metadata":false,"compat_uW_gmonkey":false,"compat_wrappedjsobject":true,"compatopts_for_requires":true,"noframes":null,"override":{"merge_connects":true,"merge_excludes":true,"merge_includes":true,"merge_matches":true,"orig_connects":["*"],"orig_excludes":[],"orig_includes":["http://*/*","https://*/*"],"orig_matches":[],"orig_noframes":null,"orig_run_at":"document-start","use_blockers":[],"use_connects":[],"use_excludes":[],"use_includes":[],"use_matches":[]},"run_at":null},"storage":{"data":{"autoPlay":"bfalse","checkList":"bfalse","checkUpdate":"bfalse","debug":"bfalse","forceVLC":"bfalse","logDetected":"bfalse","logExcluded":"bfalse","logInsertedNodes":"bfalse","logInterceptedScripts":"bfalse","logPlayer":"bfalse","logRemovedNodes":"bfalse","logXhr":"bfalse","nextchecklist":"s1512062598305","nextcheckupdate":"s1512581002266","videoHD":"bfalse"},"ts":1511976224667},"enabled":false,"position":10,"file_url":"https://greasyfork.org/scripts/735-anti-adblock-killer-reek/code/Anti%20Adblock%20Killer%20%7C%20Reek.user.js","uuid":"7fade075-779e-4bba-aa9b-e5c099c7702b","source":"Ly8gPT1Vc2VyU2NyaXB0PT0KLy8gQG5hbWUgQW50aS1BZGJsb2NrIEtpbGxlciB8IFJlZWsKLy8gQG5hbWVzcGFjZSBodHRwczovL3VzZXJzY3JpcHRzLm9yZy9zY3JpcHRzL3Nob3cvMTU1ODQwCi8vIEBkZXNjcmlwdGlvbiBIZWxwcyB5b3Uga2VlcCB5b3VyIEFkLUJsb2NrZXIgYWN0aXZlLCB3aGVuIHlvdSB2aXNpdCBhIHdlYnNpdGUgYW5kIGl0IGFza3MgeW91IHRvIGRpc2FibGUuCi8vIEBhdXRob3IgUmVlayB8IHJlZWtzaXRlLmNvbQovLyBAdmVyc2lvbiAxMC4wCi8vIEBlbmNvZGluZyB1dGYtOAovLyBAbGljZW5zZSBodHRwczovL2NyZWF0aXZlY29tbW9ucy5vcmcvbGljZW5zZXMvYnktc2EvNC4wLwovLyBAaWNvbiBodHRwczovL3Jhdy5naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9tYXN0ZXIvYW50aS1hZGJsb2NrLWtpbGxlci1pY29uLnBuZwovLyBAaG9tZXBhZ2UgaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci8KLy8gQHR3aXR0ZXJVUkwgaHR0cHM6Ly90d2l0dGVyLmNvbS9hbnRpYWRia2lsbGVyCi8vIEBjb250YWN0VVJMIGh0dHBzOi8vcmVlay5naXRodWIuaW8vYW50aS1hZGJsb2NrLWtpbGxlci8jY29udGFjdAovLyBAc3VwcG9ydFVSTCBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3VlcwovLyBAY29udHJpYnV0aW9uVVJMIGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIjZG9uYXRlCi8vIEBpbmNsdWRlIGh0dHA6Ly8qLyoKLy8gQGluY2x1ZGUgaHR0cHM6Ly8qLyoKLy8gQGdyYW50IHVuc2FmZVdpbmRvdwovLyBAZ3JhbnQgR01fYWRkU3R5bGUKLy8gQGdyYW50IEdNX2dldFZhbHVlCi8vIEBncmFudCBHTV9zZXRWYWx1ZQovLyBAZ3JhbnQgR01feG1saHR0cFJlcXVlc3QKLy8gQGdyYW50IEdNX3JlZ2lzdGVyTWVudUNvbW1hbmQKLy8gQGdyYW50IEdNX2RlbGV0ZVZhbHVlCi8vIEBncmFudCBHTV9saXN0VmFsdWVzCi8vIEBncmFudCBHTV9nZXRSZXNvdXJjZVRleHQKLy8gQGdyYW50IEdNX2dldFJlc291cmNlVVJMCi8vIEBncmFudCBHTV9sb2cKLy8gQGdyYW50IEdNX29wZW5JblRhYgovLyBAZ3JhbnQgR01fc2V0Q2xpcGJvYXJkCi8vIEBncmFudCBHTV9pbmZvCi8vIEBncmFudCBHTV9nZXRNZXRhZGF0YQovLyBAcnVuLWF0IGRvY3VtZW50LXN0YXJ0Ci8vIEBjb25uZWN0ICoKLy8gPT0vVXNlclNjcmlwdD09Ci8qanNoaW50IGV2aWw6dHJ1ZSBuZXdjYXA6ZmFsc2UqLwovKmdsb2JhbCB1bnNhZmVXaW5kb3csIEdNX2FkZFN0eWxlLCBHTV9nZXRWYWx1ZSwgR01fc2V0VmFsdWUsIEdNX3htbGh0dHBSZXF1ZXN0LCBHTV9yZWdpc3Rlck1lbnVDb21tYW5kLCBHTV9kZWxldGVWYWx1ZSwgR01fbGlzdFZhbHVlcywgR01fZ2V0UmVzb3VyY2VUZXh0LCBHTV9nZXRSZXNvdXJjZVVSTCwgR01fbG9nLCBHTV9vcGVuSW5UYWIsIEdNX3NldENsaXBib2FyZCwgR01faW5mbywgR01fZ2V0TWV0YWRhdGEsICQsIGRvY3VtZW50LCBjb25zb2xlLCBsb2NhdGlvbiwgc2V0SW50ZXJ2YWwsIHNldFRpbWVvdXQsIGNsZWFySW50ZXJ2YWwqLwovKj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiAgVGhhbmtzCj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQoKICBEb25vcnM6IE0uIEhvd2FyZCwgU2h1bmpvdSwgQ2hhcm1pbmUsIEtpZXJlazkzLCBHLiBCYXJuYXJkLCBILiBZb3VuZywgU2VpbmhvcjksIEltR2xvZGFyLCBJdmFub3Nldml0Y2gsIEhvbWVEaXBvLCBSLiBNYXJ0aW4sIERyRmlaLCBUaXBweSwgQi4gUm9obmVyLCBQLiBLb3ppY2EsIE0uIFBhdGVsLCBXNHJlbGwsIFRzY2hlY2tvZmYsIEFkQmxvY2sgUG9sc2thLCBBVkVOSVIgSU5URVJORVQsIGNvb2xOQU8sIEJlbiwgSi4gUGFyaywgQy4gWW91bmcsIEouIEJvdSwgTS4gQ2FubywgSi4gSnVuZywgQS4gU29uaW5vLCBKLiBMaXR0ZW4sIE0uIFNjaHJ1bXBmLCBHLiBQZXBlLCBBLiBUcnVmYW5vdiwgUi4gUGFsbWVyLCBKLiBSYXV0aWFpbmVuLCBTLiBCbHlzdG9uZSwgTS4gU2lsdmVpcmEsIEsuIE1hY0FydGh1ciwgTS4gSXZhbm92LCBBLiBTY2htaWR0LCBBLiBXYWFnZSwgRi4gVGlzbWVyLCBTLiBFaG5lcnQsIEouIENvcnB1cywgSi4gRGx1aG9zLCBNYWtsZW1lbnosIFN0cm9iZWxpeCwgTW9kZWxscGlsb3QuRVUsIEUuIEJlbmVkZXR0aSwgVi4gVmVuZGl0dGksIFNoYWtvcywgQS4gRWxpYXNvbiwgQS4gU2Fsb3JhbnRhLCBTLiBHZWlnZXIsIEEuIE90dGVybG9vLCBNLiBDb3BwZW4sIFMuIEZpc2NoZXIsIEguIEJlY2tlciwgRC4gQWNrZXJtYW4sIFMuIFBpdHNjaCwgSy4gUGVydGNoZWNrLCBTLiBBYmVsLCBLLiBPJ0Nvbm5vciwgQi4gT2JyaWVuLCBTLiBWb2dsZXIsIFMuIEdvZWJsLCBBLiBCaWFyLCBTLiBTY290dCwgQmFzc21vYmlsZS5vcmcsIFMuIEdyb8OfZSwgTS4gUGVvdCwgUi4gQ2hhbiBCYWxhbSwgTC4gQm9uZC1LZW5uZWR5LCBSLiBFbW9uZCwgQS4gUGF2bG92LCBXLiBUcmFjZXksIEEuIFNlcmdleSwgUi4gTMOzcGV6IEzDs3BleiwgUi4gUmVkZHkgS2FzaXJlZGR5LCBBLiBNb3VqZWVyLCBNLiBCZXR6LCBNLiBMZWbDqHZyZSwgUi4gTWNDdXJkeSwgTFIgR2Vla3MsIE0uIEJlYXVyZWdhcmQsIENhc3BlclRlY2ggTHRkLCBNLiBEdWRhcywgUy4gU2NoYXJmLCBTLiBQcm9raG9yb3YsIEsuIFBhcGFsaWFzLCBKLiBXb2pub3dza2ksIEIuIEN1cnRpcywgRC4gTGF3cmVuY2UsIEQuIEhlLCBOLiBLZWxzYWxsLCBJZG9nZXdhbGxldCwgSi4gU3BhdWxkaW5nLCBTLiBMYWZvbiwgTWF0LCBILiBSb2JlcnRzLCBDLiBIZWRsdW5kLCBKLiBIYXdraW5zLCBKLiBBbmRlcnNlbiwgTS4gQmpvcmtzdGVuLCBCLiBXb2xmZSBJSUksIFQuIFlvY29tLCDFoC4gSW50YXMsIFMuIE1vZW5pY2gsIEouIENoYW5nLCBDLiBNdW5rLCBBLiBOYXJ1dGEsINCRLiDQnNC40YXQsNC40LssIEouIEJlbnosIEYuIFNsb290LCBKLiBDcmVlZCwgTS4gR2lsbGFtLCBDLiBMZWljaHQsIEEuIEduYW5hLCBTLiBTdW5kYXJhbSwgQS4gS29sbGVyLCBNLiBLb3RsYXIsIFMuIEFiZWwsIFQuIEZsYW5hZ2FuLCBNLiBBcmR1aW5pLCBQLiBTdGFja2hvdXNlLCBCLiBPbGl2ZXIsIE0uIEpvaG5zb24sIFIuIE1hbm5lcnQsIEUuIFNpb3JkaWEKCiAgQ29sbGFib3JhdG9yczogSW5maW5pdHlDb2RpbmcsIENvdWNoeSwgRGluZG9nLCBGbG94ZmxvYiwgVSBCbGVzcywgV2F0aWxpbiwgQHByZG9uYWh1ZSwgSG9zaGllLCAzbGYzbkxpM2QsIEFsZXhvLCBDcml0cywgTm9uYW1lMTIwLCBDcnQzMiwgSml4dW5Nb2UsIEF0aG9yY2lzLCBLaWxsZXJiYWRnZXIsIFNNZWQ3OSwgQWxleGFuZGVyMjU1LCBBbm9uc3VibWl0dGVyLCBSYXBvckxvTHBybywgTWF5bmFrMDAsIFJvYm90ZXgsIFZpbmN0dXgsIEJsYWh4LCBNYWpraUlULCBGNHosIEFuZ2Vsc2wsIE1pa2hhZWxrLCBNYXJlaywgSGFtc3RlcmJhY2tlLCBHb3JoaWxsLCBIYWNrZXI5OTksIHh4Y3JpdGljeHgsIFNrcjR0Y2hHcjNhenlNb25raUJhbGxsbGxsWnp6eiwgR2l3YXl1bWUsIE1yU2hlcmxvY2tIb2xtZXMsIHhEYXJrQVJHLCBOb2FocDc4LCBNYXB4LQoKICBVc2VyczogVGhhbmsgeW91IHRvIGFsbCB0aG9zZSB3aG8gdXNlIEFudGkgQWRibG9jayBLaWxsZXIsIHdobyByZXBvcnQgcHJvYmxlbXMsIHdobyB3cml0ZSB0aGUgcmV2aWV3LCB3aGljaCBhZGQgdG8gdGhlaXIgZmF2b3JpdGVzLCBtYWtpbmcgZG9uYXRpb25zLCB3aGljaCBzdXBwb3J0IHRoZSBwcm9qZWN0IGFuZCBoZWxwIGluIGl0cyBkZXZlbG9wbWVudCBvciBwcm9tb3RlLgoKPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQogIE1pcnJvcnMKPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQoKICBHaXRodWI6IGh0dHA6Ly90aW55dXJsLmNvbS9tY3JhM2RuCiAgR3JlYXN5Zm9yazogaHR0cDovL3Rpbnl1cmwuY29tL3BiYmRuaDYKICBPcGVudXNlcmpzOiBodHRwOi8vdGlueXVybC5jb20vbm5xamUzMgogIE1vbmtleUd1dHM6IGh0dHA6Ly90aW55dXJsLmNvbS9rYTVmY3FtCiAgVXNlcnNjcmlwdHM6IGh0dHA6Ly90aW55dXJsLmNvbS9xOHhjZWpsCgo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiAgRG9jdW1lbnRhdGlvbgo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CgogIEdyZWFzZW1vbmtleTogaHR0cDovL3Rpbnl1cmwuY29tL3llZWZuajUKICBTY3JpcHRpc2g6IGh0dHA6Ly90aW55dXJsLmNvbS9jbmQ5bmtkCiAgVGFtcGVybW9ua2V5OiBodHRwOi8vdGlueXVybC5jb20vcGR5dGZkZQogIFZpb2xlbnRtb25rZXk6IGh0dHA6Ly90aW55dXJsLmNvbS9uMzR3bjZqCiAgTmluamFLaXQ6IGh0dHA6Ly90aW55dXJsLmNvbS9wa2ttOXVnCgo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiAgU2NyaXB0Cj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSovCgooZnVuY3Rpb24gKHdpbmRvdykgewogICJ1c2Ugc3RyaWN0IjsKICAKICB2YXIgQWFrID0gewogICAgbmFtZSA6ICdBbnRpLUFkYmxvY2sgS2lsbGVyJywKICAgIHZlcnNpb24gOiAnMTAuMCcsCiAgICBzY3JpcHRpZCA6ICdnSldFcDB2QicsCiAgICBob21lVVJMIDogJ2h0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvJywKICAgIGNoYW5nZWxvZ1VSTCA6ICdodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyI2NoYW5nZWxvZycsCiAgICBkb25hdGVVUkwgOiAnaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlciNkb25hdGUnLAogICAgZmVhdHVyZXNVUkwgOiAnaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlciNmZWF0dXJlcycsCiAgICByZXBvcnRVUkwgOiAnaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci93aWtpL1JlcG9ydC1HdWlkZScsCiAgICBjb250YWN0VVJMIDogJ2h0dHBzOi8vcmVlay5naXRodWIuaW8vYW50aS1hZGJsb2NrLWtpbGxlci8jY29udGFjdCcsCiAgICBzZXR0aW5nc1VSTCA6ICdodHRwczovL3JlZWsuZ2l0aHViLmlvL2FudGktYWRibG9jay1raWxsZXIvI3NldHRpbmdzJywKICAgIHR3aXR0ZXJVUkwgOiAnaHR0cHM6Ly90d2l0dGVyLmNvbS9hbnRpYWRia2lsbGVyJywKICAgIGRvd25sb2FkVVJMIDogJ2h0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvbWFzdGVyL2FudGktYWRibG9jay1raWxsZXIudXNlci5qcycsCiAgICBzdWJzY3JpYmVVUkwgOiAnaHR0cHM6Ly9yZWVrLmdpdGh1Yi5pby9hbnRpLWFkYmxvY2sta2lsbGVyLyNmaWx0ZXJsaXN0JywKICAgIGxpc3RVUkwgOiAiaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9tYXN0ZXIvYW50aS1hZGJsb2NrLWtpbGxlci1maWx0ZXJzLnR4dCIsCiAgICBuYXRpdmVVUkwgOiAnaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci93aWtpL05hdGl2ZS1Nb2RlJywKICAgIGljb25VUkwgOiAnaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9tYXN0ZXIvYW50aS1hZGJsb2NrLWtpbGxlci1pY29uLnBuZycsCiAgICBpbWdCYWl0IDogJ2RhdGE6aW1hZ2UvcG5nO2Jhc2U2NCxpVkJPUncwS0dnb0FBQUFOU1VoRVVnQUFBQ0FBQUFBZ0NBUUFBQURaYzdKL0FBQUFHa2xFUVZSNDJtTmcwR0FZQmFOZ0ZJeUNVVEFLUnNFb1FBWUFUTjhBS1lOWi94NEFBQUFBU1VWT1JLNUNZSUk9JywKICAgIGluaXRpYWxpemUgOiBmdW5jdGlvbiAoKSB7CiAgICAgIEFhay5yZWdpc3RlclNldHRpbmdzKCk7IC8vIHJlZ2lzdGVyaW5nIHlvdXIgc2V0dGluZ3MuCiAgICAgIEFhay5yZWdpc3RlckNvbnNvbGUoKTsgLy8gcmVnaXN0ZXJpbmcgY3VzdG9temVkIGNvbnNvbGUuCiAgICAgIEFhay5yZWdpc3RlckNvbW1hbmRzKCk7IC8vIGFkZCBjb21tYW5kcyB0byBtZW51CiAgICAgIEFhay5jaGVja1VwZGF0ZSh0cnVlKTsgLy8gY2hlY2sgaWYgQWFrU2NyaXB0IGlzIHVwIHRvIGRhdGUuCiAgICAgIEFhay5jaGVja0xpc3QoKTsgLy8gY2hlY2sgaWYgQWFrTGlzdCBpcyBlbmFibGVkLgogICAgICBBYWsuYmxvY2tEZXRlY3QoKTsgLy8gZGV0ZWN0IGFuZCBraWxsIGFudGktYWRibG9ja3MuCiAgICB9LAogICAgYWFicyA6IHt9LAogICAgb3B0cyA6IHt9LAogICAgb3B0aW9ucyA6IHsKICAgICAgYXV0b1BsYXkgOiB7CiAgICAgICAgZ3JvdXAgOiAnZ2VuZXJhbCcsCiAgICAgICAgdHlwZSA6ICdjaGVja2JveCcsCiAgICAgICAgdmFsdWUgOiBmYWxzZSwKICAgICAgICBsYWJlbCA6ICdQbGF5IHZpZGVvIGF1dG9tYXRpY2FsbHkuIConLAogICAgICAgIGluZm8gOiAnJwogICAgICB9LAogICAgICB2aWRlb0hEIDogewogICAgICAgIGdyb3VwIDogJ2dlbmVyYWwnLAogICAgICAgIHR5cGUgOiAnY2hlY2tib3gnLAogICAgICAgIHZhbHVlIDogZmFsc2UsCiAgICAgICAgbGFiZWwgOiAnUGxheSB2aWRlbyBpbiBIRCBxdWFsaXR5LiAqKicsCiAgICAgICAgaW5mbyA6ICcnCiAgICAgIH0sCiAgICAgIGZvcmNlVkxDIDogewogICAgICAgIGdyb3VwIDogJ2dlbmVyYWwnLAogICAgICAgIHR5cGUgOiAnY2hlY2tib3gnLAogICAgICAgIHZhbHVlIDogZmFsc2UsCiAgICAgICAgbGFiZWwgOiAnUGxheSB2aWRlbyB3aXRoIFZMQyBwbHVnaW4uIConLAogICAgICAgIGluZm8gOiAnJwogICAgICB9LAogICAgICBjaGVja0xpc3QgOiB7CiAgICAgICAgZ3JvdXAgOiAnZ2VuZXJhbCcsCiAgICAgICAgdHlwZSA6ICdjaGVja2JveCcsCiAgICAgICAgdmFsdWUgOiB0cnVlLAogICAgICAgIGxhYmVsIDogJ0NoZWNrIEFha0xpc3Qgc3Vic2NyaXB0aW9uLicsCiAgICAgICAgaW5mbyA6ICcnCiAgICAgIH0sCiAgICAgIGNoZWNrVXBkYXRlIDogewogICAgICAgIGdyb3VwIDogJ2dlbmVyYWwnLAogICAgICAgIHR5cGUgOiAnY2hlY2tib3gnLAogICAgICAgIHZhbHVlIDogdHJ1ZSwKICAgICAgICBsYWJlbCA6ICdDaGVjayBuZXdlciBBYWtTY3JpcHQgdmVyc2lvbi4nLAogICAgICAgIGluZm8gOiAnJwogICAgICB9LAogICAgICBkZWJ1ZyA6IHsKICAgICAgICBncm91cCA6ICdkZWJ1ZycsCiAgICAgICAgdHlwZSA6ICdjaGVja2JveCcsCiAgICAgICAgdmFsdWUgOiBmYWxzZSwKICAgICAgICBsYWJlbCA6ICdFbmFibGUgTG9ncy4nLAogICAgICAgIGluZm8gOiAnJwogICAgICB9LAogICAgICBsb2dJbnNlcnRlZE5vZGVzIDogewogICAgICAgIGdyb3VwIDogJ2RlYnVnJywKICAgICAgICB0eXBlIDogJ2NoZWNrYm94JywKICAgICAgICB2YWx1ZSA6IGZhbHNlLAogICAgICAgIGxhYmVsIDogJ0xvZyBpbnNlcnRlZCBub2Rlcy4nLAogICAgICAgIGluZm8gOiAnJwogICAgICB9LAogICAgICBsb2dSZW1vdmVkTm9kZXMgOiB7CiAgICAgICAgZ3JvdXAgOiAnZGVidWcnLAogICAgICAgIHR5cGUgOiAnY2hlY2tib3gnLAogICAgICAgIHZhbHVlIDogZmFsc2UsCiAgICAgICAgbGFiZWwgOiAnTG9nIHJlbW92ZWQgbm9kZXMuJywKICAgICAgICBpbmZvIDogJycKICAgICAgfSwKICAgICAgbG9nRXhjbHVkZWQgOiB7CiAgICAgICAgZ3JvdXAgOiAnZGVidWcnLAogICAgICAgIHR5cGUgOiAnY2hlY2tib3gnLAogICAgICAgIHZhbHVlIDogZmFsc2UsCiAgICAgICAgbGFiZWwgOiAnTG9nIGV4Y2x1ZGVzIGRvbWFpbnMuJywKICAgICAgICBpbmZvIDogJycKICAgICAgfSwKICAgICAgbG9nWGhyIDogewogICAgICAgIGdyb3VwIDogJ2RlYnVnJywKICAgICAgICB0eXBlIDogJ2NoZWNrYm94JywKICAgICAgICB2YWx1ZSA6IGZhbHNlLAogICAgICAgIGxhYmVsIDogJ0xvZyBIVFRQIHJlcXVlc3RzJywKICAgICAgICBpbmZvIDogJycKICAgICAgfSwKICAgICAgbG9nUGxheWVyIDogewogICAgICAgIGdyb3VwIDogJ2RlYnVnJywKICAgICAgICB0eXBlIDogJ2NoZWNrYm94JywKICAgICAgICB2YWx1ZSA6IGZhbHNlLAogICAgICAgIGxhYmVsIDogJ0xvZyBwbGF5ZXIgaW5zdGFuY2VzLicsCiAgICAgICAgaW5mbyA6ICcnCiAgICAgIH0sCiAgICAgIGxvZ0ludGVyY2VwdGVkU2NyaXB0cyA6IHsKICAgICAgICBncm91cCA6ICdkZWJ1ZycsCiAgICAgICAgdHlwZSA6ICdjaGVja2JveCcsCiAgICAgICAgdmFsdWUgOiBmYWxzZSwKICAgICAgICBsYWJlbCA6ICdMb2cgaW50ZXJjZXB0ZWQgc2NyaXB0cy4nLAogICAgICAgIGluZm8gOiAnJwogICAgICB9LAogICAgICBsb2dEZXRlY3RlZCA6IHsKICAgICAgICBncm91cCA6ICdkZWJ1ZycsCiAgICAgICAgdHlwZSA6ICdjaGVja2JveCcsCiAgICAgICAgdmFsdWUgOiBmYWxzZSwKICAgICAgICBsYWJlbCA6ICdMb2cgZGV0ZWN0ZWQgYW50aS1hZGJsb2Nrcy4nLAogICAgICAgIGluZm8gOiAnJwogICAgICB9CiAgICB9LAogICAgcmVnaXN0ZXJTZXR0aW5ncyA6IGZ1bmN0aW9uICgpIHsKICAgICAgZm9yICh2YXIgb3B0TmFtZSBpbiBBYWsub3B0aW9ucykgewogICAgICAgIGlmIChBYWsub3B0aW9ucy5oYXNPd25Qcm9wZXJ0eShvcHROYW1lKSkKICAgICAgICAgIEFhay5vcHRzW29wdE5hbWVdID0gQWFrLmdldFZhbHVlKG9wdE5hbWUpICE9PSBudWxsID8gQWFrLmdldFZhbHVlKG9wdE5hbWUpIDogQWFrLm9wdGlvbnNbb3B0TmFtZV0udmFsdWU7CiAgICAgIH0KICAgIH0sCiAgICBjb21tYW5kcyA6IFt7CiAgICAgICAgY2FwdGlvbiA6ICdIb21lcGFnZScsCiAgICAgICAgZXhlY3V0ZSA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEFhay5nbyhBYWsuaG9tZVVSTCk7CiAgICAgICAgfQogICAgICB9LCB7CiAgICAgICAgY2FwdGlvbiA6ICdTZXR0aW5ncycsCiAgICAgICAgZXhlY3V0ZSA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEFhay5nbyhBYWsuc2V0dGluZ3NVUkwpOwogICAgICAgIH0KICAgICAgfSwgewogICAgICAgIGNhcHRpb24gOiAnVXBkYXRlJywKICAgICAgICBleGVjdXRlIDogZnVuY3Rpb24gKCkgewogICAgICAgICAgQWFrLmNoZWNrVXBkYXRlKCk7CiAgICAgICAgfQogICAgICB9CiAgICBdLAogICAgYWRkQ29tbWFuZHMgOiBmdW5jdGlvbiAoY21kKSB7CiAgICAgIGlmIChBYWsudXNlR00gJiYgQWFrLmlzVG9wZnJhbWUgJiYgdHlwZW9mIEdNX3JlZ2lzdGVyTWVudUNvbW1hbmQgIT0gJ3VuZGVmaW5lZCcpIHsKICAgICAgICBHTV9yZWdpc3Rlck1lbnVDb21tYW5kKFtBYWsubmFtZSwgQWFrLmdldFZlcnNpb24oKSwgY21kLmNhcHRpb25dLmpvaW4oJyAnKSwgY21kLmV4ZWN1dGUpOwogICAgICB9CiAgICB9LAogICAgcmVnaXN0ZXJDb21tYW5kcyA6IGZ1bmN0aW9uICgpIHsKICAgICAgQWFrLnJlYWR5KGZ1bmN0aW9uICgpIHsKICAgICAgICAvLyBTY3JpcHRpc2gKICAgICAgICAvLyBub3RlOiBObyBtZW51IGNvbW1hbmQgaXMgY3JlYXRlZCB3aGVuIHRoZSB1c2VyIHNjcmlwdCBpcyBydW4gaW4gYSBpZnJhbWUgd2luZG93LgogICAgICAgIC8vIGRvYzogaHR0cDovL3Rpbnl1cmwuY29tL2t2dnY3eXQKICAgICAgICBBYWsuY29tbWFuZHMuZm9yRWFjaChmdW5jdGlvbiAoY21kKSB7CiAgICAgICAgICBBYWsuYWRkQ29tbWFuZHMoY21kKTsKICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9LAogICAgcmVnaXN0ZXJDb25zb2xlIDogZnVuY3Rpb24gKCkgewogICAgICB0aGlzLmxvZyA9IEFhay5vcHRzLmRlYnVnID8gY29uc29sZS5sb2cuYmluZChjb25zb2xlKSA6IGZ1bmN0aW9uICgpIHt9OwogICAgICB0aGlzLmluZm8gPSBBYWsub3B0cy5kZWJ1ZyA/IGNvbnNvbGUuaW5mby5iaW5kKGNvbnNvbGUpIDogZnVuY3Rpb24gKCkge307CiAgICAgIHRoaXMuZXJyb3IgPSBBYWsub3B0cy5kZWJ1ZyA/IGNvbnNvbGUuZXJyb3IuYmluZChjb25zb2xlKSA6IGZ1bmN0aW9uICgpIHt9OwogICAgICB0aGlzLndhcm4gPSBBYWsub3B0cy5kZWJ1ZyA/IGNvbnNvbGUud2Fybi5iaW5kKGNvbnNvbGUpIDogZnVuY3Rpb24gKCkge307CiAgICB9LAogICAgaXNUb3BmcmFtZSA6ICh3aW5kb3cucGFyZW50ID09IHdpbmRvdy5zZWxmKSwKICAgIHV3IDogdHlwZW9mIHVuc2FmZVdpbmRvdyAhPSAndW5kZWZpbmVkJyA/IHVuc2FmZVdpbmRvdyA6IHdpbmRvdywKICAgIHVzZUdNIDogdHlwZW9mIEdNX2dldFZhbHVlICE9ICd1bmRlZmluZWQnLAogICAgYXBpR00gOiBmdW5jdGlvbiAoKSB7CiAgICAgIGlmIChBYWsuaXNUb3BmcmFtZSkgewogICAgICAgIC8vIEdNIEFQSSAtIGh0dHA6Ly90aW55dXJsLmNvbS95ZWVmbmo1CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgIEdNX3htbGh0dHBSZXF1ZXN0IDogdHlwZW9mIEdNX3htbGh0dHBSZXF1ZXN0ICE9ICd1bmRlZmluZWQnLAogICAgICAgICAgR01fc2V0VmFsdWUgOiB0eXBlb2YgR01fc2V0VmFsdWUgIT0gJ3VuZGVmaW5lZCcsCiAgICAgICAgICBHTV9nZXRWYWx1ZSA6IHR5cGVvZiBHTV9nZXRWYWx1ZSAhPSAndW5kZWZpbmVkJywKICAgICAgICAgIEdNX2FkZFN0eWxlIDogdHlwZW9mIEdNX2FkZFN0eWxlICE9ICd1bmRlZmluZWQnLAogICAgICAgICAgR01fcmVnaXN0ZXJNZW51Q29tbWFuZCA6IHR5cGVvZiBHTV9yZWdpc3Rlck1lbnVDb21tYW5kICE9ICd1bmRlZmluZWQnLAogICAgICAgICAgR01faW5mbyA6IHR5cGVvZiBHTV9pbmZvICE9ICd1bmRlZmluZWQnLAogICAgICAgICAgR01fZ2V0TWV0YWRhdGEgOiB0eXBlb2YgR01fZ2V0TWV0YWRhdGEgIT0gJ3VuZGVmaW5lZCcsCiAgICAgICAgICBHTV9kZWxldGVWYWx1ZSA6IHR5cGVvZiBHTV9kZWxldGVWYWx1ZSAhPSAndW5kZWZpbmVkJywKICAgICAgICAgIEdNX2xpc3RWYWx1ZXMgOiB0eXBlb2YgR01fbGlzdFZhbHVlcyAhPSAndW5kZWZpbmVkJywKICAgICAgICAgIEdNX2dldFJlc291cmNlVGV4dCA6IHR5cGVvZiBHTV9nZXRSZXNvdXJjZVRleHQgIT0gJ3VuZGVmaW5lZCcsCiAgICAgICAgICBHTV9nZXRSZXNvdXJjZVVSTCA6IHR5cGVvZiBHTV9nZXRSZXNvdXJjZVVSTCAhPSAndW5kZWZpbmVkJywKICAgICAgICAgIEdNX2xvZyA6IHR5cGVvZiBHTV9sb2cgIT0gJ3VuZGVmaW5lZCcsCiAgICAgICAgICBHTV9vcGVuSW5UYWIgOiB0eXBlb2YgR01fb3BlbkluVGFiICE9ICd1bmRlZmluZWQnLAogICAgICAgICAgR01fc2V0Q2xpcGJvYXJkIDogdHlwZW9mIEdNX3NldENsaXBib2FyZCAhPSAndW5kZWZpbmVkJwogICAgICAgIH07CiAgICAgIH0KICAgIH0sCiAgICBnbyA6IGZ1bmN0aW9uICh1cmwpIHsKICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSB1cmw7CiAgICB9LAogICAgcmVmcmVzaCA6IGZ1bmN0aW9uICgpIHsKICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSB3aW5kb3cubG9jYXRpb24uaHJlZjsKICAgIH0sCiAgICByZWxvYWQgOiBmdW5jdGlvbiAoKSB7CiAgICAgIHdpbmRvdy5sb2NhdGlvbi5yZWxvYWQodHJ1ZSk7CiAgICB9LAogICAgY29udGFpbnMgOiBmdW5jdGlvbiAoc3RyaW5nLCBzZWFyY2gpIHsKICAgICAgcmV0dXJuIHN0cmluZy5pbmRleE9mKHNlYXJjaCkgIT0gLTE7CiAgICB9LAogICAgZ2V0QnJvd3NlciA6IGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIHVhID0gd2luZG93Lm5hdmlnYXRvci51c2VyQWdlbnQ7CiAgICAgIGlmIChBYWsuY29udGFpbnModWEsICdGaXJlZm94JykpIHsKICAgICAgICByZXR1cm4gIkZpcmVmb3giOwogICAgICB9IGVsc2UgaWYgKEFhay5jb250YWlucyh1YSwgJ1NsZWlwbmlyJykpIHsKICAgICAgICByZXR1cm4gIlNsZWlwbmlyIjsgLy8gTW9iaWxlCiAgICAgIH0gZWxzZSBpZiAoQWFrLmNvbnRhaW5zKHVhLCAnVUNCcm93c2VyJykpIHsKICAgICAgICByZXR1cm4gIlVDQnJvd3NlciI7IC8vIE1vYmlsZQogICAgICB9IGVsc2UgaWYgKEFhay5jb250YWlucyh1YSwgJ0RvbGZpbicpKSB7CiAgICAgICAgcmV0dXJuICJEb2xwaGluIjsgLy8gTW9iaWxlCiAgICAgIH0gZWxzZSBpZiAoQWFrLmNvbnRhaW5zKHVhLCAnTVNJRScpKSB7CiAgICAgICAgcmV0dXJuICJJbnRlcm5ldEV4cGxvcmVyIjsKICAgICAgfSBlbHNlIGlmIChBYWsuY29udGFpbnModWEsICdNaWRvcmknKSkgewogICAgICAgIHJldHVybiAiTWlkb3JpIjsKICAgICAgfSBlbHNlIGlmIChBYWsuY29udGFpbnModWEsICdPcGVyYScpIHx8IEFhay5jb250YWlucyh1YSwgJ09QUicpKSB7CiAgICAgICAgcmV0dXJuICJPcGVyYSI7CiAgICAgIH0gZWxzZSBpZiAoQWFrLmNvbnRhaW5zKHVhLCAnQ2hyb21lJykpIHsKICAgICAgICByZXR1cm4gIkNocm9tZSI7CiAgICAgIH0gZWxzZSBpZiAoQWFrLmNvbnRhaW5zKHVhLCAnU2FmYXJpJykpIHsKICAgICAgICByZXR1cm4gIlNhZmFyaSI7CiAgICAgIH0gZWxzZSBpZiAoQWFrLmNvbnRhaW5zKHVhLCAnS29ucXVlcm9yJykpIHsKICAgICAgICByZXR1cm4gIktvbnF1ZXJvciI7CiAgICAgIH0gZWxzZSBpZiAoQWFrLmNvbnRhaW5zKHVhLCAnUGFsZU1vb24nKSkgewogICAgICAgIHJldHVybiAiUGFsZU1vb24iOyAvLyBmb3JrIGZpcmVmb3gKICAgICAgfSBlbHNlIGlmIChBYWsuY29udGFpbnModWEsICdDeWJlcmZveCcpKSB7CiAgICAgICAgcmV0dXJuICJDeWJlcmZveCI7IC8vIGZvcmsgZmlyZWZveAogICAgICB9IGVsc2UgaWYgKEFhay5jb250YWlucyh1YSwgJ1NlYU1vbmtleScpKSB7CiAgICAgICAgcmV0dXJuICJTZWFNb25rZXkiOyAvLyBmb3JrIGZpcmVmb3gKICAgICAgfSBlbHNlIGlmIChBYWsuY29udGFpbnModWEsICdJY2V3ZWFzZWwnKSkgewogICAgICAgIHJldHVybiAiSWNld2Vhc2VsIjsgLy8gZm9yayBmaXJlZm94CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuIHVhOwogICAgICB9CiAgICB9LAogICAgZ2V0VmVyc2lvbiA6IGZ1bmN0aW9uICgpIHsKICAgICAgcmV0dXJuIE51bWJlcihBYWsudmVyc2lvbik7CiAgICB9LAogICAgZ2V0U2NyaXB0TWFuYWdlciA6IGZ1bmN0aW9uICgpIHsKICAgICAgaWYgKHR5cGVvZiBHTV9pbmZvID09ICdvYmplY3QnKSB7CiAgICAgICAgLy8gR3JlYXNlbW9ua2V5IChGaXJlZm94KQogICAgICAgIGlmICh0eXBlb2YgR01faW5mby51dWlkICE9ICd1bmRlZmluZWQnKSB7CiAgICAgICAgICByZXR1cm4gJ0dyZWFzZW1vbmtleSc7CiAgICAgICAgfSAvLyBUYW1wZXJtb25rZXkgKENocm9tZS9PcGVyYSkKICAgICAgICBlbHNlIGlmICh0eXBlb2YgR01faW5mby5zY3JpcHRIYW5kbGVyICE9ICd1bmRlZmluZWQnKSB7CiAgICAgICAgICByZXR1cm4gJ1RhbXBlcm1vbmtleSc7CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIC8vIFNjcmlwdGlzaCAoRmlyZWZveCkKICAgICAgICBpZiAodHlwZW9mIEdNX2dldE1ldGFkYXRhID09ICdmdW5jdGlvbicpIHsKICAgICAgICAgIHJldHVybiAnU2NyaXB0aXNoJzsKICAgICAgICB9IC8vIE5pbmphS2l0IChTYWZhcmkvQ2hyb21lKQogICAgICAgIGVsc2UgaWYgKHR5cGVvZiBHTV9zZXRWYWx1ZSAhPSAndW5kZWZpbmVkJyAmJgogICAgICAgICAgdHlwZW9mIEdNX2dldFJlc291cmNlVGV4dCA9PSAndW5kZWZpbmVkJyAmJgogICAgICAgICAgdHlwZW9mIEdNX2dldFJlc291cmNlVVJMID09ICd1bmRlZmluZWQnICYmCiAgICAgICAgICB0eXBlb2YgR01fb3BlbkluVGFiID09ICd1bmRlZmluZWQnICYmCiAgICAgICAgICB0eXBlb2YgR01fc2V0Q2xpcGJvYXJkID09ICd1bmRlZmluZWQnKSB7CiAgICAgICAgICByZXR1cm4gJ05pbmphS2l0JzsKICAgICAgICB9IGVsc2UgeyAvLyBOYXRpdmUKICAgICAgICAgIHJldHVybiAnTmF0aXZlJzsKICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICBnZW5lcmF0ZUlEIDogZnVuY3Rpb24gKGxlbikgewogICAgICB2YXIgc3RyID0gJyc7CiAgICAgIHZhciBjaGFyc2V0ID0gImFiY2RlZmdoaWprbG5vcHFyc3R1dnd4eXpBQkNERUZHSElKS0xNTk9QUVJTVFVWV1hZWiI7CiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgKGxlbiA/IGxlbiA6IDEwKTsgKytpKSB7CiAgICAgICAgc3RyICs9IGNoYXJzZXQuY2hhckF0KE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIGNoYXJzZXQubGVuZ3RoKSk7CiAgICAgIH0KICAgICAgcmV0dXJuIHN0cjsKICAgIH0sCiAgICBnZW5lcmF0ZVVVSUQgOiBmdW5jdGlvbiAoKSB7CiAgICAgIC8vIFVuaXZlcnNhbGx5IFVuaXF1ZSBJRGVudGlmaWVyCiAgICAgIHZhciBkID0gbmV3IERhdGUoKS5nZXRUaW1lKCk7CiAgICAgIHZhciB1dWlkID0gJ3h4eHh4eHh4LXh4eHgtNHh4eC15eHh4LXh4eHh4eHh4eHh4eCcucmVwbGFjZSgvW3h5XS9nLCBmdW5jdGlvbiAoYykgewogICAgICAgICAgdmFyIHIgPSAoZCArIE1hdGgucmFuZG9tKCkgKiAxNikgJSAxNiB8IDA7CiAgICAgICAgICBkID0gTWF0aC5mbG9vcihkIC8gMTYpOwogICAgICAgICAgcmV0dXJuIChjID09ICd4JyA/IHIgOiAociAmIDB4NyB8IDB4OCkpLnRvU3RyaW5nKDE2KTsKICAgICAgICB9KTsKICAgICAgcmV0dXJuIHV1aWQ7CiAgICB9LAogICAgZ2V0VVVJRCA6IGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIG5hbWUgPSAndXVpZCc7CiAgICAgIGlmIChBYWsuZ2V0VmFsdWUobmFtZSkgPT09IG51bGwpIHsKICAgICAgICBBYWsuc2V0VmFsdWUobmFtZSwgQWFrLmdlbmVyYXRlVVVJRCgpKTsKICAgICAgfQogICAgICByZXR1cm4gQWFrLmdldFZhbHVlKG5hbWUpOwogICAgfSwKICAgIHNjaGVkdWxlIDogZnVuY3Rpb24gKGRheXMsIG5hbWUsIGNhbGxiYWNrKSB7CiAgICAgIHdpbmRvdy5zZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICB2YXIgbGF0ZXIgPSBpc05hTihBYWsuZ2V0VmFsdWUobmFtZSkpID8gMSA6IE51bWJlcihBYWsuZ2V0VmFsdWUobmFtZSkpOwogICAgICAgIHZhciBub3cgPSBuZXcgRGF0ZSgpLmdldFRpbWUoKTsKICAgICAgICBpZiAobGF0ZXIgPCBub3cpIHsKICAgICAgICAgIEFhay5zZXRWYWx1ZShuYW1lLCAobm93ICsgKGRheXMgKiAyNCAqIDYwICogNjAgKiAxMDAwKSkudG9TdHJpbmcoKSk7CiAgICAgICAgICBjYWxsYmFjaygpOwogICAgICAgIH0KICAgICAgfSwgMWUzKTsKICAgIH0sCiAgICBub3RpZmljYXRpb24gOiBmdW5jdGlvbiAobWVzc2FnZSwgZGVsYXkpIHsKICAgICAgaWYgKEFhay5pc1RvcGZyYW1lKSB7CgogICAgICAgIC8vIHJlbW92ZSBvbGQgbm90aWZpY2F0aW9uCiAgICAgICAgQWFrLnJlbW92ZUVsZW1lbnQoJyNhYWstbm90aWNlLWZyYW1lJyk7CgogICAgICAgIC8vIGFkZCBuZXcgbm90aWZpY2F0aW9uCiAgICAgICAgQWFrLmNyZWF0ZUVsZW1lbnQoewogICAgICAgICAgdGFnIDogJ2lmcmFtZScsCiAgICAgICAgICBpZCA6ICdhYWstbm90aWNlLWZyYW1lJywKICAgICAgICAgIHN0eWxlIDogJ3Bvc2l0aW9uOmZpeGVkOyB6LWluZGV4Ojk5OTk5OTsgdG9wOjEwcHg7IGxlZnQ6MTBweDsnLAogICAgICAgICAgd2lkdGggOiAnMzYwcHgnLAogICAgICAgICAgaGVpZ2h0IDogJzEyMHB4JywKICAgICAgICAgIGZyYW1lYm9yZGVyIDogMCwKICAgICAgICAgIHNjcm9sbGluZyA6ICdubycsCiAgICAgICAgICAvL3NyYyA6ICcvL2xvY2FsaG9zdC9naXQvYW50aS1hZGJsb2NrLWtpbGxlci1wYWdlcy9ub3RpZmljYXRpb24uaHRtbCMnICsgYnRvYShtZXNzYWdlKSwKICAgICAgICAgIHNyYyA6ICcvL3JlZWsuZ2l0aHViLmlvL2FudGktYWRibG9jay1raWxsZXIvbm90aWZpY2F0aW9uLmh0bWwjJyArIHdpbmRvdy5idG9hKG1lc3NhZ2UpLAogICAgICAgICAgYXBwZW5kIDogJ2JvZHknLAogICAgICAgICAgY2FsbGJhY2sgOiBmdW5jdGlvbiAoc2VsZikgewoKICAgICAgICAgICAgLy8gbWFudWFsbHkgcmVtb3ZlCiAgICAgICAgICAgIEFhay5vbkV2ZW50KHdpbmRvdywgIm1lc3NhZ2UiLCBmdW5jdGlvbiAoZXZlbnQpIHsKICAgICAgICAgICAgICBpZiAoZXZlbnQuZGF0YSA9PSAicmVtb3ZlTm90aWZpY2F0aW9uIikgewogICAgICAgICAgICAgICAgc2VsZi5yZW1vdmUoKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0sIGZhbHNlKTsKCiAgICAgICAgICAgIC8vIGF1dG9tYXRpY2FsbHkgcmVtb3ZlCiAgICAgICAgICAgIHdpbmRvdy5zZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICBzZWxmLnJlbW92ZSgpOwogICAgICAgICAgICB9LCBkZWxheSB8fCAzZTQpOwogICAgICAgICAgfQogICAgICAgIH0pOwoKICAgICAgfQogICAgfSwKICAgIGNoZWNrTGlzdCA6IGZ1bmN0aW9uICgpIHsKICAgICAgaWYgKEFhay51c2VHTSAmJiBBYWsub3B0cy5jaGVja0xpc3QgJiYgQWFrLmlzVG9wZnJhbWUpIHsKICAgICAgICBBYWsuc2NoZWR1bGUoMSwgJ25leHRjaGVja2xpc3QnLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBBYWsucmVhZHkoZnVuY3Rpb24gKCkgewogICAgICAgICAgICBBYWsuY3JlYXRlRWxlbWVudCh7CiAgICAgICAgICAgICAgdGFnIDogJ3NjcmlwdCcsCiAgICAgICAgICAgICAgc3JjIDogd2luZG93LmF0b2IoJ0x5OXlaV1ZyTG1kcGRHaDFZaTVwYnk5aGJuUnBMV0ZrWW14dlkyc3RhMmxzYkdWeUwyc3lWWGMzYVhOSWNrMXROVXBZVURGV2QyUjRZelUyTjFwTFl6RmhXalJKTG1weicpLAogICAgICAgICAgICAgIGFwcGVuZCA6ICdib2R5JywKICAgICAgICAgICAgICBldmVudCA6IHsKICAgICAgICAgICAgICAgIGVycm9yIDogZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICB0aGlzLnJlbW92ZSgpOwogICAgICAgICAgICAgICAgICBBYWsuaW5mbygnQWFrTGlzdCBkZXRlY3RlZCAhJyk7CiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgbG9hZCA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgdGhpcy5yZW1vdmUoKTsKICAgICAgICAgICAgICAgICAgQWFrLndhcm4oJ0Fha0xpc3Qgbm90IGRldGVjdGVkICEnKTsKICAgICAgICAgICAgICAgICAgQWFrLm5vdGlmaWNhdGlvbignSXQgc2VlbXMgdGhhdCB5b3UgaGF2ZSBub3Qgc3Vic2NyaWJlZCBvciBkaXNhYmxlZCA8Yj5BYWtMaXN0PC9iPi4gPGEgaHJlZj0iJyArIEFhay5zdWJzY3JpYmVVUkwgKyAnIiB0YXJnZXQ9Il9ibGFuayI+U3Vic2NyaWJlPC9hPiBvciA8YSBocmVmPSInICsgQWFrLnNldHRpbmdzVVJMICsgJyIgdGFyZ2V0PSJfYmxhbmsiPkRpc2FibGUgdGhpcyBhbGVydDwvYT4nKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSk7CiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0sCiAgICBjaGVja1VwZGF0ZSA6IGZ1bmN0aW9uIChhdXRvKSB7CgogICAgICB2YXIgY2hlY2sgPSBmdW5jdGlvbiAobm90aWZ5RmFsc2UpIHsKICAgICAgICBBYWsucmVxdWVzdCh7CiAgICAgICAgICB1cmwgOiBBYWsuZG93bmxvYWRVUkwsCiAgICAgICAgICBvbmxvYWQgOiBmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICAgICAgdmFyIHJlcyA9IHJlc3BvbnNlLnJlc3BvbnNlVGV4dDsKICAgICAgICAgICAgdmFyIHN0YXR1cyA9IHJlc3BvbnNlLnN0YXR1czsKICAgICAgICAgICAgaWYgKHN0YXR1cyA9PSAyMDApIHsKICAgICAgICAgICAgICB2YXIgbG9jYWwgPSBBYWsuZ2V0VmVyc2lvbigpOwogICAgICAgICAgICAgIHZhciByZW1vdGUgPSBOdW1iZXIocmVzLm1hdGNoKC9AdmVyc2lvblxzKyhcZCtcLlxkKykvKVsxXSk7CiAgICAgICAgICAgICAgaWYgKGxvY2FsIDwgcmVtb3RlKSB7CiAgICAgICAgICAgICAgICBBYWsubm90aWZpY2F0aW9uKCdBbnRpLUFkYmxvY2sgS2lsbGVyIHYnICsgcmVtb3RlICsgJyBpcyBhdmFpbGFibGUgPGEgdGFyZ2V0PSJfYmxhbmsiIGhyZWY9IicgKyBBYWsuZG93bmxvYWRVUkwgKyAnIj5JbnN0YWxsPC9hPi4nKTsKICAgICAgICAgICAgICB9IGVsc2UgaWYgKG5vdGlmeUZhbHNlKSB7CiAgICAgICAgICAgICAgICBBYWsubm90aWZpY2F0aW9uKCdObyB1cGRhdGUgZm91bmQuJyk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH07CgogICAgICBpZiAoYXV0bykgeyAvLyBhdXRvIG1vZGUKICAgICAgICBpZiAoQWFrLnVzZUdNICYmIEFhay5vcHRzLmNoZWNrVXBkYXRlICYmIEFhay5pc1RvcGZyYW1lKSB7CiAgICAgICAgICBBYWsucmVhZHkoZnVuY3Rpb24gKCkgewogICAgICAgICAgICBBYWsuc2NoZWR1bGUoNywgJ25leHRjaGVja3VwZGF0ZScsIGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICBjaGVjayhmYWxzZSk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9IGVsc2UgeyAvLyBtYW51YWwgbW9kZQogICAgICAgIGlmIChBYWsuaXNUb3BmcmFtZSkgewogICAgICAgICAgY2hlY2sodHJ1ZSk7CiAgICAgICAgfQogICAgICB9CgogICAgfSwKICAgIG9wZW5JblRhYiA6IGZ1bmN0aW9uICh1cmwpIHsKICAgICAgaWYgKHR5cGVvZiBHTV9vcGVuSW5UYWIgIT0gJ3VuZGVmaW5lZCcpIHsKICAgICAgICBHTV9vcGVuSW5UYWIodXJsKTsKICAgICAgfSBlbHNlIHsKICAgICAgICB2YXIgbmV3V2luZG93ID0gd2luZG93Lm9wZW4odXJsLCAiX2JsYW5rIik7CiAgICAgICAgbmV3V2luZG93LmZvY3VzKCk7CiAgICAgIH0KICAgIH0sCiAgICByZXF1ZXN0IDogZnVuY3Rpb24gKHNldHRpbmdzKSB7CiAgICAgIHNldHRpbmdzLnVybCA9IHNldHRpbmdzLnVybCB8fCAnJzsKICAgICAgc2V0dGluZ3MubWV0aG9kID0gc2V0dGluZ3MubWV0aG9kIHx8ICdHRVQnOwogICAgICBzZXR0aW5ncy5oZWFkZXJzID0gc2V0dGluZ3MuaGVhZGVycyB8fCB7fTsKICAgICAgc2V0dGluZ3MudGltZW91dCA9IHNldHRpbmdzLnRpbWVvdXQgfHwgMmU0OyAvLyAyMHMKICAgICAgaWYgKHNldHRpbmdzLmRhdGEgfHwgc2V0dGluZ3MubWV0aG9kID09ICdQT1NUJykgewogICAgICAgIHNldHRpbmdzLm1ldGhvZCA9ICdQT1NUJzsKICAgICAgICBzZXR0aW5ncy5kYXRhID0gQWFrLnNlcmlhbGl6ZShzZXR0aW5ncy5kYXRhIHx8IHt9KTsKICAgICAgICBzZXR0aW5ncy5oZWFkZXJzID0gQWFrLnNldFByb3BlcnRpZXMoc2V0dGluZ3MuaGVhZGVycywgewogICAgICAgICAgICAnWC1SZXF1ZXN0ZWQtV2l0aCcgOiAnWE1MSHR0cFJlcXVlc3QnLAogICAgICAgICAgICAnQ29udGVudC1UeXBlJyA6ICdhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQnCiAgICAgICAgICB9KTsKICAgICAgfQoKICAgICAgLy8gb3ZlcnJpZGUgdG8gaW50ZWdyYXRlIGxvZwogICAgICBzZXR0aW5ncy5fb25sb2FkID0gc2V0dGluZ3Mub25sb2FkOwogICAgICBzZXR0aW5ncy5vbmxvYWQgPSBmdW5jdGlvbiAoeGhyKSB7CiAgICAgICAgaWYgKEFhay5vcHRzLmxvZ1hocikgewogICAgICAgICAgQWFrLmxvZyhBYWsuZ2V0U2NyaXB0TWFuYWdlcigpICsgJyB4aHInLCB4aHIpOwogICAgICAgIH0KICAgICAgICBzZXR0aW5ncy5fb25sb2FkKHhocik7CiAgICAgIH07CgogICAgICBpZiAodHlwZW9mIEdNX3htbGh0dHBSZXF1ZXN0ICE9ICd1bmRlZmluZWQnKSB7CiAgICAgICAgLy8gUmVxdWVzdCB3aXRoIEdNIEFQSQogICAgICAgIC8vIGRvYzogaHR0cDovL3Rpbnl1cmwuY29tLzJ0N3dicgogICAgICAgIEdNX3htbGh0dHBSZXF1ZXN0KHNldHRpbmdzKTsKICAgICAgfSBlbHNlIHsKICAgICAgICAvLyBSZXF1ZXN0IHdpdGggV2ViIEFQSQogICAgICAgIC8vIFVzaW5nIHJlbW90ZSBzZXJ2ZXIgdG8gYWxsb3cgY3Jvc3Mtb3JpZ2luIHJlcXVlc3RzLgogICAgICAgIC8vIGRvYzogaHR0cDovL3Rpbnl1cmwuY29tL29kejY2NGEKICAgICAgICAvLyBkb2M6IGh0dHA6Ly90aW55dXJsLmNvbS9wOXpydXpuCiAgICAgICAgdmFyIHhociA9IG5ldyB3aW5kb3cuWE1MSHR0cFJlcXVlc3QoKTsKICAgICAgICB4aHIub3BlbignUE9TVCcsICdodHRwOi8vcmVla3NpdGUuY29tL3B1YmxpYy94aHIucGhwJywgdHJ1ZSk7CiAgICAgICAgeGhyLnNldFJlcXVlc3RIZWFkZXIoJ0NvbnRlbnQtdHlwZScsICdhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQnKTsKICAgICAgICB4aHIub25sb2FkID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgdmFyIHJlcyA9IHhoci5yZXNwb25zZVRleHQ7CiAgICAgICAgICB2YXIganNvbiA9IEpTT04gJiYgSlNPTi5wYXJzZShyZXMpOwogICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHhociwgInJlc3BvbnNlVGV4dCIsIHsKICAgICAgICAgICAgZW51bWVyYWJsZSA6IHRydWUsCiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZSA6IHRydWUsCiAgICAgICAgICAgIHdyaXRhYmxlIDogdHJ1ZSwKICAgICAgICAgICAgdmFsdWUgOiBqc29uLnJlc3BvbnNlCiAgICAgICAgICB9KTsKICAgICAgICAgIHNldHRpbmdzLm9ubG9hZCh4aHIpOwogICAgICAgIH07CiAgICAgICAgeGhyLnNlbmQoQWFrLnNlcmlhbGl6ZShzZXR0aW5ncykpOwogICAgICB9CiAgICB9LAogICAgZGVsZXRlVmFsdWUgOiBmdW5jdGlvbiAobmFtZSkgewogICAgICBpZiAodHlwZW9mIEdNX2RlbGV0ZVZhbHVlICE9PSAidW5kZWZpbmVkIiAmJiAhbmFtZSkgewogICAgICAgIHZhciB2YWxzID0gR01fbGlzdFZhbHVlcygpOwogICAgICAgIGZvciAodmFyIGkgaW4gdmFscykgewogICAgICAgICAgaWYgKHZhbHMuaGFzT3duUHJvcGVydHkoaSkpCiAgICAgICAgICAgIEdNX2RlbGV0ZVZhbHVlKHZhbHNbaV0pOwogICAgICAgIH0KICAgICAgfSBlbHNlIGlmICh0eXBlb2YgR01fZGVsZXRlVmFsdWUgIT09ICJ1bmRlZmluZWQiKSB7CiAgICAgICAgR01fZGVsZXRlVmFsdWUobmFtZSk7CiAgICAgIH0KICAgIH0sCiAgICBzZXRWYWx1ZSA6IGZ1bmN0aW9uIChuYW1lLCB2YWx1ZSkgewogICAgICBpZiAodHlwZW9mIEdNX3NldFZhbHVlICE9PSAidW5kZWZpbmVkIikgewogICAgICAgIEdNX3NldFZhbHVlKG5hbWUsIHZhbHVlKTsKICAgICAgfQogICAgfSwKICAgIGdldFZhbHVlIDogZnVuY3Rpb24gKG5hbWUpIHsKICAgICAgaWYgKHR5cGVvZiBHTV9saXN0VmFsdWVzICE9PSAidW5kZWZpbmVkIiAmJiAhbmFtZSkgewogICAgICAgIHZhciBsaXN0ID0ge307CiAgICAgICAgdmFyIHZhbHMgPSBHTV9saXN0VmFsdWVzKCk7CiAgICAgICAgZm9yICh2YXIgaSBpbiB2YWxzKSB7CiAgICAgICAgICBpZiAodmFscy5oYXNPd25Qcm9wZXJ0eShpKSkKICAgICAgICAgICAgbGlzdFt2YWxzW2ldXSA9IEdNX2dldFZhbHVlKHZhbHNbaV0pOwogICAgICAgIH0KICAgICAgICByZXR1cm4gbGlzdDsKICAgICAgfSBlbHNlIGlmICh0eXBlb2YgR01fZ2V0VmFsdWUgIT09ICJ1bmRlZmluZWQiICYmIHR5cGVvZiBHTV9nZXRWYWx1ZShuYW1lKSAhPT0gInVuZGVmaW5lZCIpIHsKICAgICAgICByZXR1cm4gR01fZ2V0VmFsdWUobmFtZSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgIH0KICAgIH0sCiAgICBzZXRMb2NhbCA6IGZ1bmN0aW9uIChuYW1lLCB2YWx1ZSkgewogICAgICB0cnkgewogICAgICAgIC8vIFNlY3VyaXR5RXJyb3I6IFRoZSBvcGVyYXRpb24gaXMgaW5zZWN1cmUuCiAgICAgICAgLy8gZG9jOiBodHRwOi8vdGlueXVybC5jb20vOHBlcXd2ZAogICAgICAgIGlmICh0eXBlb2Ygd2luZG93LmxvY2FsU3RvcmFnZSAhPT0gInVuZGVmaW5lZCIpIHsKICAgICAgICAgIHdpbmRvdy5sb2NhbFN0b3JhZ2Uuc2V0SXRlbShuYW1lLCB2YWx1ZS50b1N0cmluZygpKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgQWFrLndhcm4oIlNvcnJ5ISBObyBXZWIgU3RvcmFnZSBzdXBwb3J0LiIpOwogICAgICAgIH0KICAgICAgfSBjYXRjaCAoZSkge30KICAgIH0sCiAgICBnZXRMb2NhbCA6IGZ1bmN0aW9uIChuYW1lKSB7CiAgICAgIHRyeSB7CiAgICAgICAgaWYgKHR5cGVvZiB3aW5kb3cubG9jYWxTdG9yYWdlICE9PSAidW5kZWZpbmVkIikgewogICAgICAgICAgcmV0dXJuIHdpbmRvdy5sb2NhbFN0b3JhZ2UuZ2V0SXRlbShuYW1lKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgQWFrLndhcm4oIlNvcnJ5ISBObyBXZWIgU3RvcmFnZSBzdXBwb3J0LiIpOwogICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgfQogICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgIH0KICAgIH0sCiAgICBzZXRTZXNzaW9uIDogZnVuY3Rpb24gKG5hbWUsIHZhbHVlKSB7CiAgICAgIHRyeSB7CiAgICAgICAgLy8gRG9jOiBodHRwOi8vdGlueXVybC5jb20vOHBlcXd2ZAogICAgICAgIGlmICh0eXBlb2Ygd2luZG93LnNlc3Npb25TdG9yYWdlICE9PSAidW5kZWZpbmVkIikgewogICAgICAgICAgd2luZG93LnNlc3Npb25TdG9yYWdlLnNldEl0ZW0obmFtZSwgdmFsdWUudG9TdHJpbmcoKSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIEFhay53YXJuKCJTb3JyeSEgTm8gV2ViIFN0b3JhZ2Ugc3VwcG9ydC4iKTsKICAgICAgICB9CiAgICAgIH0gY2F0Y2ggKGUpIHt9CiAgICB9LAogICAgZ2V0U2Vzc2lvbiA6IGZ1bmN0aW9uIChuYW1lKSB7CiAgICAgIHRyeSB7CiAgICAgICAgaWYgKHR5cGVvZiB3aW5kb3cuc2Vzc2lvblN0b3JhZ2UgIT09ICJ1bmRlZmluZWQiKSB7CiAgICAgICAgICByZXR1cm4gd2luZG93LnNlc3Npb25TdG9yYWdlLmdldEl0ZW0obmFtZSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIEFhay53YXJuKCJTb3JyeSEgTm8gV2ViIFN0b3JhZ2Ugc3VwcG9ydC4iKTsKICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgIH0KICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgIHJldHVybiBudWxsOwogICAgICB9CiAgICB9LAogICAgc2V0Q29va2llIDogZnVuY3Rpb24gKG5hbWUsIHZhbHVlLCB0aW1lLCBwYXRoKSB7CiAgICAgIHZhciBleHBpcmVzID0gbmV3IERhdGUoKTsKICAgICAgZXhwaXJlcy5zZXRUaW1lKG5ldyBEYXRlKCkuZ2V0VGltZSgpICsgKHRpbWUgfHwgMzY1ICogMjQgKiA2MCAqIDYwICogMTAwMCkpOwogICAgICBkb2N1bWVudC5jb29raWUgPSBuYW1lICsgIj0iICsgZW5jb2RlVVJJQ29tcG9uZW50KHZhbHVlKSArICI7ZXhwaXJlcz0iICsgZXhwaXJlcy50b0dNVFN0cmluZygpICsgIjtwYXRoPSIgKyAocGF0aCB8fCAnLycpOwogICAgfSwKICAgIGdldENvb2tpZSA6IGZ1bmN0aW9uIChuYW1lKSB7CiAgICAgIHZhciB2YWx1ZSA9ICI7ICIgKyBkb2N1bWVudC5jb29raWU7CiAgICAgIHZhciBwYXJ0cyA9IHZhbHVlLnNwbGl0KCI7ICIgKyBuYW1lICsgIj0iKTsKICAgICAgaWYgKHBhcnRzLmxlbmd0aCA9PSAyKQogICAgICAgIHJldHVybiBwYXJ0cy5wb3AoKS5zcGxpdCgiOyIpLnNoaWZ0KCk7CiAgICB9LAogICAgc2V0UmVhZE9ubHkgOiBmdW5jdGlvbiAobmFtZSwgdmFsdWUpIHsKICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEFhay51dywgbmFtZSwgewogICAgICAgIHZhbHVlIDogdmFsdWUsCiAgICAgICAgY29uZmlndXJhYmxlIDogZmFsc2UsCiAgICAgICAgd3JpdGFibGUgOiBmYWxzZQogICAgICB9KTsKICAgIH0sCiAgICBzdG9wUmVkaXJlY3QgOiBmdW5jdGlvbiAoKSB7CiAgICAgIGlmICgnd2F0Y2gnIGluIHdpbmRvdykgewogICAgICAgIEFhay51dy53YXRjaCgibG9jYXRpb24iLCBmdW5jdGlvbiAoKSB7fSk7CiAgICAgICAgQWFrLnV3LmxvY2F0aW9uLndhdGNoKCJocmVmIiwgZnVuY3Rpb24gKCkge30pOwogICAgICB9IGVsc2UgewogICAgICAgIEFhay51dy5sb2NhdGlvbiA9ICIjIjsKICAgICAgICB0aHJvdyAnU3RvcCBSZWRpcmVjdCc7CiAgICAgIH0KICAgIH0sCiAgICBjb25maXJtTGVhdmUgOiBmdW5jdGlvbiAoKSB7CiAgICAgIHdpbmRvdy5vbmJlZm9yZXVubG9hZCA9IGZ1bmN0aW9uICgpIHsKICAgICAgICByZXR1cm4gJyc7CiAgICAgIH07CiAgICB9LAogICAgY29uZmlybVJlcG9ydCA6IGZ1bmN0aW9uIChlbGVtKSB7CiAgICAgIGVsZW0uaW5uZXJIVE1MID0gJ1JlcG9ydCc7CiAgICAgIGVsZW0udGl0bGUgPSAnUmVwb3J0IGlzc3VlIG9yIGFudGktYWRibG9jayc7CiAgICAgIGVsZW0ub25jbGljayA9IGZ1bmN0aW9uIChlKSB7CiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOwogICAgICAgIGlmICh3aW5kb3cuY29uZmlybSgiRG8geW91IHdhbnQgdG8gcmVwb3J0IGlzc3VlIG9yIGFudGktYWRibG9jayA/IikpIHsgLy8gQ2xpYyBvbiBPSwogICAgICAgICAgQWFrLmdvKEFhay5yZXBvcnRVUkwpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBBYWsuZ28oZWxlbS5ocmVmKTsKICAgICAgICB9CiAgICAgIH07CiAgICB9LAogICAgdW5wYWNrU2NyaXB0IDogZnVuY3Rpb24gKHNvdXJjZSkgewogICAgICAvLyBkZW9iZnVzY2F0ZTogcGFjK2tlZCwgcGFjK2tlciwgbXVuK2dlZCwgd2krc2UKICAgICAgLy8gbm90ZTogIkV4Y2VwdGlvbiA0MDMwMDgiIHNlZSBncmVhc2Vmb3JrIFBNCiAgICAgIHZhciBzdWJzdHJpbmcgPSBzb3VyY2Uuc3Vic3RyaW5nKHNvdXJjZS5pbmRleE9mKCdldmFsKCcpKzQsIHNvdXJjZS5sYXN0SW5kZXhPZignKScpKzEpOwogICAgICByZXR1cm4gbmV3IEZ1bmN0aW9uKCdyZXR1cm4gJytzdWJzdHJpbmcpKCk7CiAgICB9LAogICAgaGFzU2NyaXB0IDogZnVuY3Rpb24gKGNvbnRhaW5zLCBkb2MpIHsKICAgICAgLy8gYnk6IFdhdGlsaW4KICAgICAgcmV0dXJuIEFycmF5LnByb3RvdHlwZS5maWx0ZXIuY2FsbCgKICAgICAgICBkb2MgJiYgZG9jLnNjcmlwdHMgfHwgZG9jdW1lbnQuc2NyaXB0cywKICAgICAgICBmdW5jdGlvbiAoJHNjcmlwdCkgewogICAgICAgIHZhciBzb3VyY2UgPSAkc2NyaXB0LmlubmVySFRNTDsKICAgICAgICByZXR1cm4gc291cmNlICYmIHNvdXJjZS5pbmRleE9mKGNvbnRhaW5zKSAhPSAtMTsKICAgICAgfSlbMF07CiAgICB9LAogICAgYWRkU2NyaXB0IDogZnVuY3Rpb24gKHNvdXJjZSwgYm9keSkgewogICAgICB2YXIgc2NyaXB0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc2NyaXB0Jyk7CiAgICAgIHNjcmlwdC50eXBlID0gInRleHQvamF2YXNjcmlwdCI7CiAgICAgIHNjcmlwdC5pbm5lckhUTUwgPSAodHlwZW9mIHNvdXJjZSA9PT0gJ2Z1bmN0aW9uJykgPyBBYWsuaW50b1N0cmluZyhzb3VyY2UpIDogc291cmNlLnRvU3RyaW5nKCk7CiAgICAgIGlmIChib2R5KSB7CiAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChzY3JpcHQpOwogICAgICB9IGVsc2UgewogICAgICAgIGRvY3VtZW50LmhlYWQuYXBwZW5kQ2hpbGQoc2NyaXB0KTsKICAgICAgfQogICAgICBzY3JpcHQucmVtb3ZlKCk7CiAgICB9LAogICAgbG9hZFNjcmlwdCA6IGZ1bmN0aW9uIChzcmMsIGJvZHksIG9ubG9hZCkgewogICAgICB2YXIgc2NyaXB0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc2NyaXB0Jyk7CiAgICAgIHNjcmlwdC50eXBlID0gInRleHQvamF2YXNjcmlwdCI7CiAgICAgIHNjcmlwdC5zcmMgPSBzcmM7CiAgICAgIGlmIChvbmxvYWQpIHsKICAgICAgICBzY3JpcHQub25sb2FkID0gb25sb2FkOwogICAgICB9CiAgICAgIGlmIChib2R5KSB7CiAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChzY3JpcHQpOwogICAgICB9IGVsc2UgewogICAgICAgIGRvY3VtZW50LmhlYWQuYXBwZW5kQ2hpbGQoc2NyaXB0KTsKICAgICAgfQogICAgfSwKICAgIGltcG9ydFNjcmlwdCA6IGZ1bmN0aW9uICh1cmwsIGNhbGxiYWNrKSB7CiAgICAgIEFhay5yZXF1ZXN0KHsKICAgICAgICB1cmwgOiB1cmwsCiAgICAgICAgb25sb2FkIDogZnVuY3Rpb24gKHJlc3VsdCkgewogICAgICAgICAgdmFyIHJhd1NjcmlwdCA9IHJlc3VsdC5yZXNwb25zZVRleHQ7CiAgICAgICAgICAobmV3IEZ1bmN0aW9uKCdBYWsnLCByYXdTY3JpcHQgKyAnXG5ccicgKyBBYWsuaW50b1N0cmluZyhjYWxsYmFjaykpKShBYWspOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9LAogICAgaW50b1N0cmluZyA6IGZ1bmN0aW9uIChhKSB7CiAgICAgIGlmICh0eXBlb2YgYSA9PT0gJ2Z1bmN0aW9uJykgewogICAgICAgIHZhciBzdHIgPSBhLnRvU3RyaW5nKCk7CiAgICAgICAgdmFyIGZpcnN0ID0gc3RyLmluZGV4T2YoInsiKSArIDE7CiAgICAgICAgdmFyIGxhc3QgPSBzdHIubGFzdEluZGV4T2YoIn0iKTsKICAgICAgICByZXR1cm4gc3RyLnN1YnN0cihmaXJzdCwgbGFzdCAtIGZpcnN0KS50cmltKCk7CiAgICAgIH0gZWxzZSBpZiAodHlwZW9mIGVudHJ5ID09PSAnb2JqZWN0JykgewogICAgICAgIHJldHVybiBKU09OLnN0cmluZ2lmeShhKTsKICAgICAgfSBlbHNlIHsgLy8gYXJyYXkgb3Igc3RyaW5nCiAgICAgICAgcmV0dXJuIGEudG9TdHJpbmcoKTsKICAgICAgfQogICAgfSwKICAgIGludG9BcnJheSA6IGZ1bmN0aW9uIChhKSB7CiAgICAgIGlmICh0eXBlb2YgYSA9PT0gJ29iamVjdCcpIHsKICAgICAgICByZXR1cm4gT2JqZWN0LmtleXMoYSkubWFwKGZ1bmN0aW9uIChrZXkpIHsKICAgICAgICAgIHJldHVybiBhW2tleV07CiAgICAgICAgfSk7CiAgICAgIH0gZWxzZSBpZiAodHlwZW9mIGEgPT09ICdzdHJpbmcnKSB7CiAgICAgICAgcmV0dXJuIEpTT04ucGFyc2UoYSk7CiAgICAgIH0gZWxzZSBpZiAoQXJyYXkuaXNBcnJheShhKSkgewogICAgICAgIHJldHVybiBhOwogICAgICB9CiAgICB9LAogICAgaW50b09iamVjdCA6IGZ1bmN0aW9uIChhKSB7CiAgICAgIGlmICh0eXBlb2YgYSA9PT0gJ3N0cmluZycpIHsKICAgICAgICByZXR1cm4gSlNPTi5wYXJzZShhKTsKICAgICAgfSBlbHNlIGlmIChBcnJheS5pc0FycmF5KGEpKSB7CiAgICAgICAgZm9yICh2YXIgaSA9IDAsIG8gPSB7fTsgaSA8IGEubGVuZ3RoOyArK2kpIHsKICAgICAgICAgIG9baV0gPSBhW2ldOwogICAgICAgIH0KICAgICAgICByZXR1cm4gbzsKICAgICAgfSBlbHNlIGlmICh0eXBlb2YgYSA9PT0gJ29iamVjdCcpIHsKICAgICAgICByZXR1cm4gYTsKICAgICAgfQogICAgfSwKICAgIGhhc0VsZW1lbnQgOiBmdW5jdGlvbiAoc2VsZWN0b3IsIGNhbGxiYWNrLCB0aW1lb3V0KSB7CiAgICAgIHZhciByZXBlYXQgPSB0aW1lb3V0IHx8IDEwOwogICAgICB2YXIgbG9vcCA9IHNldEludGVydmFsKGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHZhciBlbGVtID0gQWFrLmdldEVsZW1lbnQoc2VsZWN0b3IpOwogICAgICAgICAgaWYgKGVsZW0pIHsKICAgICAgICAgICAgY2FsbGJhY2soZWxlbSk7CiAgICAgICAgICAgIGNsZWFySW50ZXJ2YWwobG9vcCk7CiAgICAgICAgICB9CiAgICAgICAgICByZXBlYXQgPSAocmVwZWF0KSA/IHJlcGVhdCAtIDEgOiBjbGVhckludGVydmFsKGxvb3ApOwogICAgICAgIH0sIDFlMyk7CiAgICB9LAogICAgcmVtb3ZlRWxlbWVudCA6IGZ1bmN0aW9uIChlbGVtKSB7CiAgICAgIGlmIChlbGVtIGluc3RhbmNlb2Ygd2luZG93LkhUTUxFbGVtZW50KSB7CiAgICAgICAgZWxlbS5yZW1vdmUoKTsKICAgICAgfSBlbHNlIGlmICh0eXBlb2YgZWxlbSA9PT0gInN0cmluZyIpIHsKICAgICAgICBlbGVtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChlbGVtKTsKICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGVsZW0ubGVuZ3RoOyBpKyspIHsKICAgICAgICAgIGVsZW1baV0ucmVtb3ZlKCk7CiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgZ2V0RWxlbWVudCA6IGZ1bmN0aW9uIChzZWxlY3RvciwgY29udGV4dE5vZGUpIHsKICAgICAgaWYgKHR5cGVvZiBzZWxlY3RvciA9PT0gJ3N0cmluZycpIHsKICAgICAgICBpZiAoc2VsZWN0b3IuaW5kZXhPZignLycpID09PSAwKSB7IC8vIGV4OiAvL2ltZ1tAY2xhc3M9InBob3RvIl0KICAgICAgICAgIHJldHVybiBkb2N1bWVudC5ldmFsdWF0ZShzZWxlY3RvciwgY29udGV4dE5vZGUgfHwgZG9jdW1lbnQsIG51bGwsIHdpbmRvdy5YUGF0aFJlc3VsdC5GSVJTVF9PUkRFUkVEX05PREVfVFlQRSwgbnVsbCkuc2luZ2xlTm9kZVZhbHVlOwogICAgICAgIH0KICAgICAgICByZXR1cm4gKGNvbnRleHROb2RlIHx8IGRvY3VtZW50KS5xdWVyeVNlbGVjdG9yKHNlbGVjdG9yKTsKICAgICAgfSBlbHNlIGlmIChzZWxlY3RvciBpbnN0YW5jZW9mIHdpbmRvdy5IVE1MRWxlbWVudCkgewogICAgICAgIHJldHVybiBzZWxlY3RvcjsKICAgICAgfQogICAgfSwKICAgIGNyZWF0ZUVsZW1lbnQgOiBmdW5jdGlvbiAocHJvcHMpIHsKICAgICAgdmFyIGVsZW0sCiAgICAgIG5vZGUgPSB7fTsKICAgICAgZm9yICh2YXIgbmFtZSBpbiBwcm9wcykgewogICAgICAgIGlmIChwcm9wcy5oYXNPd25Qcm9wZXJ0eShuYW1lKSkgewogICAgICAgICAgc3dpdGNoIChuYW1lKSB7CiAgICAgICAgICBjYXNlICJ0YWciOgogICAgICAgICAgICBub2RlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChwcm9wc1tuYW1lXSk7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgY2FzZSAidGV4dCI6CiAgICAgICAgICAgIHZhciB0ZXh0ID0gKCdpbm5lclRleHQnIGluIGRvY3VtZW50KSA/ICdpbm5lclRleHQnIDogJ3RleHRDb250ZW50JzsKICAgICAgICAgICAgbm9kZVt0ZXh0XSA9IHByb3BzW25hbWVdOwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIGNhc2UgImh0bWwiOgogICAgICAgICAgICBub2RlLmlubmVySFRNTCA9IHByb3BzW25hbWVdOwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIGNhc2UgImNsYXNzaWQiOgogICAgICAgICAgICBub2RlLmNsYXNzTmFtZSA9IHByb3BzW25hbWVdOwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIGNhc2UgImFwcGVuZCI6CiAgICAgICAgICAgIGVsZW0gPSBBYWsuZ2V0RWxlbWVudChwcm9wc1tuYW1lXSk7CiAgICAgICAgICAgIGVsZW0uYXBwZW5kQ2hpbGQobm9kZSk7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgY2FzZSAicHJlcGVuZCI6CiAgICAgICAgICAgIGVsZW0gPSBBYWsuZ2V0RWxlbWVudChwcm9wc1tuYW1lXSk7CiAgICAgICAgICAgIGlmIChlbGVtLmNoaWxkTm9kZXMubGVuZ3RoKSB7CiAgICAgICAgICAgICAgZWxlbS5pbnNlcnRCZWZvcmUobm9kZSwgZWxlbS5jaGlsZE5vZGVzWzBdKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICBlbGVtLmFwcGVuZENoaWxkKG5vZGUpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgY2FzZSAiYmVmb3JlIjoKICAgICAgICAgICAgZWxlbSA9IEFhay5nZXRFbGVtZW50KHByb3BzW25hbWVdKTsKICAgICAgICAgICAgZWxlbS5wYXJlbnROb2RlLmluc2VydEJlZm9yZShub2RlLCBlbGVtKTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICBjYXNlICJhZnRlciI6CiAgICAgICAgICAgIGVsZW0gPSBBYWsuZ2V0RWxlbWVudChwcm9wc1tuYW1lXSk7CiAgICAgICAgICAgIGVsZW0ucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUobm9kZSwgZWxlbS5uZXh0U2libGluZyk7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgY2FzZSAicmVwbGFjZSI6CiAgICAgICAgICAgIGVsZW0gPSBBYWsuZ2V0RWxlbWVudChwcm9wc1tuYW1lXSk7CiAgICAgICAgICAgIGVsZW0ucGFyZW50Tm9kZS5yZXBsYWNlQ2hpbGQobm9kZSwgZWxlbSk7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgY2FzZSAiZXZlbnQiOgogICAgICAgICAgICBmb3IgKHZhciBldk5hbWUgaW4gcHJvcHMuZXZlbnQpIHsKICAgICAgICAgICAgICBpZiAocHJvcHMuZXZlbnQuaGFzT3duUHJvcGVydHkoZXZOYW1lKSkKICAgICAgICAgICAgICAgIG5vZGUuYWRkRXZlbnRMaXN0ZW5lcihldk5hbWUsIHByb3BzLmV2ZW50W2V2TmFtZV0pOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgY2FzZSAiY2FsbGJhY2siOgogICAgICAgICAgICBwcm9wc1tuYW1lXShub2RlKTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICBub2RlLnNldEF0dHJpYnV0ZShuYW1lLCBwcm9wc1tuYW1lXSk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICAgIHJldHVybiBub2RlOwogICAgfSwKICAgIGFkZEJhaXRFbGVtZW50IDogZnVuY3Rpb24gKHN0ck9wdHMpIHsgLy8gZXg6IGRpdi5hZHMgb3Igc3BhbiNhZHNACiAgICAgIHZhciBvcHRzID0gc3RyT3B0cy5yZXBsYWNlKCcuJywgJzpjbGFzc05hbWU6JykucmVwbGFjZSgnIycsICc6aWQ6Jykuc3BsaXQoJzonKTsKICAgICAgdmFyIGJhaXQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KG9wdHNbMF0pOwogICAgICBiYWl0LnNldEF0dHJpYnV0ZShvcHRzWzFdLCBvcHRzWzJdKTsKICAgICAgYmFpdC5pbm5lckhUTUwgPSAiPGJyPiI7CiAgICAgIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5hcHBlbmRDaGlsZChiYWl0KTsKICAgICAgcmV0dXJuIGJhaXQ7CiAgICB9LAogICAgcmVwbGFjZUVsZW1lbnQgOiBmdW5jdGlvbiAob2xkTm9kZSwgbmV3Tm9kZSkgewogICAgICBvbGROb2RlLnBhcmVudE5vZGUucmVwbGFjZUNoaWxkKG5ld05vZGUsIG9sZE5vZGUpOwogICAgfSwKICAgIHNldEVsZW1lbnQgOiBmdW5jdGlvbiAoc2VsZWN0b3IsIHByb3BzKSB7CiAgICAgIHZhciBub2RlID0gQWFrLmdldEVsZW1lbnQoc2VsZWN0b3IpOwogICAgICBpZiAobm9kZSkgewogICAgICAgIGZvciAodmFyIG5hbWUgaW4gcHJvcHMpIHsKICAgICAgICAgIGlmIChwcm9wcy5oYXNPd25Qcm9wZXJ0eShuYW1lKSkgewogICAgICAgICAgICBzd2l0Y2ggKG5hbWUpIHsKICAgICAgICAgICAgY2FzZSAidGV4dCI6CiAgICAgICAgICAgICAgdmFyIHRleHQgPSAoJ2lubmVyVGV4dCcgaW4gZG9jdW1lbnQpID8gJ2lubmVyVGV4dCcgOiAndGV4dENvbnRlbnQnOwogICAgICAgICAgICAgIG5vZGVbdGV4dF0gPSBwcm9wc1tuYW1lXTsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSAiaHRtbCI6CiAgICAgICAgICAgICAgbm9kZS5pbm5lckhUTUwgPSBwcm9wc1tuYW1lXTsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSAiY2xhc3MiOgogICAgICAgICAgICAgIG5vZGUuY2xhc3NOYW1lID0gcHJvcHNbbmFtZV07CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAgICAgbm9kZS5zZXRBdHRyaWJ1dGUobmFtZSwgcHJvcHNbbmFtZV0pOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgYWRkU3R5bGUgOiBmdW5jdGlvbiAoY3NzKSB7CiAgICAgIGNzcyA9IGNzcy5yZXBsYWNlKC87L2csICcgIWltcG9ydGFudDsnKTsKICAgICAgaWYgKHR5cGVvZiBHTV9hZGRTdHlsZSAhPSAndW5kZWZpbmVkJykgewogICAgICAgIEdNX2FkZFN0eWxlKGNzcyk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgZG9jdW1lbnQuaGVhZC5hcHBlbmRDaGlsZChkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzdHlsZScpKS5pbm5lckhUTUwgPSBjc3M7CiAgICAgIH0KICAgIH0sCiAgICBsb2FkU3R5bGUgOiBmdW5jdGlvbiAoc3JjKSB7CiAgICAgIHZhciBzdHlsZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xpbmsnKTsKICAgICAgc3R5bGUucmVsID0gInN0eWxlc2hlZXQiOwogICAgICBzdHlsZS5ocmVmID0gc3JjOwogICAgICBkb2N1bWVudC5oZWFkLmFwcGVuZENoaWxkKHN0eWxlKTsKICAgIH0sCiAgICBnZXRTdHlsZSA6IGZ1bmN0aW9uIChzZWxlY3RvciwgcHJvcCkgewogICAgICB2YXIgZWxlbSA9IEFhay5nZXRFbGVtZW50KHNlbGVjdG9yKTsKICAgICAgaWYgKGVsZW0uY3VycmVudFN0eWxlKSB7CiAgICAgICAgcmV0dXJuIGVsZW0uY3VycmVudFN0eWxlW3Byb3BdOwogICAgICB9IGVsc2UgaWYgKHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKSB7CiAgICAgICAgcmV0dXJuIGRvY3VtZW50LmRlZmF1bHRWaWV3LmdldENvbXB1dGVkU3R5bGUoZWxlbSwgbnVsbCkuZ2V0UHJvcGVydHlWYWx1ZShwcm9wKTsKICAgICAgfQogICAgfSwKICAgIGRlY29kZVVSSSA6IGZ1bmN0aW9uIChzdHIpIHsKICAgICAgcmV0dXJuIGRlY29kZVVSSUNvbXBvbmVudChzdHIpOwogICAgfSwKICAgIGVuY29kZVVSSSA6IGZ1bmN0aW9uIChzdHIpIHsKICAgICAgcmV0dXJuIGVuY29kZVVSSUNvbXBvbmVudChzdHIpOwogICAgfSwKICAgIGVuY29kZUhUTUwgOiBmdW5jdGlvbiAoc3RyKSB7CiAgICAgIHJldHVybiBTdHJpbmcoc3RyKS5yZXBsYWNlKC8mL2csICcmYW1wOycpLnJlcGxhY2UoLzwvZywgJyZsdDsnKS5yZXBsYWNlKC8+L2csICcmZ3Q7JykucmVwbGFjZSgvIi9nLCAnJnF1b3Q7Jyk7CiAgICB9LAogICAgZGVjb2RlSFRNTCA6IGZ1bmN0aW9uIChzdHIpIHsKICAgICAgcmV0dXJuIFN0cmluZyhzdHIpLnJlcGxhY2UoLyZhbXA7L2csICcmJykucmVwbGFjZSgvJmx0Oy9nLCAnPCcpLnJlcGxhY2UoLyZndDsvZywgJz4nKS5yZXBsYWNlKC8mcXVvdDsvZywgJyInKTsKICAgIH0sCiAgICBzZXJpYWxpemUgOiBmdW5jdGlvbiAob2JqKSB7CiAgICAgIGlmICh0eXBlb2Ygb2JqID09ICdvYmplY3QnKSB7CiAgICAgICAgdmFyIGFyciA9IFtdOwogICAgICAgIGZvciAodmFyIHByb3AgaW4gb2JqKSB7CiAgICAgICAgICBpZiAob2JqLmhhc093blByb3BlcnR5KHByb3ApKQogICAgICAgICAgICBhcnIucHVzaChwcm9wICsgJz0nICsgQWFrLmVuY29kZVVSSShvYmpbcHJvcF0pKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIGFyci5qb2luKCcmJyk7CiAgICAgIH0KICAgICAgcmV0dXJuIG9iajsKICAgIH0sCiAgICB1bnNlcmlhbGl6ZSA6IGZ1bmN0aW9uIChzdHIpIHsKICAgICAgc3RyID0gQWFrLmRlY29kZUhUTUwoc3RyKTsKICAgICAgdmFyIGFyciA9IHN0ci5zcGxpdCgnJicpOwogICAgICB2YXIgb2JqID0ge307CiAgICAgIGFyci5mb3JFYWNoKGZ1bmN0aW9uIChlbnRyeSkgewogICAgICAgIGlmIChlbnRyeSAhPT0gJycgJiYgZW50cnkuc3BsaXQoJz0nKSkgewogICAgICAgICAgdmFyIHNwbGl0cyA9IGVudHJ5LnNwbGl0KCc9Jyk7CiAgICAgICAgICBvYmpbc3BsaXRzWzBdXSA9IEFhay5kZWNvZGVVUkkoc3BsaXRzWzFdKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgICByZXR1cm4gb2JqOwogICAgfSwKICAgIHVuc2V0UHJvcGVydGllcyA6IGZ1bmN0aW9uIChvYmosIHByb3BzKSB7CiAgICAgIHByb3BzID0gKHR5cGVvZiBwcm9wcyA9PSAnc3RyaW5nJykgPyBwcm9wcy5zcGxpdCgnLCcpIDogcHJvcHM7CiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsKICAgICAgICB2YXIgcHJvcCA9IHByb3BzW2ldOwogICAgICAgIGlmIChvYmouaGFzT3duUHJvcGVydHkocHJvcCkpIHsKICAgICAgICAgIGRlbGV0ZSBvYmpbcHJvcF07CiAgICAgICAgfQogICAgICB9CiAgICAgIHJldHVybiBvYmo7CiAgICB9LAogICAgc2V0UHJvcGVydGllcyA6IGZ1bmN0aW9uIChvYmoxLCBvYmoyKSB7CiAgICAgIGZvciAodmFyIHByb3AgaW4gb2JqMikgewogICAgICAgIGlmIChvYmoyLmhhc093blByb3BlcnR5KHByb3ApKQogICAgICAgICAgb2JqMVtwcm9wXSA9IG9iajJbcHJvcF07CiAgICAgIH0KICAgICAgcmV0dXJuIG9iajE7CiAgICB9LAogICAgZml4UHJvdG9jb2xVUkwgOiBmdW5jdGlvbiAodXJsKSB7CiAgICAgIGlmICgvXmh0dHAvLnRlc3QodXJsKSkgeyAvLyBhYnNvbHV0ZQogICAgICAgIHJldHVybiB1cmw7CiAgICAgIH0gZWxzZSBpZiAoL15cL1wvLy50ZXN0KHVybCkpIHsgLy8gcmVsYXRpdmUKICAgICAgICByZXR1cm4gJ2h0dHA6JyArIHVybDsKICAgICAgfSBlbHNlIHsgLy8gbm9uZQogICAgICAgIHJldHVybiAnaHR0cDovLycgKyB1cmw7CiAgICAgIH0KICAgIH0sCiAgICBmYWtlRnVja0FkQmxvY2sgOiBmdW5jdGlvbiAoaW5zdGFuY2VOYW1lLCBjbGFzc05hbWUpIHsKCiAgICAgIC8vIGluamVjdCBmYWtlIGZ1Y2thZGJsdWNrCiAgICAgIEFhay5hZGRTY3JpcHQoQWFrLmludG9TdHJpbmcoZnVuY3Rpb24gKCkgewoKICAgICAgICAgIHZhciBDTEFTU05BTUUgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIHZhciBzZWxmID0gdGhpczsKICAgICAgICAgICAgdmFyIGNhbGxOb3REZXRlY3RlZCA9IGZhbHNlOwogICAgICAgICAgICB0aGlzLmRlYnVnID0gewogICAgICAgICAgICAgIHNldCA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgIHJldHVybiBzZWxmOwogICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgZ2V0IDogZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfTsKICAgICAgICAgICAgdGhpcy5vbkRldGVjdGVkID0gZnVuY3Rpb24gKGNhbGxiYWNrKSB7CiAgICAgICAgICAgICAgdGhpcy5vbih0cnVlLCBjYWxsYmFjayk7CiAgICAgICAgICAgICAgcmV0dXJuIHRoaXM7CiAgICAgICAgICAgIH07CiAgICAgICAgICAgIHRoaXMub25Ob3REZXRlY3RlZCA9IGZ1bmN0aW9uIChjYWxsYmFjaykgewogICAgICAgICAgICAgIHRoaXMub24oZmFsc2UsIGNhbGxiYWNrKTsKICAgICAgICAgICAgICByZXR1cm4gdGhpczsKICAgICAgICAgICAgfTsKICAgICAgICAgICAgdGhpcy5vbiA9IGZ1bmN0aW9uIChkZXRlY3RlZCwgY2FsbGJhY2spIHsKICAgICAgICAgICAgICBpZiAoIWRldGVjdGVkKSB7CiAgICAgICAgICAgICAgICBjYWxsTm90RGV0ZWN0ZWQgPSBjYWxsYmFjazsKICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoY2FsbGJhY2ssIDEpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICBjb25zb2xlLmluZm8oWydBbnRpQWRiS2lsbGVyJywgbG9jYXRpb24uaG9zdCwgJ0Z1Y2tBZEJsb2NrJ10pOwogICAgICAgICAgICAgIHJldHVybiB0aGlzOwogICAgICAgICAgICB9OwogICAgICAgICAgICB0aGlzLnNldE9wdGlvbiA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICByZXR1cm4gdGhpczsKICAgICAgICAgICAgfTsKICAgICAgICAgICAgdGhpcy5vcHRpb25zID0gewogICAgICAgICAgICAgIHNldCA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgIHJldHVybiB0aGlzOwogICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgZ2V0IDogZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXM7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9OwogICAgICAgICAgICB0aGlzLmNoZWNrID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgIGlmIChjYWxsTm90RGV0ZWN0ZWQpCiAgICAgICAgICAgICAgICBjYWxsTm90RGV0ZWN0ZWQoKTsKICAgICAgICAgICAgfTsKICAgICAgICAgICAgdGhpcy5lbWl0RXZlbnQgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgcmV0dXJuIHRoaXM7CiAgICAgICAgICAgIH07CiAgICAgICAgICAgIHRoaXMuY2xlYXJFdmVudCA9IGZ1bmN0aW9uICgpIHt9OwogICAgICAgICAgfTsKCiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydGllcyh3aW5kb3csIHsKICAgICAgICAgICAgQ0xBU1NOQU1FIDogewogICAgICAgICAgICAgIHZhbHVlIDogQ0xBU1NOQU1FLAogICAgICAgICAgICAgIHdyaXRhYmxlIDogZmFsc2UKICAgICAgICAgICAgfQogICAgICAgICAgfSk7CgogICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnRpZXMod2luZG93LCB7CiAgICAgICAgICAgIElOU1RBTkNFTkFNRSA6IHsKICAgICAgICAgICAgICB2YWx1ZSA6IG5ldyBDTEFTU05BTUUoKSwKICAgICAgICAgICAgICB3cml0YWJsZSA6IGZhbHNlCiAgICAgICAgICAgIH0KICAgICAgICAgIH0pOwoKICAgICAgICB9KS5yZXBsYWNlKC9JTlNUQU5DRU5BTUUvZywgaW5zdGFuY2VOYW1lIHx8ICdmdWNrQWRCbG9jaycpCiAgICAgICAgLnJlcGxhY2UoL0NMQVNTTkFNRS9nLCBjbGFzc05hbWUgfHwgJ0Z1Y2tBZEJsb2NrJykpOwoKICAgIH0sIC8vIEV2ZW50cwogICAgb25FdmVudCA6IGZ1bmN0aW9uIChlbGVtZW50LCB0eXBlLCBsaXN0ZW5lciwgYnViYmxlcykgewogICAgICBpZiAod2luZG93LmFkZEV2ZW50TGlzdGVuZXIpIHsgLy8gRm9yIGFsbCBtYWpvciBicm93c2VycywgZXhjZXB0IElFIDggYW5kIGVhcmxpZXIKICAgICAgICAoZWxlbWVudCB8fCB3aW5kb3cpLmFkZEV2ZW50TGlzdGVuZXIodHlwZSwgbGlzdGVuZXIsIGJ1YmJsZXMgfHwgZmFsc2UpOwogICAgICB9IGVsc2UgeyAvLyBGb3IgSUUgOCBhbmQgZWFybGllciB2ZXJzaW9ucwogICAgICAgIChlbGVtZW50IHx8IHdpbmRvdykuYXR0YWNoRXZlbnQoJ29uJyArIHR5cGUsIGxpc3RlbmVyKTsKICAgICAgfQogICAgICByZXR1cm4gYXJndW1lbnRzOwogICAgfSwKICAgIG9mZkV2ZW50IDogZnVuY3Rpb24gKGVsZW1lbnQsIHR5cGUsIGxpc3RlbmVyLCBidWJibGVzKSB7CiAgICAgIGlmICh3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcikgeyAvLyBGb3IgYWxsIG1ham9yIGJyb3dzZXJzLCBleGNlcHQgSUUgOCBhbmQgZWFybGllcgogICAgICAgIChlbGVtZW50IHx8IHdpbmRvdykucmVtb3ZlRXZlbnRMaXN0ZW5lcih0eXBlLCBsaXN0ZW5lciwgYnViYmxlcyB8fCBmYWxzZSk7CiAgICAgIH0gZWxzZSB7IC8vIEZvciBJRSA4IGFuZCBlYXJsaWVyIHZlcnNpb25zCiAgICAgICAgKGVsZW1lbnQgfHwgd2luZG93KS5kZXRhY2hFdmVudCgnb24nICsgdHlwZSwgbGlzdGVuZXIpOwogICAgICB9CiAgICB9LAogICAgZW1pdEV2ZW50IDogZnVuY3Rpb24gKGVsZW1lbnQsIHR5cGUsIGRldGFpbCwgYnViYmxlcywgY2FuY2VsYWJsZSkgewogICAgICB2YXIgZXZlbnQ7CiAgICAgIGlmICh3aW5kb3cuQ3VzdG9tRXZlbnQpIHsKICAgICAgICBldmVudCA9IG5ldyB3aW5kb3cuQ3VzdG9tRXZlbnQodHlwZSwgewogICAgICAgICAgICAiZGV0YWlsIiA6IGRldGFpbCB8fCB1bmRlZmluZWQKICAgICAgICAgIH0sIGJ1YmJsZXMgfHwgZmFsc2UsIGNhbmNlbGFibGUgfHwgZmFsc2UpOwogICAgICB9IGVsc2UgewogICAgICAgIGV2ZW50ID0gZG9jdW1lbnQuY3JlYXRlRXZlbnQoJ0N1c3RvbUV2ZW50Jyk7CiAgICAgICAgZXZlbnQuaW5pdEN1c3RvbUV2ZW50KCdvbicgKyB0eXBlLCBidWJibGVzIHx8IGZhbHNlLCBjYW5jZWxhYmxlIHx8IGZhbHNlLCB7CiAgICAgICAgICAiZGV0YWlsIiA6IGRldGFpbCB8fCB1bmRlZmluZWQKICAgICAgICB9KTsKICAgICAgfQogICAgICAoZWxlbWVudCB8fCB3aW5kb3cpLmRpc3BhdGNoRXZlbnQoZXZlbnQpOwogICAgfSwKICAgIGRldGVjdGVkIDogZnVuY3Rpb24gKG5hbWUpIHsKICAgICAgaWYgKEFhay5vcHRzLmRlYnVnICYmIEFhay5vcHRzLmxvZ0RldGVjdGVkKSB7CiAgICAgICAgQWFrLmVtaXRFdmVudCh3aW5kb3csICdkZXRlY3RlZCcsIG5hbWUpOwogICAgICB9CiAgICB9LAogICAgcmVhZHkgOiBmdW5jdGlvbiAoY2FsbGJhY2spIHsKICAgICAgQWFrLm9uRXZlbnQod2luZG93LCAnbG9hZCcsIGNhbGxiYWNrKTsKICAgIH0sCiAgICBwbGF5ZXIgOiBmdW5jdGlvbiAoKSB7CgogICAgICB2YXIgUGxheWVyID0gZnVuY3Rpb24gKCkgewogICAgICAgIHRoaXMudGFyZ2V0ID0ge307CiAgICAgICAgdGhpcy5wbGF5ZXIgPSB7fTsKICAgICAgICB0aGlzLm5hbWUgPSBudWxsOwogICAgICAgIHRoaXMudmVyc2lvbiA9IG51bGw7CiAgICAgICAgdGhpcy5saWJyYXJ5ID0gbnVsbDsKICAgICAgICB0aGlzLmZhbGxiYWNrID0gJ3ZsYyc7CiAgICAgICAgdGhpcy5hdXRvcGxheSA9IEFhay5vcHRzLmF1dG9QbGF5OwogICAgICAgIHRoaXMuYXJncyA9IG51bGw7CiAgICAgICAgdGhpcy5zZXR1cCA9IHt9OwogICAgICAgIHRoaXMub3B0aW9ucyA9IHsKICAgICAgICAgIGJ1aWxkIDogJ2VtYmVkJywKICAgICAgICAgIGluc2VydCA6ICdyZXBsYWNlJywKICAgICAgICAgIGNyb3NzU2V0dXAgOiB0cnVlCiAgICAgICAgfTsKICAgICAgICB0aGlzLmF0dHJpYnV0ZXMgPSB7IC8vIGZsYXNoCiAgICAgICAgICB3bW9kZSA6ICdvcGFxdWUnLAogICAgICAgICAgcXVhbGl0eSA6ICdoaWdoJywKICAgICAgICAgIGJnY29sb3IgOiAnIzAwMDAwMCcsCiAgICAgICAgICB0eXBlIDogJ2FwcGxpY2F0aW9uL3gtc2hvY2t3YXZlLWZsYXNoJywKICAgICAgICAgIHBsdWdpbnNwYWdlIDogJ2h0dHA6Ly93d3cuYWRvYmUuY29tL2dvL2dldGZsYXNoJywKICAgICAgICAgIGFsbG93c2NyaXB0YWNjZXNzIDogJ2Fsd2F5cycsIC8vIG5ldmVyIC8gYWx3YXlzCiAgICAgICAgICBhbGxvd2Z1bGxzY3JlZW4gOiB0cnVlCiAgICAgICAgfTsKICAgICAgfTsKCiAgICAgIFBsYXllci5wcm90b3R5cGUgPSB7IC8vIGh0dHA6Ly90aW55dXJsLmNvbS9wYjZmdGhqCiAgICAgICAgZ2V0VGFyZ2V0Tm9kZSA6IGZ1bmN0aW9uIChlbGVtZW50KSB7CgogICAgICAgICAgdGhpcy50YXJnZXQubm9kZSA9IEFhay5nZXRFbGVtZW50KGVsZW1lbnQpOwogICAgICAgICAgdGhpcy50YXJnZXQuaHRtbCA9IHRoaXMudGFyZ2V0Lm5vZGUub3V0ZXJIVE1MOwogICAgICAgICAgdGhpcy50YXJnZXQucGFyZW50ID0gdGhpcy50YXJnZXQubm9kZS5wYXJlbnROb2RlOwogICAgICAgICAgdGhpcy50YXJnZXQudGFnID0gdGhpcy50YXJnZXQubm9kZS50YWdOYW1lOwoKICAgICAgICAgIHRoaXMuYXR0cmlidXRlcy5pZCA9IHRoaXMuYXR0cmlidXRlcy5uYW1lID0gQWFrLmdlbmVyYXRlSUQoKTsKICAgICAgICAgIHRoaXMuYXR0cmlidXRlcy5oZWlnaHQgPSB0aGlzLnRhcmdldC5ub2RlLmhlaWdodCB8fCB0aGlzLnRhcmdldC5ub2RlLmNsaWVudEhlaWdodCB8fCAnNDgwcHgnOwogICAgICAgICAgdGhpcy5hdHRyaWJ1dGVzLndpZHRoID0gdGhpcy50YXJnZXQubm9kZS53aWR0aCB8fCB0aGlzLnRhcmdldC5ub2RlLmNsaWVudFdpZHRoIHx8ICc2NDBweCc7CiAgICAgICAgfSwKICAgICAgICBnZXRNaW1lVHlwZSA6IGZ1bmN0aW9uICh0eXBlKSB7CiAgICAgICAgICAvLyBkb2M6IGh0dHA6Ly90aW55dXJsLmNvbS9qcnM4Zmd6CiAgICAgICAgICBzd2l0Y2ggKHR5cGUudG9Mb3dlckNhc2UoKSkgewogICAgICAgICAgY2FzZSAnbXA0JzoKICAgICAgICAgICAgcmV0dXJuICd2aWRlby9tcDQnOwogICAgICAgICAgY2FzZSAnd2VibSc6CiAgICAgICAgICAgIHJldHVybiAndmlkZW8vd2VibSc7CiAgICAgICAgICBjYXNlICdvZ2cnOgogICAgICAgICAgY2FzZSAnb2d2JzoKICAgICAgICAgICAgcmV0dXJuICd2aWRlby9vZ2cnOwogICAgICAgICAgY2FzZSAnZmx2JzoKICAgICAgICAgICAgcmV0dXJuICd2aWRlby94LWZsdic7CiAgICAgICAgICBjYXNlICdobHMnOgogICAgICAgICAgICByZXR1cm4gJ2FwcGxpY2F0aW9uL3gtbXBlZ1VSTCc7CiAgICAgICAgICBjYXNlICdoZHMnOgogICAgICAgICAgICByZXR1cm4gJ2FwcGxpY2F0aW9uL2Y0bSt4bWwnOwogICAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgcmV0dXJuIHR5cGU7CiAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgICBidWlsZGluZyA6IGZ1bmN0aW9uICh0YWdOYW1lKSB7CiAgICAgICAgICB2YXIgc2VsZiA9IHRoaXM7CgogICAgICAgICAgaWYgKEFhay5vcHRzLmZvcmNlVkxDICYmIHRoaXMubmFtZSAhPT0gJ3ZsYycpIHsKICAgICAgICAgICAgQWFrLmluZm8oJ2ZvcmNlIHBsYXlpbmcgd2l0aCBWTEMnKTsKICAgICAgICAgICAgcmV0dXJuIHRoaXMudmxjLmFwcGx5KHRoaXMsIHRoaXMuYXJncyk7CiAgICAgICAgICB9CgogICAgICAgICAgc3dpdGNoICh0YWdOYW1lKSB7CiAgICAgICAgICBjYXNlICdpZnJhbWUnOgogICAgICAgICAgICB0aGlzLnBsYXllci5ub2RlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaWZyYW1lJyk7CiAgICAgICAgICAgIHRoaXMucGxheWVyLm5vZGUuc2V0QXR0cmlidXRlKCdzcmMnLCB0aGlzLmF0dHJpYnV0ZXMuc3JjIHx8IGxvY2F0aW9uLnByb3RvY29sICsgJy8vJyArIGxvY2F0aW9uLmhvc3QgKyAnLycpOwogICAgICAgICAgICBpZiAodGhpcy5hdHRyaWJ1dGVzLnNyY2RvYykgewogICAgICAgICAgICAgIGlmICh0aGlzLnBsYXllci5ub2RlLmhhc0F0dHJpYnV0ZSgic3JjZG9jIikgfHwgJ3NyY2RvYycgaW4gdGhpcy5wbGF5ZXIubm9kZSkgewogICAgICAgICAgICAgICAgdGhpcy5wbGF5ZXIubm9kZS5zZXRBdHRyaWJ1dGUoJ3NyY2RvYycsIHRoaXMuYXR0cmlidXRlcy5zcmNkb2MpOwogICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAvLyBkb2VzIG5vdCB3b3JrIGNvcnJlY3RseSB3aXRoIGZsb3dwbGF5ZXIKICAgICAgICAgICAgICAgIHRoaXMucGxheWVyLm5vZGUuc2V0QXR0cmlidXRlKCdzcmMnLCAiZGF0YTp0ZXh0L2h0bWw7Y2hhcnNldD11dGYtOCwiICsgZW5jb2RlVVJJQ29tcG9uZW50KHRoaXMuYXR0cmlidXRlcy5zcmNkb2MpKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgdGhpcy5wbGF5ZXIubm9kZS5zZXRBdHRyaWJ1dGUoJ3dpZHRoJywgdGhpcy5zZXR1cC53aWR0aCk7CiAgICAgICAgICAgIHRoaXMucGxheWVyLm5vZGUuc2V0QXR0cmlidXRlKCdoZWlnaHQnLCB0aGlzLnNldHVwLmhlaWdodCk7CiAgICAgICAgICAgIHRoaXMucGxheWVyLm5vZGUuc2V0QXR0cmlidXRlKCdzdHlsZScsICdoZWlnaHQ6JyArIHRoaXMuc2V0dXAuaGVpZ2h0ICsgJ3B4OyB3aWR0aDonICsgdGhpcy5zZXR1cC53aWR0aCArICdweDsnKTsKICAgICAgICAgICAgdGhpcy5wbGF5ZXIubm9kZS5zZXRBdHRyaWJ1dGUoJ2ZyYW1lYm9yZGVyJywgMCk7CiAgICAgICAgICAgIHRoaXMucGxheWVyLm5vZGUuc2V0QXR0cmlidXRlKCdzY3JvbGxpbmcnLCAnbm8nKTsKICAgICAgICAgICAgdGhpcy5wbGF5ZXIubm9kZS5zZXRBdHRyaWJ1dGUoJ2FsbG93ZnVsbHNjcmVlbicsIHRydWUpOyAvLyBodHRwOi8vdGlueXVybC5jb20vb3l5ZWhhYgogICAgICAgICAgICAvLyBhbGxvd2Z1bGxzY3JlZW4gd2Via2l0YWxsb3dmdWxsc2NyZWVuIG1vemFsbG93ZnVsbHNjcmVlbiBvYWxsb3dmdWxsc2NyZWVuIG1zYWxsb3dmdWxsc2NyZWVuCiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgY2FzZSAndmlkZW8nOgogICAgICAgICAgICB2YXIgYXR0ck5hbWU7CiAgICAgICAgICAgIHRoaXMucGxheWVyLm5vZGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd2aWRlbycpOwogICAgICAgICAgICBmb3IgKGF0dHJOYW1lIGluIHRoaXMuYXR0cmlidXRlcykgewogICAgICAgICAgICAgIGlmICh0aGlzLmF0dHJpYnV0ZXMuaGFzT3duUHJvcGVydHkoYXR0ck5hbWUpKQogICAgICAgICAgICAgICAgdGhpcy5wbGF5ZXIubm9kZS5zZXRBdHRyaWJ1dGUoYXR0ck5hbWUsIHRoaXMuYXR0cmlidXRlc1thdHRyTmFtZV0pOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAodGhpcy5hdHRyaWJ1dGVzLmF1dG9wbGF5KSB7IC8vIGZpeCBidWcgZHVwbGljYXRlIHBsYXlpbmcgb24gZmlyZWZveC9jaHJvbWUKICAgICAgICAgICAgICB0aGlzLnBsYXllci5ub2RlLm9ubG9hZHN0YXJ0ID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgLy90aGlzLnBsYXkoKTsKICAgICAgICAgICAgICB9OwogICAgICAgICAgICB9CgogICAgICAgICAgICB0aGlzLnBsYXllci5ub2RlLm9uZXJyb3IgPSBmdW5jdGlvbiAoKSB7IC8vIHN3aXRjaCB0byBwbHVnaW4gcGxheWVyCiAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICBzZWxmLmFyZ3NbMF0gPSBzZWxmLnBsYXllci5ub2RlOwogICAgICAgICAgICAgICAgc2VsZi52bGNwbGF5ZXIuYXBwbHkoc2VsZiwgc2VsZi5hcmdzKTsKICAgICAgICAgICAgICB9LCA1MDAwKTsKICAgICAgICAgICAgfTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICBkZWZhdWx0OiAvLyBlbWJlZAogICAgICAgICAgICB0aGlzLnBsYXllci5ub2RlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZW1iZWQnKTsKICAgICAgICAgICAgZm9yIChhdHRyTmFtZSBpbiB0aGlzLmF0dHJpYnV0ZXMpIHsKICAgICAgICAgICAgICBpZiAodGhpcy5hdHRyaWJ1dGVzLmhhc093blByb3BlcnR5KGF0dHJOYW1lKSkKICAgICAgICAgICAgICAgIHRoaXMucGxheWVyLm5vZGUuc2V0QXR0cmlidXRlKGF0dHJOYW1lLCB0aGlzLmF0dHJpYnV0ZXNbYXR0ck5hbWVdKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgICAgdGhpcy5wbGF5ZXIuaHRtbCA9IHRoaXMucGxheWVyLm5vZGUub3V0ZXJIVE1MOwogICAgICAgICAgdGhpcy5wbGF5ZXIudGFnID0gdGhpcy5wbGF5ZXIubm9kZS50YWdOYW1lOwogICAgICAgICAgdGhpcy5pbnNlcnRpbmcoKTsKICAgICAgICB9LAogICAgICAgIGluc2VydGluZyA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHN3aXRjaCAodGhpcy5vcHRpb25zLmluc2VydCkgewogICAgICAgICAgY2FzZSAnaW5uZXInOgogICAgICAgICAgICB0aGlzLnRhcmdldC5ub2RlLmlubmVySFRNTCA9IHRoaXMucGxheWVyLmh0bWw7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgY2FzZSAnYXBwZW5kJzoKICAgICAgICAgICAgdGhpcy50YXJnZXQucGFyZW50LnJlcGxhY2VDaGlsZCh0aGlzLnBsYXllci5ub2RlKTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICBkZWZhdWx0OiAvLyByZXBsYWNlCiAgICAgICAgICAgIHRoaXMudGFyZ2V0LnBhcmVudC5yZXBsYWNlQ2hpbGQodGhpcy5wbGF5ZXIubm9kZSwgdGhpcy50YXJnZXQubm9kZSk7CiAgICAgICAgICB9CiAgICAgICAgICBpZiAoQWFrLm9wdHMubG9nUGxheWVyKSB7CiAgICAgICAgICAgIEFhay5sb2coJ3BsYXllcicsIHRoaXMpOwogICAgICAgICAgfQogICAgICAgICAgcmV0dXJuIHRoaXM7CiAgICAgICAgfSwKICAgICAgICBlZGl0aW5nIDogZnVuY3Rpb24gKGVsZW0sIG9wdHMpIHsgLy8gcmV2aWV3CiAgICAgICAgICBBYWsuaGFzRWxlbWVudChlbGVtLCBmdW5jdGlvbiAodGhpc0VsZW1lbnQpIHsKICAgICAgICAgICAgdmFyIG9iaiwKICAgICAgICAgICAgc3dmLAogICAgICAgICAgICB2YWx1ZSwKICAgICAgICAgICAgcGFydHMsCiAgICAgICAgICAgIHBhcmFtLAogICAgICAgICAgICBhdHRyaWJ1dGVzLAogICAgICAgICAgICBhdHRyTmFtZTsKICAgICAgICAgICAgdmFyIHNvID0gdGhpc0VsZW1lbnQ7CiAgICAgICAgICAgIHZhciBjbG9uZSA9IHNvLmNsb25lTm9kZSh0cnVlKTsKCiAgICAgICAgICAgIC8vIHNldCBhdHRyaWlidXRlcwogICAgICAgICAgICBpZiAob3B0cy5zZXRBdHRyaWJ1dGUpIHsKICAgICAgICAgICAgICBhdHRyaWJ1dGVzID0gb3B0cy5zZXRBdHRyaWJ1dGU7CiAgICAgICAgICAgICAgZm9yIChhdHRyTmFtZSBpbiBhdHRyaWJ1dGVzKSB7CiAgICAgICAgICAgICAgICBpZiAoY2xvbmUucXVlcnlTZWxlY3RvcigncGFyYW1bbmFtZT0iJyArIGF0dHJOYW1lICsgJyJdJykpIHsKICAgICAgICAgICAgICAgICAgY2xvbmUucXVlcnlTZWxlY3RvcigncGFyYW1bbmFtZT0iJyArIGF0dHJOYW1lICsgJyJdJykudmFsdWUgPSBhdHRyaWJ1dGVzW2F0dHJOYW1lXTsKICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoY2xvbmUuZ2V0QXR0cmlidXRlKGF0dHJOYW1lKSkgewogICAgICAgICAgICAgICAgICBjbG9uZS5zZXRBdHRyaWJ1dGUoYXR0ck5hbWUsIGF0dHJpYnV0ZXNbYXR0ck5hbWVdKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIC8vIHVuc2V0IGF0dHJpYnV0ZXMKICAgICAgICAgICAgaWYgKG9wdHMudW5zZXRBdHRyaWJ1dGVzKSB7CiAgICAgICAgICAgICAgYXR0cmlidXRlcyA9IG9wdHMuZGVsQXR0cmlidXRlczsKICAgICAgICAgICAgICBmb3IgKGF0dHJOYW1lIGluIGF0dHJpYnV0ZXMpIHsKICAgICAgICAgICAgICAgIGlmIChjbG9uZS5xdWVyeVNlbGVjdG9yKCdwYXJhbVtuYW1lPSInICsgYXR0ck5hbWUgKyAnIl0nKSkgewogICAgICAgICAgICAgICAgICBBYWsucmVtb3ZlRWxlbWVudChjbG9uZS5xdWVyeVNlbGVjdG9yKCdwYXJhbVtuYW1lPSInICsgYXR0ck5hbWUgKyAnIl0nKSk7CiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGNsb25lLmdldEF0dHJpYnV0ZShhdHRyTmFtZSkpIHsKICAgICAgICAgICAgICAgICAgZGVsZXRlIGF0dHJpYnV0ZXNbYXR0ck5hbWVdOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKG9wdHMuc2V0Rmxhc2h2YXJzIHx8IG9wdHMudW5zZXRGbGFzaHZhcnMpIHsKICAgICAgICAgICAgICBpZiAoY2xvbmUucXVlcnlTZWxlY3RvcigncGFyYW1bbmFtZT0iZmxhc2h2YXJzIl0nKSkgewogICAgICAgICAgICAgICAgcGFyYW0gPSBjbG9uZS5xdWVyeVNlbGVjdG9yKCdwYXJhbVtuYW1lPSJmbGFzaHZhcnMiXScpOwogICAgICAgICAgICAgICAgdmFsdWUgPSBwYXJhbS52YWx1ZTsKICAgICAgICAgICAgICB9IGVsc2UgaWYgKGNsb25lLmdldEF0dHJpYnV0ZSgnZmxhc2h2YXJzJykpIHsKICAgICAgICAgICAgICAgIHZhbHVlID0gY2xvbmUuZ2V0QXR0cmlidXRlKCdmbGFzaHZhcnMnKTsKICAgICAgICAgICAgICB9IGVsc2UgaWYgKGNsb25lLmdldEF0dHJpYnV0ZSgnZGF0YScpICYmIGNsb25lLmdldEF0dHJpYnV0ZSgnZGF0YScpLmluZGV4T2YoJz8nKSA+PSAwKSB7CiAgICAgICAgICAgICAgICBwYXJ0cyA9IGNsb25lLmdldEF0dHJpYnV0ZSgnZGF0YScpLnNwbGl0KCc/JywgMik7CiAgICAgICAgICAgICAgICBzd2YgPSBwYXJ0cy5zaGlmdCgpOwogICAgICAgICAgICAgICAgdmFsdWUgPSBwYXJ0cy5zaGlmdCgpOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgb2JqID0gQWFrLnVuc2VyaWFsaXplKHZhbHVlKTsKICAgICAgICAgICAgICBpZiAob3B0cy5zZXRGbGFzaHZhcnMpIHsKICAgICAgICAgICAgICAgIG9iaiA9IEFhay5zZXRQcm9wZXJ0aWVzKG9iaiwgb3B0cy5zZXRGbGFzaHZhcnMpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICBpZiAob3B0cy51bnNldEZsYXNodmFycykgewogICAgICAgICAgICAgICAgb2JqID0gQWFrLnVuc2V0UHJvcGVydGllcyhvYmosIG9wdHMudW5zZXRGbGFzaHZhcnMpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB2YWx1ZSA9IEFhay5zZXJpYWxpemUob2JqKTsKCiAgICAgICAgICAgICAgaWYgKHBhcmFtKSB7CiAgICAgICAgICAgICAgICBwYXJhbS52YWx1ZSA9IHZhbHVlOwogICAgICAgICAgICAgIH0gZWxzZSBpZiAoc3dmKSB7CiAgICAgICAgICAgICAgICBjbG9uZS5zZXRBdHRyaWJ1dGUoJ2RhdGEnLCBzd2YgKyAnPycgKyB2YWx1ZSk7CiAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIGNsb25lLnNldEF0dHJpYnV0ZSgnZmxhc2h2YXJzJywgdmFsdWUpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICAvLyByZXBsYWNlCiAgICAgICAgICAgIEFhay5sb2coc28sIGNsb25lLCBvYmopOwogICAgICAgICAgICBBYWsucmVwbGFjZUVsZW1lbnQoc28sIGNsb25lKTsKICAgICAgICAgIH0pOwogICAgICAgIH0sCiAgICAgICAgZW1iZWRkaW5nIDogZnVuY3Rpb24gKGlkLCBzZXR1cCwgYXR0cmlidXRlcywgb3B0aW9ucykgeyAKICAgICAgICAKICAgICAgICAgIHRoaXMuZ2V0VGFyZ2V0Tm9kZShpZCk7CiAgICAgICAgICB0aGlzLmFyZ3MgPSBhcmd1bWVudHM7CiAgICAgICAgICB0aGlzLmF0dHJpYnV0ZXMgPSBBYWsuc2V0UHJvcGVydGllcyh0aGlzLmF0dHJpYnV0ZXMsIGF0dHJpYnV0ZXMgfHwge30pOwogICAgICAgICAgdGhpcy5vcHRpb25zID0gQWFrLnNldFByb3BlcnRpZXModGhpcy5vcHRpb25zLCBvcHRpb25zIHx8IHt9KTsKCiAgICAgICAgICB0aGlzLmF0dHJpYnV0ZXMuc3JjID0gc2V0dXAuc3dmOwogICAgICAgICAgdGhpcy5hdHRyaWJ1dGVzLmlkID0gdGhpcy5hdHRyaWJ1dGVzLm5hbWUgPSBBYWsuZ2VuZXJhdGVJRCgpOwogICAgICAgICAgdGhpcy5hdHRyaWJ1dGVzLmhlaWdodCA9IHNldHVwLmhlaWdodCB8fCB0aGlzLmF0dHJpYnV0ZXMuaGVpZ2h0OwogICAgICAgICAgdGhpcy5hdHRyaWJ1dGVzLndpZHRoID0gc2V0dXAud2lkdGggfHwgdGhpcy5hdHRyaWJ1dGVzLndpZHRoOwogICAgICAgICAgdGhpcy5hdHRyaWJ1dGVzLmZsYXNodmFycyA9IEFhay5zZXJpYWxpemUoc2V0dXApOwogICAgICAgICAgdGhpcy5hdHRyaWJ1dGVzID0gQWFrLnVuc2V0UHJvcGVydGllcyh0aGlzLmF0dHJpYnV0ZXMsICdzd2YnKTsKCiAgICAgICAgICB0aGlzLmJ1aWxkaW5nKCdlbWJlZCcpOwogICAgICAgIH0sCiAgICAgICAgandwbGF5ZXIgOiBmdW5jdGlvbiAoaWQsIHNldHVwLCBhdHRyaWJ1dGVzLCBvcHRpb25zKSB7CiAgICAgICAgICAvLyBKd1BsYXllciA3IChmbGFzaC9odG1sNSkKICAgICAgICAgIC8vIG5vdGU6IHByb2JsZW0gd2l0aCBzc2wKICAgICAgICAgIC8vIHNldHVwOiBodHRwOi8vdGlueXVybC5jb20vaGhyZ2phcCwgaHR0cDovL3Rpbnl1cmwuY29tL2dxczQ2dG0KICAgICAgICAgIC8vIGFwaTogaHR0cHM6Ly9kZXZlbG9wZXIuandwbGF5ZXIuY29tL2p3LXBsYXllci9kb2NzL2RldmVsb3Blci1ndWlkZS9hcGkvamF2YXNjcmlwdF9hcGlfcmVmZXJlbmNlLwogICAgICAgICAgLy8gaGxzOiBodHRwOi8vdGlueXVybC5jb20vcHhsOXNjcQogICAgICAgICAgLy8gaGxzLXRlc3RlcjogaHR0cDovL2RlbW8uandwbGF5ZXIuY29tL3N0cmVhbS10ZXN0ZXIvCiAgICAgICAgICAvLyBydG1wLWRlbW86IGh0dHBzOi8vd3d3LnNjYWxlZW5naW5lLmNvbS9qdzYKICAgICAgICAgIC8vIGlmcmFtZTogaHR0cDovL3Rpbnl1cmwuY29tLzg2YWdnNjgKCiAgICAgICAgICB0aGlzLmdldFRhcmdldE5vZGUoaWQpOwogICAgICAgICAgdGhpcy5hcmdzID0gYXJndW1lbnRzOwogICAgICAgICAgdGhpcy5hdHRyaWJ1dGVzID0gQWFrLnNldFByb3BlcnRpZXModGhpcy5hdHRyaWJ1dGVzLCBhdHRyaWJ1dGVzIHx8IHt9KTsKICAgICAgICAgIHRoaXMub3B0aW9ucyA9IEFhay5zZXRQcm9wZXJ0aWVzKHRoaXMub3B0aW9ucywgb3B0aW9ucyB8fCB7fSk7CgogICAgICAgICAgdGhpcy5zZXR1cCA9IHNldHVwOwogICAgICAgICAgaWYgKHRoaXMub3B0aW9ucy5jcm9zc1NldHVwID09PSB0cnVlKSB7CiAgICAgICAgICAgIHRoaXMuc2V0dXAgPSB7CiAgICAgICAgICAgICAgY29udHJvbHMgOiB0cnVlLAogICAgICAgICAgICAgIGZpbGUgOiBzZXR1cC5zb3VyY2UsCiAgICAgICAgICAgICAgYWJvdXR0ZXh0IDogQWFrLm5hbWUsCiAgICAgICAgICAgICAgYWJvdXRsaW5rIDogQWFrLmhvbWVVUkwsCiAgICAgICAgICAgICAgd2lkdGggOiBzZXR1cC53aWR0aCB8fCB0aGlzLmF0dHJpYnV0ZXMud2lkdGgsCiAgICAgICAgICAgICAgaGVpZ2h0IDogc2V0dXAuaGVpZ2h0IHx8IHRoaXMuYXR0cmlidXRlcy5oZWlnaHQsCiAgICAgICAgICAgICAgYXV0b3N0YXJ0IDogc2V0dXAuYXV0b3BsYXkgfHwgdGhpcy5hdXRvcGxheSwKICAgICAgICAgICAgICBwcmltYXJ5IDogJ2h0bWw1JywKICAgICAgICAgICAgICBwcmVsb2FkIDogJ2F1dG8nLAogICAgICAgICAgICAgIHNraW4gOiB7IC8vIFNldmVuIHwgU2l4IHwgRml2ZSB8IEdsb3cgfCBCZWVsZGVuIHwgVmFwb3IgfCBCZWtsZSB8IFJvdW5kc3RlciB8IFN0b3JtdHJvb3BlcgogICAgICAgICAgICAgICAgbmFtZSA6IHNldHVwLnNraW4gfHwgInNpeCIgLy8gZGVmYXVsdCBza2luIEpXUDYKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH07CiAgICAgICAgICAgIGlmIChbJ21wNCcsICd3ZWJtJywgJ29nZycsICdvZ3YnXS5pbmRleE9mKHNldHVwLnR5cGUpID09PSAtMSkgewogICAgICAgICAgICAgIHRoaXMuc2V0dXAucHJpbWFyeSA9ICdmbGFzaCc7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKHNldHVwLnR5cGUgPT09ICdobHMnKSB7CiAgICAgICAgICAgICAgdGhpcy5zZXR1cC5obHNodG1sID0gdHJ1ZTsKICAgICAgICAgICAgfQogICAgICAgICAgfQoKICAgICAgICAgIHRoaXMuYXR0cmlidXRlcy5zcmNkb2MgPSAnPGh0bWw+PGhlYWQ+PHN0eWxlIHR5cGU9InRleHQvY3NzIj5AZm9udC1mYWNle2ZvbnQtZmFtaWx5Omp3LWljb25zO3NyYzp1cmwoJyArIGxvY2F0aW9uLnByb3RvY29sICsgJ3NzbC5wLmp3cGNkbi5jb20vcGxheWVyL3YvNy40LjMvanctaWNvbnMud29mZikgZm9ybWF0KCJ3b2ZmIiksdXJsKCcgKyBsb2NhdGlvbi5wcm90b2NvbCArICcvL3NzbC5wLmp3cGNkbi5jb20vcGxheWVyL3YvNy40LjMvanctaWNvbnMudHRmKSBmb3JtYXQoInRydWV0eXBlIik7Zm9udC13ZWlnaHQ6NDAwO2ZvbnQtc3R5bGU6bm9ybWFsfTwvc3R5bGU+PHNjcmlwdCBzcmM9IicgKyBsb2NhdGlvbi5wcm90b2NvbCArICcvL2NvbnRlbnQuandwbGF0Zm9ybS5jb20vbGlicmFyaWVzL1Y2TmZFelQ3LmpzIj48L3NjcmlwdD48c3R5bGUgdHlwZT0idGV4dC9jc3MiPmh0bWwsIGJvZHl7cGFkZGluZzowOyBtYXJnaW46MDt9PC9zdHlsZT48L2hlYWQ+PGJvZHk+PGRpdiBpZD0ianctbW92aWUiPjwvZGl2PjxzY3JpcHQ+andwbGF5ZXIoImp3LW1vdmllIikuc2V0dXAoJyArIEpTT04uc3RyaW5naWZ5KHRoaXMuc2V0dXApICsgJyk7PC9zY3JpcHQ+PC9ib2R5PjwvaHRtbD4nOwoKICAgICAgICAgIHRoaXMuYnVpbGRpbmcoJ2lmcmFtZScpOwogICAgICAgIH0sCiAgICAgICAgdmlkZW9qcyA6IGZ1bmN0aW9uIChpZCwgc2V0dXAsIGF0dHJpYnV0ZXMsIG9wdGlvbnMpIHsgCiAgICAgICAgICAvLyBWaWRlb0pzIDUgKGZsYXNoL2h0bWw1KQogICAgICAgICAgLy8gc2V0dXA6IGh0dHA6Ly90aW55dXJsLmNvbS9wY2d4Mm9iCiAgICAgICAgICAvLyBwbGF5YmFjazogaHR0cDovL3Rpbnl1cmwuY29tL25zY3p0bW0KICAgICAgICAgIC8vIGRlbW86IGh0dHA6Ly9qc2ZpZGRsZS5uZXQvTjhaczUvMTgvCiAgICAgICAgICAvLyBwbHVnaW5zOiBodHRwczovL2dpdGh1Yi5jb20vdmlkZW9qcy92aWRlby5qcy93aWtpL1BsdWdpbnMKCiAgICAgICAgICB0aGlzLmdldFRhcmdldE5vZGUoaWQpOwogICAgICAgICAgdGhpcy5hcmdzID0gYXJndW1lbnRzOwogICAgICAgICAgdGhpcy5hdHRyaWJ1dGVzID0gQWFrLnNldFByb3BlcnRpZXModGhpcy5hdHRyaWJ1dGVzLCBhdHRyaWJ1dGVzIHx8IHt9KTsKICAgICAgICAgIHRoaXMub3B0aW9ucyA9IEFhay5zZXRQcm9wZXJ0aWVzKHRoaXMub3B0aW9ucywgb3B0aW9ucyB8fCB7fSk7CgogICAgICAgICAgdGhpcy5zZXR1cCA9IHNldHVwOwogICAgICAgICAgaWYgKHRoaXMub3B0aW9ucy5jcm9zc1NldHVwID09PSB0cnVlKSB7CiAgICAgICAgICAgIHRoaXMuc2V0dXAgPSB7CiAgICAgICAgICAgICAgY29udHJvbHMgOiB0cnVlLAogICAgICAgICAgICAgIHByZWxvYWQgOiAnYXV0bycsCiAgICAgICAgICAgICAgd2lkdGggOiBzZXR1cC53aWR0aCB8fCB0aGlzLmF0dHJpYnV0ZXMud2lkdGgsCiAgICAgICAgICAgICAgaGVpZ2h0IDogc2V0dXAuaGVpZ2h0IHx8IHRoaXMuYXR0cmlidXRlcy5oZWlnaHQsCiAgICAgICAgICAgICAgdGVjaE9yZGVyIDogWyJodG1sNSIsICJmbGFzaCJdLAogICAgICAgICAgICAgIGF1dG9wbGF5IDogc2V0dXAuYXV0b3BsYXkgfHwgdGhpcy5hdXRvcGxheSwKICAgICAgICAgICAgICBzb3VyY2VzIDogW3sKICAgICAgICAgICAgICAgICAgdHlwZSA6IHRoaXMuZ2V0TWltZVR5cGUoc2V0dXAudHlwZSksCiAgICAgICAgICAgICAgICAgIHNyYyA6IHNldHVwLnNvdXJjZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIF0KICAgICAgICAgICAgfTsKICAgICAgICAgICAgLyogZG9uJ3Qgd29yayAKICAgICAgICAgICAgaWYgKHNldHVwLnR5cGUgPT09ICdobHMnKSB7CiAgICAgICAgICAgICAgdGVjaE9yZGVyIDogWyJmbGFzaCIsICJodG1sNSJdLAogICAgICAgICAgICAgIHRoaXMuc2V0dXAuZmxhc2ggPSB7CiAgICAgICAgICAgICAgICAvL3N3ZiA6ICIvL3JlZWtzaXRlLmNvbS9wdWJsaWMvc3dmL3ZpZGVvanMtZmxhc2hscy5zd2YiCiAgICAgICAgICAgICAgICBzd2YgOiAnaHR0cDovL3d3dy5mbGFzaGxzLm9yZy92aWRlb2pzL3ZpZGVvLWpzLnN3ZicKICAgICAgICAgICAgICB9OwogICAgICAgICAgICB9CiAgICAgICAgICAgICovCiAgICAgICAgICB9CgogICAgICAgICAgLy8gCiAgICAgICAgICB0aGlzLmF0dHJpYnV0ZXMuc3JjZG9jID0gJzxodG1sPjxoZWFkPjxsaW5rIGhyZWY9IicgKyBsb2NhdGlvbi5wcm90b2NvbCArICcvL2NkbmpzLmNsb3VkZmxhcmUuY29tL2FqYXgvbGlicy92aWRlby5qcy81LjEwLjUvYWx0L3ZpZGVvLWpzLWNkbi5taW4uY3NzIiByZWw9InN0eWxlc2hlZXQiPjxzY3JpcHQgc3JjPSInICsgbG9jYXRpb24ucHJvdG9jb2wgKyAnLy9jZG5qcy5jbG91ZGZsYXJlLmNvbS9hamF4L2xpYnMvdmlkZW8uanMvNS4xMC41L3ZpZGVvLm1pbi5qcyI+PC9zY3JpcHQ+PHNjcmlwdCBzcmM9IicgKyBsb2NhdGlvbi5wcm90b2NvbCArICcvL2NkbmpzLmNsb3VkZmxhcmUuY29tL2FqYXgvbGlicy92aWRlb2pzLWNvbnRyaWItaGxzLzMuMS4wL3ZpZGVvanMtY29udHJpYi1obHMubWluLmpzIj48L3NjcmlwdD48c3R5bGUgdHlwZT0idGV4dC9jc3MiPmh0bWwsIGJvZHl7cGFkZGluZzowOyBtYXJnaW46MDt9LnZqcy1kZWZhdWx0LXNraW57Y29sb3I6I2VlZX0udmpzLWRlZmF1bHQtc2tpbiAudmpzLXBsYXktcHJvZ3Jlc3MsLnZqcy1kZWZhdWx0LXNraW4gLnZqcy12b2x1bWUtbGV2ZWx7YmFja2dyb3VuZC1jb2xvcjojZWVlfS52anMtZGVmYXVsdC1za2luIC52anMtYmlnLXBsYXktYnV0dG9uLC52anMtZGVmYXVsdC1za2luIC52anMtY29udHJvbC1iYXJ7YmFja2dyb3VuZDpyZ2JhKDAsMCwwLC4yKX0udmpzLWRlZmF1bHQtc2tpbiAudmpzLXNsaWRlcntiYWNrZ3JvdW5kOnJnYmEoMCwwLDAsLjMpfTwvc3R5bGU+PC9oZWFkPjxib2R5Pjx2aWRlbyBpZD0idmpzLW1vdmllIiBjbGFzcz0idmlkZW8tanMgdmpzLWRlZmF1bHQtc2tpbiB2anMtYmlnLXBsYXktY2VudGVyZWQiPjwvdmlkZW8+PHNjcmlwdD52aWRlb2pzKCJ2anMtbW92aWUiLCAnICsgSlNPTi5zdHJpbmdpZnkodGhpcy5zZXR1cCkgKyAnKTwvc2NyaXB0PjwvYm9keT48L2h0bWw+JzsKCiAgICAgICAgICB0aGlzLmJ1aWxkaW5nKCdpZnJhbWUnKTsKICAgICAgICB9LAogICAgICAgIGZsb3dwbGF5ZXIgOiBmdW5jdGlvbiAoaWQsIHNldHVwLCBhdHRyaWJ1dGVzLCBvcHRpb25zKSB7CiAgICAgICAgICAvLyBGbG93UGxheWVyIDYgKGZsYXNoKQogICAgICAgICAgLy8gbm90ZTogcHJvYmxlbSB3aXRoIGZsYXNocGxheWVyCiAgICAgICAgICAvLyBzdXBwb3J0OiBtcDQsIGZsdiwgZjR2LCBtNHYsIG1vdgogICAgICAgICAgLy8gc2V0dXA6IGh0dHBzOi8vZmxvd3BsYXllci5vcmcvZG9jcy9zZXR1cC5odG1sCiAgICAgICAgICAvLyBhcGk6IGh0dHBzOi8vZmxvd3BsYXllci5vcmcvZG9jcy9hcGkuaHRtbAogICAgICAgICAgLy8gZGVtbzogaHR0cDovL2RlbW9zLmZsb3dwbGF5ZXIub3JnL2Jhc2ljcy9qcy1zZXR1cC1hdXRvcGxheS5odG1sCiAgICAgICAgICAvLyBoZHM6IGh0dHBzOi8vZmxvd3BsYXllci5lbGVjdHJvdGVxdWUub3JnL2h0dHBzdHJlYW1pbmctaGRzL2ZwNgogICAgICAgICAgLy8gaGxzOiBodHRwOi8vZGVtb3MuZmxvd3BsYXllci5vcmcvYXBpL2hsc2pzLmh0bWwKICAgICAgICAgIC8vIGZsdjogaHR0cDovL2RlbW9zLmZsb3dwbGF5ZXIub3JnL2Jhc2ljcy9mbHYuaHRtbAoKICAgICAgICAgIHRoaXMuZ2V0VGFyZ2V0Tm9kZShpZCk7CiAgICAgICAgICB0aGlzLmFyZ3MgPSBhcmd1bWVudHM7CiAgICAgICAgICB0aGlzLmF0dHJpYnV0ZXMgPSBBYWsuc2V0UHJvcGVydGllcyh0aGlzLmF0dHJpYnV0ZXMsIGF0dHJpYnV0ZXMgfHwge30pOwogICAgICAgICAgdGhpcy5vcHRpb25zID0gQWFrLnNldFByb3BlcnRpZXModGhpcy5vcHRpb25zLCBvcHRpb25zIHx8IHt9KTsKCiAgICAgICAgICB0aGlzLnNldHVwID0gc2V0dXA7CiAgICAgICAgICBpZiAodGhpcy5vcHRpb25zLmNyb3NzU2V0dXAgPT09IHRydWUpIHsKICAgICAgICAgICAgdGhpcy5zZXR1cCA9IHsKICAgICAgICAgICAgICB3aWR0aCA6IHNldHVwLndpZHRoIHx8IHRoaXMuYXR0cmlidXRlcy53aWR0aCwKICAgICAgICAgICAgICBoZWlnaHQgOiBzZXR1cC5oZWlnaHQgfHwgdGhpcy5hdHRyaWJ1dGVzLmhlaWdodCwKICAgICAgICAgICAgICBhdXRvcGxheSA6IHNldHVwLmF1dG9wbGF5IHx8IHRoaXMuYXV0b3BsYXksCiAgICAgICAgICAgICAgcHJlbG9hZCA6ICdhdXRvJwogICAgICAgICAgICB9OwogICAgICAgICAgICBpZiAoc2V0dXAudHlwZSA9PT0gJ2hscycpIHsKICAgICAgICAgICAgICB0aGlzLnNldHVwLnN3ZiA9IGxvY2F0aW9uLnByb3RvY29sICsgJy8vcmVsZWFzZXMuZmxvd3BsYXllci5vcmcvNi4wLjUvZmxvd3BsYXllcmhscy5zd2YnOwogICAgICAgICAgICAgIHRoaXMuc2V0dXAuZW5naW5lID0gJ2hsc2pzJzsKICAgICAgICAgICAgfSBlbHNlIGlmIChbJ21wNCcsICd3ZWJtJywgJ29nZycsICdvZ3YnXS5pbmRleE9mKHNldHVwLnR5cGUpID09PSAtMSkgewogICAgICAgICAgICAgIHRoaXMuc2V0dXAuc3dmID0gbG9jYXRpb24ucHJvdG9jb2wgKyAnLy9yZWxlYXNlcy5mbG93cGxheWVyLm9yZy82LjAuNS9mbG93cGxheWVyLnN3Zic7CiAgICAgICAgICAgICAgdGhpcy5zZXR1cC5lbmdpbmUgPSAnZmxhc2gnOwogICAgICAgICAgICAgIHRoaXMuc2V0dXAudHlwZSA9ICd2aWRlby9mbGFzaCc7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgdGhpcy5zZXR1cC5jbGlwID0gewogICAgICAgICAgICAgIHNvdXJjZXMgOiBbewogICAgICAgICAgICAgICAgICB0eXBlIDogdGhpcy5nZXRNaW1lVHlwZSh0aGlzLnNldHVwLnR5cGUgfHwgc2V0dXAudHlwZSksCiAgICAgICAgICAgICAgICAgIHNyYyA6IHNldHVwLnNvdXJjZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIF0KICAgICAgICAgICAgfTsKICAgICAgICAgIH0KCiAgICAgICAgICB0aGlzLmF0dHJpYnV0ZXMuc3JjZG9jID0gJzxodG1sPjxoZWFkPjxsaW5rIHJlbD0ic3R5bGVzaGVldCIgaHJlZj0iJyArIGxvY2F0aW9uLnByb3RvY29sICsgJy8vcmVsZWFzZXMuZmxvd3BsYXllci5vcmcvNi4wLjUvc2tpbi9mdW5jdGlvbmFsLmNzcyI+PC9zY3JpcHQ+PHNjcmlwdCBzcmM9IicgKyBsb2NhdGlvbi5wcm90b2NvbCArICcvL2NvZGUuanF1ZXJ5LmNvbS9qcXVlcnktMS4xMS4yLm1pbi5qcyI+PC9zY3JpcHQ+PHNjcmlwdCBzcmM9IicgKyBsb2NhdGlvbi5wcm90b2NvbCArICcvL3JlbGVhc2VzLmZsb3dwbGF5ZXIub3JnLzYuMC41L2Zsb3dwbGF5ZXIubWluLmpzIj48L3NjcmlwdD48c3R5bGUgdHlwZT0idGV4dC9jc3MiPmh0bWwsIGJvZHl7cGFkZGluZzowOyBtYXJnaW46MDt9PC9zdHlsZT48L2hlYWQ+PGJvZHk+PGRpdiBpZD0iZnAtbW92aWUiPjwvZGl2PjxzY3JpcHQ+Zmxvd3BsYXllcigiI2ZwLW1vdmllIiwgJyArIEpTT04uc3RyaW5naWZ5KHRoaXMuc2V0dXApICsgJyk7PC9zY3JpcHQ+PC9ib2R5PjwvaHRtbD4nOwoKICAgICAgICAgIHRoaXMuYnVpbGRpbmcoJ2lmcmFtZScpOwogICAgICAgIH0sCiAgICAgICAgZ3JpbmRwbGF5ZXIgOiBmdW5jdGlvbiAoaWQsIHNldHVwLCBhdHRyaWJ1dGVzLCBvcHRpb25zKSB7CiAgICAgICAgICAvLyBHcmluZFBsYXllciAxIChmbGFzaCkKICAgICAgICAgIC8vIHNldHVwOiBodHRwOi8vb3NtZmhscy5rdXR1LnJ1L2RvY3MvZ3JpbmQvCiAgICAgICAgICAvLyBzdXBwb3J0OiBobHMsIHJ0bXAKCiAgICAgICAgICB0aGlzLmdldFRhcmdldE5vZGUoaWQpOwogICAgICAgICAgdGhpcy5hcmdzID0gYXJndW1lbnRzOwogICAgICAgICAgdGhpcy5hdHRyaWJ1dGVzID0gQWFrLnNldFByb3BlcnRpZXModGhpcy5hdHRyaWJ1dGVzLCBhdHRyaWJ1dGVzIHx8IHt9KTsKICAgICAgICAgIHRoaXMub3B0aW9ucyA9IEFhay5zZXRQcm9wZXJ0aWVzKHRoaXMub3B0aW9ucywgb3B0aW9ucyB8fCB7fSk7CgogICAgICAgICAgdGhpcy5zZXR1cCA9IHNldHVwOwogICAgICAgICAgaWYgKHRoaXMub3B0aW9ucy5jcm9zc1NldHVwID09PSB0cnVlKSB7CiAgICAgICAgICAgIHRoaXMuc2V0dXAgPSB7CiAgICAgICAgICAgICAgc3JjIDogc2V0dXAuc291cmNlLAogICAgICAgICAgICAgIHN0cmVhbVR5cGUgOiAibGl2ZSIsCiAgICAgICAgICAgICAgc2NhbGVNb2RlIDogImxldHRlcmJveCIsCiAgICAgICAgICAgICAgYXV0b1BsYXkgOiBzZXR1cC5hdXRvcGxheSB8fCB0aGlzLmF1dG9wbGF5CiAgICAgICAgICAgIH07CiAgICAgICAgICAgIGlmIChzZXR1cC50eXBlID09PSAnaGxzJykgewogICAgICAgICAgICAgIHRoaXMuc2V0dXAucGx1Z2luX2hscyA9ICIvL3JlZWtzaXRlLmNvbS9wdWJsaWMvc3dmL2ZsYXNobHNPU01GLnN3ZiI7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKHNldHVwLnByb3h5ID09PSB0cnVlKSB7CiAgICAgICAgICAgICAgdGhpcy5zZXR1cC5zcmMgPSAnLy93d3cuZGlhbnNoaWJvLmNvbS9mZXRjaC5waHAvJyArIHNldHVwLnNvdXJjZS5zdWJzdHJpbmcoc2V0dXAuc291cmNlLmluZGV4T2YoJy8vJykgKyAyKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQoKICAgICAgICAgIHRoaXMuYXR0cmlidXRlcy5zcmMgPSBzZXR1cC5zd2YgfHwgdGhpcy5hdHRyaWJ1dGVzLnNyYyB8fCAiLy9yZWVrc2l0ZS5jb20vcHVibGljL3N3Zi9HcmluZFBsYXllci5zd2YiOwogICAgICAgICAgdGhpcy5hdHRyaWJ1dGVzLmhlaWdodCA9IHNldHVwLmhlaWdodCB8fCB0aGlzLmF0dHJpYnV0ZXMuaGVpZ2h0OwogICAgICAgICAgdGhpcy5hdHRyaWJ1dGVzLndpZHRoID0gc2V0dXAud2lkdGggfHwgdGhpcy5hdHRyaWJ1dGVzLndpZHRoOwogICAgICAgICAgdGhpcy5hdHRyaWJ1dGVzLmZsYXNodmFycyA9IEFhay5zZXJpYWxpemUodGhpcy5zZXR1cCk7CgogICAgICAgICAgdGhpcy5idWlsZGluZygnZW1iZWQnKTsKICAgICAgICB9LAogICAgICAgIHZsYyA6IGZ1bmN0aW9uIChpZCwgc2V0dXAsIGF0dHJpYnV0ZXMsIG9wdGlvbnMpIHsKICAgICAgICAgIC8vIFZMQyBXZWIgUGx1Z2luIChwbHVnaW4pCiAgICAgICAgICAvLyBkb2M6IGh0dHA6Ly90aW55dXJsLmNvbS9vbWx6cDM5CiAgICAgICAgICAvLyBwbHVnaW5zOiBhYm91dDpwbHVnaW5zCiAgICAgICAgICAvLyBjaHJvbWU6Ly9mbGFncy8jZW5hYmxlLW5wYXBpCiAgICAgICAgICAvLyBodHRwczovL3d3dy5jaHJvbWl1bS5vcmcvZGV2ZWxvcGVycy9ucGFwaS1kZXByZWNhdGlvbgogICAgICAgICAgLy8gSW4gU2VwdGVtYmVyIDIwMTUgKENocm9tZSA0NSkgd2Ugd2lsbCByZW1vdmUgdGhlIG92ZXJyaWRlIGFuZCBOUEFQSSBzdXBwb3J0IHdpbGwgYmUgcGVybWFuZW50bHkgcmVtb3ZlZCBmcm9tIENocm9tZS4gSW5zdGFsbGVkIGV4dGVuc2lvbnMgdGhhdCByZXF1aXJlIE5QQVBJIHBsdWdpbnMgd2lsbCBubyBsb25nZXIgYmUgYWJsZSB0byBsb2FkIHRob3NlIHBsdWdpbnMuCgogICAgICAgICAgdGhpcy5uYW1lID0gJ3ZsYyc7CiAgICAgICAgICB0aGlzLmdldFRhcmdldE5vZGUoaWQpOwogICAgICAgICAgdGhpcy5hcmdzID0gYXJndW1lbnRzOwogICAgICAgICAgdGhpcy5hdHRyaWJ1dGVzID0gQWFrLnNldFByb3BlcnRpZXModGhpcy5hdHRyaWJ1dGVzLCBhdHRyaWJ1dGVzIHx8IHt9KTsKICAgICAgICAgIHRoaXMub3B0aW9ucyA9IEFhay5zZXRQcm9wZXJ0aWVzKHRoaXMub3B0aW9ucywgb3B0aW9ucyB8fCB7fSk7CgogICAgICAgICAgdGhpcy5zZXR1cCA9IHNldHVwOwogICAgICAgICAgaWYgKHRoaXMub3B0aW9ucy5jcm9zc1NldHVwID09PSB0cnVlKSB7CiAgICAgICAgICAgIHRoaXMuYXR0cmlidXRlcy5zcmMgPSBzZXR1cC5zb3VyY2U7CiAgICAgICAgICAgIHRoaXMuYXR0cmlidXRlcy5oZWlnaHQgPSBzZXR1cC5oZWlnaHQgfHwgdGhpcy5hdHRyaWJ1dGVzLmhlaWdodDsKICAgICAgICAgICAgdGhpcy5hdHRyaWJ1dGVzLndpZHRoID0gc2V0dXAud2lkdGggfHwgdGhpcy5hdHRyaWJ1dGVzLndpZHRoOwogICAgICAgICAgICB0aGlzLmF0dHJpYnV0ZXMuY29udHJvbHMgPSB0cnVlOwogICAgICAgICAgICBpZiAoc2V0dXAuYXV0b3BsYXkgfHwgdGhpcy5hdXRvcGxheSkgewogICAgICAgICAgICAgIHRoaXMuYXR0cmlidXRlcy5hdXRvcGxheSA9IHRydWU7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KCiAgICAgICAgICB0aGlzLmF0dHJpYnV0ZXMudHlwZSA9ICJhcHBsaWNhdGlvbi94LXZsYy1wbHVnaW4iOwogICAgICAgICAgdGhpcy5hdHRyaWJ1dGVzLnBsdWdpbnNwYWdlID0gImh0dHA6Ly93d3cudmlkZW9sYW4ub3JnIjsKICAgICAgICAgIHRoaXMuYnVpbGRpbmcoJ2VtYmVkJyk7CiAgICAgICAgfSwKICAgICAgICBodG1sNSA6IGZ1bmN0aW9uIChpZCwgc2V0dXAsIGF0dHJpYnV0ZXMsIG9wdGlvbnMpIHsgCiAgICAgICAgICAvLyBWaWRlbyBUYWcgKGh0bWw1KQogICAgICAgICAgLy8gYmFzaWNzOiBodHRwczovL2h0bWw1cm9ja3MuY29tL2VuL3R1dG9yaWFscy92aWRlby9iYXNpY3MvCiAgICAgICAgICAvLyB0YWc6IGh0dHA6Ly93d3cudzNzY2hvb2xzLmNvbS90YWdzL3RhZ192aWRlby5hc3AKICAgICAgICAgIC8vIHN1cHBvcnQ6IG1wNCwgd2VibSwgb2dnCiAgICAgICAgICAvLyB0ZXN0OiBodHRwOi8vd3d3LnF1aXJrc21vZGUub3JnL2h0bWw1L3Rlc3RzL3ZpZGVvLmh0bWwKCiAgICAgICAgICB0aGlzLm9wdGlvbnMgPSBBYWsuc2V0UHJvcGVydGllcyh0aGlzLm9wdGlvbnMsIG9wdGlvbnMgfHwge30pOwoKICAgICAgICAgIHRoaXMuZ2V0VGFyZ2V0Tm9kZShpZCk7CiAgICAgICAgICB0aGlzLmFyZ3MgPSBhcmd1bWVudHM7CiAgICAgICAgICB0aGlzLmF0dHJpYnV0ZXMgPSBBYWsuc2V0UHJvcGVydGllcyh7fSwgc2V0dXAgfHwge30pOwogICAgICAgICAgdGhpcy5hdHRyaWJ1dGVzLnNyYyA9IHNldHVwLnNvdXJjZTsKICAgICAgICAgIHRoaXMuYXR0cmlidXRlcy5pZCA9IHRoaXMuYXR0cmlidXRlcy5uYW1lID0gQWFrLmdlbmVyYXRlSUQoKTsKICAgICAgICAgIHRoaXMuYXR0cmlidXRlcy5oZWlnaHQgPSB0aGlzLmF0dHJpYnV0ZXMuaGVpZ2h0IHx8IHRoaXMudGFyZ2V0Lm5vZGUuY2xpZW50SGVpZ2h0IHx8ICIxMDAlIjsKICAgICAgICAgIHRoaXMuYXR0cmlidXRlcy53aWR0aCA9IHRoaXMuYXR0cmlidXRlcy53aWR0aCB8fCB0aGlzLnRhcmdldC5ub2RlLmNsaWVudFdpZHRoIHx8ICIxMDAlIjsKICAgICAgICAgIHRoaXMuYXR0cmlidXRlcy50eXBlID0gdGhpcy5nZXRNaW1lVHlwZSh0aGlzLmF0dHJpYnV0ZXMudHlwZSk7CiAgICAgICAgICB0aGlzLmF0dHJpYnV0ZXMuY29udHJvbHMgPSAnY29udHJvbHMnOwogICAgICAgICAgdGhpcy5hdHRyaWJ1dGVzLnByZWxvYWQgPSAnbm9uZSc7CiAgICAgICAgICBpZiAodGhpcy5hdHRyaWJ1dGVzLmF1dG9wbGF5IHx8IHRoaXMuYXV0b3BsYXkpIHsKICAgICAgICAgICAgdGhpcy5hdHRyaWJ1dGVzLmF1dG9wbGF5ID0gJ2F1dG9wbGF5JzsKICAgICAgICAgIH0KICAgICAgICAgIHRoaXMuYXR0cmlidXRlcy5zdHlsZSA9ICdkaXNwbGF5OiBibG9jazsgbWFyZ2luOjAgYXV0bzsnOwogICAgICAgICAgdGhpcy5hdHRyaWJ1dGVzID0gQWFrLnVuc2V0UHJvcGVydGllcyh0aGlzLmF0dHJpYnV0ZXMsICdzb3VyY2UnKTsKCiAgICAgICAgICB0aGlzLmJ1aWxkaW5nKCd2aWRlbycpOwogICAgICAgIH0KICAgICAgfTsKICAgICAgCiAgICAgIHJldHVybiBuZXcgUGxheWVyKCk7CiAgICB9LAogICAgcnVsZXMgOiB7CiAgICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgICAgIC8vIEFudGktQWRibG9jayBLaWxsZXIKICAgICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAgICAgc2V0dGluZ3MgOiB7CiAgICAgICAgaG9zdCA6IFsnbG9jYWxob3N0JywgJ3JlZWsuZ2l0aHViLmlvJywgJ3JlZWtzaXRlLmNvbSddLAogICAgICAgIG9uRW5kIDogZnVuY3Rpb24gKCkgewoKICAgICAgICAgIGlmICgvXC9hbnRpLWFkYmxvY2sta2lsbGVyKC1wYWdlcyk/XC8kLy50ZXN0KGxvY2F0aW9uLnBhdGhuYW1lKSkgewogICAgICAgICAgICB2YXIgc2V0dGluZ3NCb3ggPSBBYWsuZ2V0RWxlbWVudCgnI2Fhay1zZXR0aW5ncy1ib3gnKTsKICAgICAgICAgICAgdmFyIHNldHRpbmdzTm90aWNlID0gQWFrLmdldEVsZW1lbnQoJyNhYWstc2V0dGluZ3Mtbm90aWNlJyk7CgogICAgICAgICAgICBpZiAoIUFhay51c2VHTSkgewogICAgICAgICAgICAgIHNldHRpbmdzTm90aWNlLnF1ZXJ5U2VsZWN0b3IoJ2RpdicpLmlubmVySFRNTCA9ICdJbiBuYXRpdmUgbW9kZSwgeW91IG11c3QgZWRpdCB0aGUgb3B0aW9ucyBtYW51YWxseTogPGEgaHJlZj0iJyArIEFhay5uYXRpdmVVUkwgKyAnIj5TZWU8L2E+JzsKICAgICAgICAgICAgfSBlbHNlIGlmIChzZXR0aW5nc0JveCAmJiBzZXR0aW5nc05vdGljZSkgewogICAgICAgICAgICAgIHNldHRpbmdzTm90aWNlLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7CiAgICAgICAgICAgICAgc2V0dGluZ3NCb3guc3R5bGUuZGlzcGxheSA9ICdibG9jayc7CiAgICAgICAgICAgICAgQWFrLmluZm8oJ0dNIHN0b3JhZ2U6JywgQWFrLmdldFZhbHVlKCkpOwogICAgICAgICAgICAgIEFhay5pbmZvKCdHTSBvcHRpb25zOicsIEFhay5vcHRzKTsKICAgICAgICAgICAgICBBYWsuaW5mbygnR00gYXBpOicsIEFhay51c2VHTSAmJiBBYWsuYXBpR00oKSk7CgogICAgICAgICAgICAgIC8vIHVzZXIgY29uZmlnCiAgICAgICAgICAgICAgQWFrLmNyZWF0ZUVsZW1lbnQoewogICAgICAgICAgICAgICAgdGFnIDogJ2RpdicsCiAgICAgICAgICAgICAgICBodG1sIDogJ1ZlcnNpb246ICcgKyBBYWsuZ2V0VmVyc2lvbigpICsgJyA8YnI+QWFrU2NyaXB0OiB0cnVlIDxicj5BYWtMaXN0OiAnICsgKCFBYWsuZ2V0RWxlbWVudCgnI2syVXc3aXNIck1tNUpYUDFWd2R4YzU2N1pLYzFhWjRJJykpICsgJyA8YnI+QnJvd3NlcjogJyArIEFhay5nZXRCcm93c2VyKCkgKyAnIDxicj5TY3JpcHRNYW5hZ2VyOiAnICsgQWFrLmdldFNjcmlwdE1hbmFnZXIoKSwKICAgICAgICAgICAgICAgIGFwcGVuZCA6ICcjYWFrLXNldHRpbmdzLWNvbmZpZycKICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgLy8gY3JlYXRlIG9wdGlvbnMgCiAgICAgICAgICAgICAgZm9yICh2YXIgb3B0TmFtZSBpbiBBYWsub3B0aW9ucykgewogICAgICAgICAgICAgICAgaWYgKEFhay5vcHRpb25zLmhhc093blByb3BlcnR5KG9wdE5hbWUpKSB7CiAgICAgICAgICAgICAgICAgIHZhciBvcHQgPSBBYWsub3B0aW9uc1tvcHROYW1lXTsKICAgICAgICAgICAgICAgICAgdmFyIGNoZWNrZWQgPSBBYWsub3B0c1tvcHROYW1lXSA9PT0gdHJ1ZSA/ICJjaGVja2VkIiA6ICcnOwogICAgICAgICAgICAgICAgICBBYWsuY3JlYXRlRWxlbWVudCh7CiAgICAgICAgICAgICAgICAgICAgdGFnIDogJ2RpdicsCiAgICAgICAgICAgICAgICAgICAgaHRtbCA6ICc8aW5wdXQgaWQ9IicgKyBvcHROYW1lICsgJyIgY2xhc3M9ImNzcy1jaGVja2JveCIgJyArIGNoZWNrZWQgKyAnIHR5cGU9IicgKyBvcHQudHlwZSArICciLz48bGFiZWwgZm9yPSInICsgb3B0TmFtZSArICciIHRpdGxlPSInICsgb3B0LmluZm8gKyAnIiBjbGFzcz0iY3NzLWxhYmVsIj4nICsgb3B0LmxhYmVsICsgJzwvbGFiZWw+JywKICAgICAgICAgICAgICAgICAgICBhcHBlbmQgOiAnI2Fhay1zZXR0aW5ncy0nICsgb3B0Lmdyb3VwCiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgLy8gc2F2ZSBvcHRpb25zIAogICAgICAgICAgICAgIEFhay5vbkV2ZW50KEFhay5nZXRFbGVtZW50KCIjYWFrLXNldHRpbmdzLXNhdmUiKSwgImNsaWNrIiwgZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgdmFyIGVsZW1zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmNzcy1jaGVja2JveCcpOwogICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBlbGVtcy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICAgICAgICB2YXIgZWxlbSA9IGVsZW1zW2ldOwogICAgICAgICAgICAgICAgICBpZiAoZWxlbS5jaGVja2VkKSB7CiAgICAgICAgICAgICAgICAgICAgQWFrLnNldFZhbHVlKGVsZW0uaWQsIHRydWUpOwogICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIEFhay5zZXRWYWx1ZShlbGVtLmlkLCBmYWxzZSk7CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHdpbmRvdy5hbGVydCgnU2F2ZWQgIScpOwogICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAvLyBDbGVhciBHTSBzdG9yYWdlCiAgICAgICAgICAgICAgQWFrLmFkZENvbW1hbmRzKHsKICAgICAgICAgICAgICAgIGNhcHRpb24gOiAnQ2xlYXIgR00gc3RvcmFnZScsCiAgICAgICAgICAgICAgICBleGVjdXRlIDogZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICBBYWsuZGVsZXRlVmFsdWUoKTsKICAgICAgICAgICAgICAgICAgd2luZG93LmFsZXJ0KCdDbGVhcmVkICEnKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSwKICAgICAgdXNlcnNjcmlwdHNfZG9tYWlucyA6IHsgLy8gUmVkaXJlY3QgdG8gR2l0aHViCiAgICAgICAgaG9zdCA6IFsndXNlcnNjcmlwdHMub3JnJywgJ3VzZXJzY3JpcHRzLm9yZzo4MDgwJywgJ3VzZXJzY3JpcHRzLW1pcnJvci5vcmcnXSwKICAgICAgICBvblN0YXJ0IDogZnVuY3Rpb24gKCkgewogICAgICAgICAgaWYgKC8xNTU4NDAkLy50ZXN0KGxvY2F0aW9uLnBhdGhuYW1lKSkgewogICAgICAgICAgICBBYWsuZ28oQWFrLmhvbWVVUkwpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSwKICAgICAgb3BlbnVzZXJqc19vcmcgOiB7CiAgICAgICAgaG9zdCA6IFsnb3BlbnVzZXJqcy5vcmcnXSwKICAgICAgICBvbklkbGUgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICB2YXIgZWxlbWVudCA9IEFhay5nZXRFbGVtZW50KCdhW2hyZWYkPSIvaXNzdWVzIl0nKTsKICAgICAgICAgIGlmICgvQW50aS1BZGJsb2NrX0tpbGxlcl9SZWVrLy50ZXN0KGxvY2F0aW9uLnBhdGhuYW1lKSAmJiBlbGVtZW50KSB7CiAgICAgICAgICAgIEFhay5jb25maXJtUmVwb3J0KGVsZW1lbnQpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSwKICAgICAgZ3JlYXN5Zm9ya19vcmcgOiB7CiAgICAgICAgaG9zdCA6IFsnZ3JlYXN5Zm9yay5vcmcnXSwKICAgICAgICBvbklkbGUgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICB2YXIgZWxlbWVudCA9IEFhay5nZXRFbGVtZW50KCdhW2hyZWYkPSIvZmVlZGJhY2siXScpOwogICAgICAgICAgaWYgKC8tYW50aS1hZGJsb2NrLWtpbGxlci1yZWVrLy50ZXN0KGxvY2F0aW9uLnBhdGhuYW1lKSAmJiBlbGVtZW50KSB7CiAgICAgICAgICAgIEFhay5jb25maXJtUmVwb3J0KGVsZW1lbnQpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSwKICAgICAgbW9ua2V5Z3V0c19jb20gOiB7CiAgICAgICAgaG9zdCA6IFsnbW9ua2V5Z3V0cy5jb20nXSwKICAgICAgICBvbklkbGUgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICB2YXIgZWxlbWVudCA9IEFhay5nZXRFbGVtZW50KCdhW2hyZWYqPSJjb2RlLnBocD9uYXY9Zm9ydW0iXScpOwogICAgICAgICAgaWYgKC9tb25rZXlndXRzLmNvbVwvY29kZS5waHBcP2lkPTM1MS8udGVzdChsb2NhdGlvbi5ocmVmKSAmJiBlbGVtZW50KSB7CiAgICAgICAgICAgIEFhay5jb25maXJtUmVwb3J0KGVsZW1lbnQpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSwKICAgICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAgICAgLy8gU3BlY2lmaWMKICAgICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAgICAgYmxvZ3Nwb3QgOiB7CiAgICAgICAgLy8gTm8gQ291bnRyeSBSZWRpcmVjdCAoTkNSKQogICAgICAgIC8vIFByZXZlbnQgQmxvZ2dlciBmcm9tIFJlZGlyZWN0aW5nIHRvIENvdW50cnktU3BlY2lmaWMgRG9tYWlucwogICAgICAgIC8vIGRvYzogaHR0cDovL3Rpbnl1cmwuY29tLzdybTM0am8KICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9ncmVhc3lmb3JrLm9yZy9mci9mb3J1bS9kaXNjdXNzaW9uLzU5NTMKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXMvNDkwCiAgICAgICAgLy8gdGVzdDogaHR0cDovL3Rpbnl1cmwuY29tL25vbWN4a2MKICAgICAgICBob3N0IDogWycuYmxvZ3Nwb3QuJ10sCiAgICAgICAgb25TdGFydCA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIGlmIChBYWsuaXNUb3BmcmFtZSkgeyAvLyBmaXggcmVkaXJldGlvbiBsb29wCiAgICAgICAgICAgIHZhciBibG9nID0gbG9jYXRpb24uaG9zdC5yZXBsYWNlKCd3d3cuJywgJycpLnNwbGl0KCIuIik7CiAgICAgICAgICAgIGlmIChibG9nW2Jsb2cubGVuZ3RoIC0gMV0gIT0gImNvbSIpIHsKICAgICAgICAgICAgICB2YXIgcGF0aCA9IGxvY2F0aW9uLmhyZWYuc3BsaXQoIi8iKS5zbGljZSgzKS5qb2luKCcvJyk7CiAgICAgICAgICAgICAgQWFrLmdvKCJodHRwOi8vIiArIGJsb2dbMF0gKyAiLmJsb2dzcG90LmNvbS9uY3IvIiArIHBhdGgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9LAogICAgICBibG9nc3BvdF9rbm93bGV0MzM4OSA6IHsKICAgICAgICAvLyBub3RlOiBhbHNvIGFkZGVkIGFicCBydWxlCiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzLzgzCiAgICAgICAgLy8gc291cmNlOiBodHRwOi8vcGFzdGViaW4uY29tL0EzbUNYUTVpCiAgICAgICAgaG9zdCA6IFsna25vd2xldDMzODkuYmxvZ3Nwb3QuJ10sCiAgICAgICAgb25TdGFydCA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEFhay5zZXRMb2NhbCgnbm9hZCcsIGZhbHNlKTsKICAgICAgICAgIEFhay5hZGRTdHlsZSgiI2dBZHMgeyBoZWlnaHQ6IDE3cHg7IH0gI2dBZDIgeyBoZWlnaHQ6IDE3cHg7IH0iKTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIHVwdG9ib3hfdXB0b3N0cmVhbSA6IHsKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXMvMzUxCiAgICAgICAgaG9zdCA6IFsndXB0b2JveC5jb20nLCAndXB0b3N0cmVhbS5jb20nXSwKICAgICAgICBvblN0YXJ0IDogZnVuY3Rpb24gKCkgewogICAgICAgICAgLy8gT2xkIHNvbHV0aW9uIFtkZXByZWNhdGVkXQogICAgICAgICAgdmFyIGlkID0gbG9jYXRpb24ucGF0aG5hbWUubWF0Y2goL1swLTlhLXpdezEyfS8pOwogICAgICAgICAgaWYgKGlkICE9PSBudWxsKSB7CiAgICAgICAgICAgIEFhay5hZGRTdHlsZSgiIyIgKyBpZFswXSArICIgeyBoZWlnaHQ6IDEycHg7IH0iKTsKICAgICAgICAgIH0KICAgICAgICAgIC8vIE5ldyAxMi4wNS4yMDE0CiAgICAgICAgICAvLyArIGFicCBydWxlIChhbHRlcm5hdGl2ZSBzb2x1dGlvbikKICAgICAgICAgIEFhay5hZGRTdHlsZSgiI2FkYmxvY2t0cmFwIHsgaGVpZ2h0OiAxMnB4OyB9Iik7CiAgICAgICAgfSwKICAgICAgICBvbklkbGUgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAvLyByZW1vdmUgYWRzCiAgICAgICAgICBBYWsucmVtb3ZlRWxlbWVudCgnKltzcmNePSJodHRwOi8vYWRzLnVwdG9ib3guY29tLyJdLCpbaHJlZl49Imh0dHA6Ly9hZHMudXB0b2JveC5jb20vIl0nKTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGFuaXN1YnNpYV9jb20gOiB7CiAgICAgICAgaG9zdCA6IFsnYW5pc3Vic2lhLmNvbSddLAogICAgICAgIG9uU3RhcnQgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAvLyArIGFicCBydWxlICNAIy5hZHNhbnRpbG9rCiAgICAgICAgICBBYWsuYWRkU3R5bGUoIi5hZHNhbnRpbG9rIHsgaGVpZ2h0OiA1cHg7IH0iKTsKICAgICAgICB9LAogICAgICAgIG9uSWRsZSA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEFhay51dy5qQW50aUJsb2NrID0gZnVuY3Rpb24gKCkge307CiAgICAgICAgICBBYWsudXcuQ2VrQmxvayA9IGZ1bmN0aW9uICgpIHt9OwogICAgICAgIH0KICAgICAgfSwKICAgICAgZnJlZWdhbWVzZXJ2ZXJob3N0X2NvbSA6IHsKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXMvMTUxMgogICAgICAgIGhvc3QgOiBbJ2ZyZWVnYW1lc2VydmVyaG9zdC5jb20nXSwKICAgICAgICBvblN0YXJ0IDogZnVuY3Rpb24gKCkgewogICAgICAgICAgQWFrLmFkZFN0eWxlKCIjZmFiMTMgeyBoZWlnaHQ6IDExcHg7IH0iKTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGVsYWhtYWRfY29tIDogewogICAgICAgIGhvc3QgOiBbJ2VsYWhtYWQuY29tJ10sCiAgICAgICAgb25TdGFydCA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEFhay5hZGRTdHlsZSgiI2FkYmxvY2sgeyBoZWlnaHQ6IDFweDsgfSIpOwogICAgICAgIH0KICAgICAgfSwKICAgICAgbXJ0emNtcDNfbmV0IDogewogICAgICAgIGhvc3QgOiBbJ21ydHpjbXAzLm5ldCddLAogICAgICAgIG9uU3RhcnQgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBBYWsuYWRkU3R5bGUoIi5ydG1fYWQgeyBoZWlnaHQ6IDFweDsgfSIpOwogICAgICAgIH0KICAgICAgfSwKICAgICAgaGVpZ2h0X215VGVzdEFkIDogewogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcy8xMjQxCiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzLzk4MwogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcy8yOTEKICAgICAgICBob3N0IDogWydia25pbWUuY29tJywgJ2dvNHVwLmNvbScsICdkZWJyaWRvLmNvbSddLAogICAgICAgIG9uU3RhcnQgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBBYWsuYWRkU3R5bGUoIi5teVRlc3RBZCB7IGhlaWdodDogMXB4OyB9Iik7CiAgICAgICAgfQogICAgICB9LAogICAgICBkZWJyaWRmYXN0X25ldHdvcmsgOiB7CiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ3JlYXN5Zm9yay5vcmcvZW4vZm9ydW0vZGlzY3Vzc2lvbi85NDA2CiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ3JlYXN5Zm9yay5vcmcvZW4vZm9ydW0vZGlzY3Vzc2lvbi83MDEzCiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzLzEyNzIKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXMvNzY5CiAgICAgICAgaG9zdCA6IFsnZGVicmlkZmFzdC5jb20nLCAnZ2V0ZGVicmlkLmNvbScsICdkZWJyaWQudXMnLCAnbGVlY2hlci51cyddLAogICAgICAgIG9uU3RhcnQgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBBYWsuYWRkU3R5bGUoIi5teVRlc3RBZCwgLm15MjRBZCwgLm5hYmlsIHsgaGVpZ2h0OiAxcHg7IH0iKTsKICAgICAgICB9LAogICAgICAgIG9uSWRsZSA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNzaW1wbGVBZCcpLmlubmVySFRNTCA9ICc8cCBzdHlsZT0iZGlzcGxheTpub25lOyI+ZGVicmlkZmFzdC5jb208L3A+JzsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGJnX2dsZWRhaV90diA6IHsKICAgICAgICBob3N0IDogWydiZy1nbGVkYWkudHYnXSwKICAgICAgICBvblN0YXJ0IDogZnVuY3Rpb24gKCkgewogICAgICAgICAgQWFrLmFkZFN0eWxlKCIubXlBZCB7IGhlaWdodDogMXB4OyB9Iik7CiAgICAgICAgfQogICAgICB9LAogICAgICB0aGVwY3NweV9jb20gOiB7IC8vIGh0dHA6Ly90aGVwY3NweS5jb20vcmVhZC9ob3dfdG9fYmxvY2tfYWRibG9jay8KICAgICAgICBob3N0IDogWyd0aGVwY3NweS5jb20nXSwKICAgICAgICBvblN0YXJ0IDogZnVuY3Rpb24gKCkgewogICAgICAgICAgQWFrLmFkZFN0eWxlKCIubXlUZXN0QWQgeyBoZWlnaHQ6IDFweDsgfSIpOwogICAgICAgICAgQWFrLmFkZFN0eWxlKCIuYmxvY2tlZCB7IGRpc3BsYXk6IG5vbmU7IH0iKTsKICAgICAgICB9LAogICAgICAgIG9uSWRsZSA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEFhay5yZW1vdmVFbGVtZW50KCcuYmxvY2tlZCcpOwogICAgICAgIH0KICAgICAgfSwKICAgICAgdmdfZTI0X25vIDogewogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcy8yOTIKICAgICAgICBob3N0IDogWyd2Zy5ubycsICdlMjQubm8nXSwKICAgICAgICBvblN0YXJ0IDogZnVuY3Rpb24gKCkgewogICAgICAgICAgLy8gQWRkIHRoaXMgcnVsZSwgYmVjYXVzZSBFYXN5TGlzdCBhbGxvdyBhbGwgaGlkZGVuIGVsZW1lbnRzLgogICAgICAgICAgQWFrLmFkZFN0eWxlKCIuYWQgeyBkaXNwbGF5OiBub25lOyB9Iik7CiAgICAgICAgfQogICAgICB9LAogICAgICBhdXRvbW9iaWxlX3Nwb3J0aXZlX2NvbSA6IHsKICAgICAgICBob3N0IDogWydhdXRvbW9iaWxlLXNwb3J0aXZlLmNvbSddLAogICAgICAgIG9uU3RhcnQgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBBYWsuYWRkU3R5bGUoIi5teVRlc3RBZCB7IGhlaWdodDogNTFweDsgZGlzcGxheTogbm9uZTsgfSIpOwogICAgICAgIH0KICAgICAgfSwKICAgICAgc25zd191cyA6IHsKICAgICAgICBob3N0IDogWydzbnN3LnVzJ10sCiAgICAgICAgb25TdGFydCA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEFhay5hZGRTdHlsZSgiI2FkXzEgeyBoZWlnaHQ6IDFweDsgfSIpOwogICAgICAgIH0KICAgICAgfSwKICAgICAgdXJsY2hlY2tlcl9uZXQgOiB7CiAgICAgICAgaG9zdCA6IFsndXJsY2hlY2tlci5uZXQnXSwKICAgICAgICBvblN0YXJ0IDogZnVuY3Rpb24gKCkgewogICAgICAgICAgQWFrLmFkZFN0eWxlKCIjYWRjaGVja2VyIHsgaGVpZ2h0OiAyMHB4OyB9Iik7CiAgICAgICAgfQogICAgICB9LAogICAgICBza2lwbGltaXRlX3R2IDogewogICAgICAgIGhvc3QgOiBbJ3NraXBsaW1pdGUudHYnXSwKICAgICAgICBvblN0YXJ0IDogZnVuY3Rpb24gKCkgewogICAgICAgICAgQWFrLmFkZFN0eWxlKCJkaXYuYWRkdGhpc19uYXRpdmVfdG9vbGJveCArIGRpdltpZF0geyBoZWlnaHQ6IDEycHg7IH0iKTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGZpbGVjb3JlX2NvX256IDogewogICAgICAgIGhvc3QgOiBbJ2ZpbGVjb3JlLmNvLm56J10sCiAgICAgICAgb25TdGFydCA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEFhay5hZGRTdHlsZSgiLmFkc2Vuc2UgeyBoZWlnaHQ6IDVweDsgfSIpOwogICAgICAgIH0KICAgICAgfSwKICAgICAgdGhvbWFzX25fcnV0aF9jb20gOiB7CiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzLzExMTEKICAgICAgICAvLyBzb3VyY2U6IGh0dHA6Ly9wYXN0ZWJpbi5jb20vZnU3dmtVQTEKICAgICAgICBob3N0IDogWyd0aG9tYXMtbi1ydXRoLmNvbSddLAogICAgICAgIG9uU3RhcnQgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBBYWsuYWRkU3R5bGUoIi5Hb29nbGUgeyBoZWlnaHQ6IDVweDsgfSIpOwogICAgICAgIH0KICAgICAgfSwKICAgICAgaW50ZXJmYW5zX29yZyA6IHsKICAgICAgICAvLyB0ZXN0OiBodHRwOi8vd3d3LmludGVyZmFucy5vcmcvZm9ydW0vCiAgICAgICAgaG9zdCA6IFsnaW50ZXJmYW5zLm9yZyddLAogICAgICAgIG9uU3RhcnQgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBBYWsuYWRkU3R5bGUoIi5hZF9nbG9iYWxfaGVhZGVyIHsgaGVpZ2h0OiAxcHg7IGRpc3BsYXk6IG5vbmU7IH0iKTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIG1heGRlYnJpZGV1cl9jb20gOiB7CiAgICAgICAgaG9zdCA6IFsnbWF4ZGVicmlkZXVyLmNvbSddLAogICAgICAgIG9uU3RhcnQgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBBYWsuYWRkU3R5bGUoIi5jbGVhciArIGRpdltpZF0geyBoZWlnaHQ6IDEycHg7IH0iKTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIHRvcHpvbmVfaXQgOiB7CiAgICAgICAgaG9zdCA6IFsndG9wem9uZS5sdCddLAogICAgICAgIG9uU3RhcnQgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBBYWsuYWRkU3R5bGUoIi5mb3J1bUFkIHsgaGVpZ2h0OiAxcHg7IGRpc3BsYXk6IG5vbmU7IH0iKTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIG5hbmExMF9jb19pbCA6IHsKICAgICAgICBob3N0IDogWycubmFuYTEwLiddLAogICAgICAgIG9uU3RhcnQgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBBYWsuYWRkU3R5bGUoIiNhZHZlcnQtdHJhY2tlciB7IGhlaWdodDogMXB4OyB9Iik7CiAgICAgICAgfQogICAgICB9LAogICAgICBwbGVqX3R2IDogewogICAgICAgIGhvc3QgOiBbJ3BsZWoudHYnXSwKICAgICAgICBvblN0YXJ0IDogZnVuY3Rpb24gKCkgewogICAgICAgICAgQWFrLmFkZFN0eWxlKCIuYWR2ZXJ0X2JveCB7IGhlaWdodDogMXB4OyB9Iik7CiAgICAgICAgfQogICAgICB9LAogICAgICBtYW5nYW1pbnRfY29tIDogewogICAgICAgIC8vIG5vdGU6IGFkZGVkIHJ1bGUgdG8gYWxsb3cgIi5hZDcyOCIKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9ncmVhc3lmb3JrLm9yZy9pZC9mb3J1bS9kaXNjdXNzaW9uLzg1MjQKICAgICAgICBob3N0IDogWydtYW5nYW1pbnQuY29tJ10sCiAgICAgICAgb25TdGFydCA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEFhay5hZGRTdHlsZSgiLmFkNzI4IHsgaGVpZ2h0OiAzMXB4OyB9Iik7CiAgICAgICAgfQogICAgICB9LAogICAgICBkZWJyaWRldXJzdHJlYW1fZnIgOiB7CiAgICAgICAgaG9zdCA6IFsnZGVicmlkZXVyc3RyZWFtLmZyJ10sCiAgICAgICAgb25TdGFydCA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEFhay5hZGRTdHlsZSgiI2NvbnRlbnQgZGl2W2lkXVthbGlnbj1jZW50ZXJdIHsgaGVpZ2h0OiAxMnB4OyB9Iik7CiAgICAgICAgfQogICAgICB9LAogICAgICBwcmVlbWxpbmtzX2NvbSA6IHsKICAgICAgICBob3N0IDogWydwcmVlbWxpbmtzLmNvbSddLAogICAgICAgIG9uU3RhcnQgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBBYWsuYWRkU3R5bGUoIiNkaXZhZHMgeyBoZWlnaHQ6IDFweDsgfSIpOwogICAgICAgIH0KICAgICAgfSwKICAgICAgaGVudGFpX3RvIDogewogICAgICAgIGhvc3QgOiBbJ2hlbnRhaS50byddLAogICAgICAgIG9uU3RhcnQgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBBYWsuYWRkU3R5bGUoIiNoZW50YWl0bzEyMyB7IGhlaWdodDogMTFweDsgfSIpOwogICAgICAgIH0KICAgICAgfSwKICAgICAgcHJvdG90dXJrX2NvbSA6IHsKICAgICAgICBob3N0IDogWydwcm90b3R1cmsuY29tJ10sCiAgICAgICAgb25TdGFydCA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEFhay5hZGRTdHlsZSgiI3Jla2xhbSB7IGhlaWdodDogMXB4OyB9Iik7CiAgICAgICAgfQogICAgICB9LAogICAgICBtdWZhX2RlIDogewogICAgICAgIGhvc3QgOiBbJ211ZmEuZGUnXSwKICAgICAgICBvblN0YXJ0IDogZnVuY3Rpb24gKCkgewogICAgICAgICAgQWFrLmFkZFN0eWxlKCIjbGVhZGVyYm9hcmQgeyBoZWlnaHQ6IDVweDsgfSIpOwogICAgICAgICAgQWFrLmFkZFN0eWxlKCIjbGFyZ2UtcmVjdGFuZ2xlIHsgaGVpZ2h0OiA1cHg7IH0iKTsKICAgICAgICAgIEFhay5hZGRTdHlsZSgiI2FkLWhlYWRlci00Njh4NjAgeyBoZWlnaHQ6IDVweDsgfSIpOwogICAgICAgIH0KICAgICAgfSwKICAgICAgd2F0Y2hhcmFiX2NvbSA6IHsKICAgICAgICBob3N0IDogWyd3YXRjaGFyYWIuY29tJ10sCiAgICAgICAgb25TdGFydCA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIC8vICsgYWRwIHJ1bGUgd2F0Y2hhcmFiLmNvbSNAIyNhZGJsb2NrCiAgICAgICAgICBBYWsuYWRkU3R5bGUoIiNhZGJsb2NrIHsgaGVpZ2h0OiA1cHg7IH0iKTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGZyZWVkb21pcF9jb20gOiB7CiAgICAgICAgaG9zdCA6IFsnZnJlZWRvbS1pcC5jb20nXSwKICAgICAgICBvblN0YXJ0IDogZnVuY3Rpb24gKCkgewogICAgICAgICAgQWFrLmFkZFN0eWxlKCIucHViX3ZlcnRpY2FsIGlucywgLnB1Yl92ZXJ0aWNhbCBkaXYgeyBoZWlnaHQ6IDExcHg7IH0iKTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIHdha2FuaW1fdHYgOiB7CiAgICAgICAgaG9zdCA6IFsnd2FrYW5pbS50diddLAogICAgICAgIG9uU3RhcnQgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBBYWsuYWRkU3R5bGUoIiNkZXRlY3RvciB7IGRpc3BsYXk6IG5vbmU7IH0iKTsKICAgICAgICAgIEFhay5hZGRTdHlsZSgiI25vcHViIHsgZGlzcGxheTogYmxvY2s7IH0iKTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIHNpbXBseV9kZWJyaWRfY29tIDogewogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcy8zMzIKICAgICAgICAvLyBzb3VyY2U6IGh0dHA6Ly9wYXN0ZWJpbi5jb20vYjdNQVlYczQKICAgICAgICBob3N0IDogWydzaW1wbHktZGVicmlkLmNvbSddLAogICAgICAgIG9uU3RhcnQgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBBYWsudXcuYWRzYnlnb29nbGUgPSB7fTsKICAgICAgICAgIEFhay51dy5hZHNieWdvb2dsZS5sb2FkZWQgPSB0cnVlOwogICAgICAgIH0KICAgICAgfSwKICAgICAgbWFuZ2E5X2NvbSA6IHsKICAgICAgICBob3N0IDogWydtYW5nYTkuY29tJywgJ21hbmdhYmVlLmNvJ10sCiAgICAgICAgb25TdGFydCA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEFhay5hZGRTdHlsZSgiLmFkYmxvY2sgeyBoZWlnaHQ6IDMxcHg7IH0iKTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIG9uZW1hbmdhMl9jb20gOiB7CiAgICAgICAgaG9zdCA6IFsnb25lbWFuZ2EyLmNvbSddLAogICAgICAgIG9uU3RhcnQgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBBYWsuYWRkU3R5bGUoIi5hZnNfYWRzIHsgaGVpZ2h0OiA1cHg7IH0iKTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIG1hbmdhYmlyZF9jb20gOiB7CiAgICAgICAgaG9zdCA6IFsnbWFuZ2FiaXJkLmNvbSddLAogICAgICAgIG9uU3RhcnQgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBBYWsuYWRkU3R5bGUoIi5hZnNfYWRzIHsgaGVpZ2h0OiA1cHg7IH0iKTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGtvZGlsaXZlX2V1IDogewogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcy8xNTI4CiAgICAgICAgLy8gc291cmNlOiBodHRwOi8vcGFzdGViaW4uY29tL1p4dlhLcXRjCiAgICAgICAgaG9zdCA6IFsna29kaWxpdmUuZXUnXSwKICAgICAgICBvblN0YXJ0IDogZnVuY3Rpb24gKCkgewogICAgICAgICAgQWFrLmFkZFN0eWxlKCIuQWQgeyBoZWlnaHQ6IDVweDsgfSIpOwogICAgICAgIH0KICAgICAgfSwKICAgICAgYmFja2luX25ldCA6IHsKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXM/cT1iYWNraW4ubmV0CiAgICAgICAgaG9zdCA6IFsnYmFja2luLm5ldCddLAogICAgICAgIG9uU3RhcnQgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBBYWsuYWRkU3R5bGUoIiNkaXZhZCB7IGhlaWdodDogMzFweDsgfSIpOwogICAgICAgIH0KICAgICAgfSwKICAgICAgbW9iaWxlX3RyYWNrZXJfZnJlZV9jb20gOiB7CiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzLzEwODIKICAgICAgICBob3N0IDogWydtb2JpbGUtdHJhY2tlci1mcmVlLmNvbSddLAogICAgICAgIG9uU3RhcnQgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBBYWsuYWRkU3R5bGUoIiNteUFkcyB7IGhlaWdodDogMXB4OyB9Iik7CiAgICAgICAgfQogICAgICB9LAogICAgICB3b3JrdXBsb2FkX2NvbSA6IHsKICAgICAgICAvLyBub3RlOiBvYmZ1c2NhdGVkCiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzLzEzMzQKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXMvMTI5MAogICAgICAgIC8vIHNvdXJjZTogaHR0cDovL3Bhc3RlYmluLmNvbS9DUHpkMlN3eAogICAgICAgIGhvc3QgOiBbJ3dvcmt1cGxvYWQuY29tJ10sCiAgICAgICAgb25BbHdheXMgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBBYWsuYWRkU3R5bGUoIi5hZEJsb2NrLCAuYWRzYnlnb29nbGUsICNzYWQgeyBoZWlnaHQ6IDExcHg7IH0iKTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIHRvZGF5X2luIDogewogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcz9xPWludG9kYXkuaW4KICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXM/cT1idXNpbmVzc3RvZGF5LmluCiAgICAgICAgLy8gc291cmNlOiBodHRwOi8vcGFzdGViaW4uY29tL2d6NTM5RzdtCiAgICAgICAgaG9zdCA6IFsiaW50b2RheS5pbiIsICJidXNpbmVzc3RvZGF5LmluIl0sCiAgICAgICAgb25TdGFydCA6IGZ1bmN0aW9uKCkgewogICAgICAgICAgQWFrLmFkZFN0eWxlKCcjYWRib2NrZXJfYWx0IHsgZGlzcGxheTogbm9uZTsgfScpOwogICAgICAgICAgQWFrLnV3Lm9wZW5Qb3B1cCA9IGZ1bmN0aW9uKCl7fTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGpjX21wX2NvbSA6IHsKICAgICAgICAvLyBieTogR2l3YXl1bWUKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXMvMTU5NwogICAgICAgIGhvc3QgOiBbImpjLW1wLmNvbSJdLAogICAgICAgIG9uU3RhcnQgOiBmdW5jdGlvbigpIHsKICAgICAgICAgIEFhay5hZGRTdHlsZSgnLmFkc2Vuc2Uge3dpZHRoOiAxcHg7IGhlaWdodDogMXB4OyB2aXNpYmlsaXR5OiBoaWRkZW47IGRpc3BsYXk6IGJsb2NrOyBwb3NpdGlvbjogYWJzb2x1dGU7fScpOwogICAgICAgIH0KICAgICAgfSwKICAgICAgbWFyaWFnZV9mcmFuY29fbWFyb2NhaW5fbmV0IDogewogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcz9xPW1hcmlhZ2UtZnJhbmNvLW1hcm9jYWluLm5ldAogICAgICAgIGhvc3QgOiBbIm1hcmlhZ2UtZnJhbmNvLW1hcm9jYWluLm5ldCJdLAogICAgICAgIG9uU3RhcnQgOiBmdW5jdGlvbigpIHsKICAgICAgICAgIEFhay5hZGRTdHlsZSgnI215X2FkX2RpdiB7aGVpZ2h0OiAxcHg7fScpOwogICAgICAgIH0KICAgICAgfSwKICAgICAgaGFwcHlfaGFja19ydSA6IHsKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXM/cT1oYXBweS1oYWNrLnJ1CiAgICAgICAgaG9zdCA6IFsnaGFwcHktaGFjay5ydSddLAogICAgICAgIG9uU3RhcnQgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBBYWsuYWRkU3R5bGUoIiNibG9ja2Jsb2NrRjQge3Zpc2liaWxpdHk6aW52aXNpYmxlO2Rpc3BsYXk6bm9uZTt9ICNibG9ja2Jsb2NrRjQgdGQge3Zpc2liaWxpdHk6aW52aXNpYmxlO2Rpc3BsYXk6bm9uZTt9ICNibG9ja2Jsb2NrRjQgdGQgcCB7dmlzaWJpbGl0eTppbnZpc2libGU7ZGlzcGxheTpub25lO30gI2Jsb2NrYmxvY2tEMyB7dmlzaWJpbGl0eTp2aXNpYmxlO2Rpc3BsYXk6YmxvY2s7fSIpOwogICAgICAgIH0KICAgICAgfSwKICAgICAgZm9yYmVzX2NvbSA6IHsKICAgICAgICAvLyBieTogR2l3YXl1bWUKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXMvODY1CiAgICAgICAgaG9zdCA6IFsnZm9yYmVzLmNvbSddLAogICAgICAgIG9uU3RhcnQgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBpZiAod2luZG93LmxvY2F0aW9uLnBhdGhuYW1lLmluZGV4T2YoJy93ZWxjb21lJykgPiAtMSkgewogICAgICAgICAgICBBYWsuc2V0Q29va2llKCd3ZWxjb21lQWQnLCAndHJ1ZScsIDg2NDAwMDAwLCAnLycpOwogICAgICAgICAgICBBYWsuc2V0Q29va2llKCdkYWlseVdlbGNvbWVDb29raWUnLCAndHJ1ZScsIDg2NDAwMDAwLCAnLycpOwogICAgICAgICAgICB3aW5kb3cubG9jYXRpb24gPSBBYWsuZ2V0Q29va2llKCd0b1VybCcpIHx8ICdodHRwOi8vd3d3LmZvcmJlcy5jb20vJzsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0sCiAgICAgIGJhaXRfYWRzYnlnb29nbGUgOiB7CiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzLzU0NwogICAgICAgIGhvc3QgOiBbJ2JpdGNvaW5hbGllbnMuY29tJ10sCiAgICAgICAgb25TdGFydCA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEFhay5hZGRCYWl0RWxlbWVudCgnaW5zLmFkc2J5Z29vZ2xlJyk7CiAgICAgICAgfQogICAgICB9LAogICAgICBiYWl0X3Rlc3RlciA6IHsKICAgICAgICBob3N0IDogWydvc29hcmNhZGUuY29tJywgJ2QzYnJpZDR5MHUuaW5mbycsICdmaWxlaWNlLm5ldCcsICdub3N0ZWFtLnJvJywgJ29wZW5ydW5uZXIuY29tJywgJ2Vhc3liaWxsZXRzLmNvbScsICdzcG94LmZyJywgJ3lvdm95YWdlcy5jb20nLCAndHYzLmNvLm56JywgJ2ZyZWVhbGxtdXNpYy5pbmZvJywgJ3B1dGxvY2tlci5jb20nLCAnc29ja3NoYXJlLmNvbScsICdkcmFtYXBhc3Npb24uY29tJywgJ3lvb2NsaWNrLmNvbScsICdvbmxpbmUudWEnXSwKICAgICAgICBvblN0YXJ0IDogZnVuY3Rpb24gKCkgewogICAgICAgICAgQWFrLmFkZEJhaXRFbGVtZW50KCdkaXYjdGVzdGVyJyk7CiAgICAgICAgfQogICAgICB9LAogICAgICBiYWl0X2FkZCA6IHsKICAgICAgICBob3N0IDogWydmaWxlY29tLm5ldCcsICd1cHNoYXJlLm9yZycsICdza2lwcHlmaWxlLmNvbScsICdtd2ZpbGVzLm5ldCcsICd1cC1mbG93Lm9yZyddLAogICAgICAgIG9uU3RhcnQgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBBYWsuYWRkQmFpdEVsZW1lbnQoJ2RpdiNhZGQnKTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGJhaXRfYWRwYnRlc3QgOiB7CiAgICAgICAgaG9zdCA6IFsnbGVhZ3Vlc2VjcmV0YXJ5LmNvbScsICd0ZWtub2dvZHMuY29tJywgJ2hlbGxzbWVkaWEuY29tJ10sCiAgICAgICAgb25TdGFydCA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEFhay5hZGRCYWl0RWxlbWVudCgnZGl2I2FkcGJ0ZXN0Jyk7CiAgICAgICAgfQogICAgICB9LAogICAgICBiYWl0X2FkdGVzdGVyIDogewogICAgICAgIGhvc3QgOiBbJ2ZyZWVzcG9ydHNiZXQuY29tJywgJ3Nwb3J0c3BsYXlzLmNvbSddLAogICAgICAgIG9uU3RhcnQgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBBYWsuYWRkQmFpdEVsZW1lbnQoJ2RpdiNhZC10ZXN0ZXInKTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIHRnb190dl9jb20gOiB7CiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzLzMwMwogICAgICAgIGhvc3QgOiBbJ3Rnby10di5jb20nXSwKICAgICAgICBvblN0YXJ0IDogZnVuY3Rpb24gKCkgewogICAgICAgICAgQWFrLmFkZFN0eWxlKCIjYWRiLCAjYmFubmVyYWQxLCAubG9hZF9zdHJlYW0geyBkaXNwbGF5OiBub25lOyB9Iik7CiAgICAgICAgICBBYWsuYWRkQmFpdEVsZW1lbnQoJ2RpdiN0ZXN0ZXInKTsKICAgICAgICB9LAogICAgICAgIG9uRW5kIDogZnVuY3Rpb24gKCkgewogICAgICAgICAgQWFrLnV3LnRocmVzaG9sZCA9IDEwMDA7CiAgICAgICAgICBBYWsucmVtb3ZlRWxlbWVudCgnLmNoYXRfZnJhbWUnKTsgLy8gYnVnIHJlbG9hZCBpZnJhbWUKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGZyZWVnYW1laG9zdGluZ19ubCA6IHsKICAgICAgICBob3N0IDogWydmcmVlZ2FtZWhvc3RpbmcubmwnXSwKICAgICAgICBvblN0YXJ0IDogZnVuY3Rpb24gKCkgewogICAgICAgICAgQWFrLmFkZEJhaXRFbGVtZW50KCdkaXYjYWR0ZXN0Jyk7CiAgICAgICAgfQogICAgICB9LAogICAgICB0aGV3ZWF0aGVyc3BhY2VfY29tIDogewogICAgICAgIGhvc3QgOiBbJ3RoZXdlYXRoZXJzcGFjZS5jb20nXSwKICAgICAgICBvblN0YXJ0IDogZnVuY3Rpb24gKCkgewogICAgICAgICAgQWFrLmFkZEJhaXRFbGVtZW50KCdkaXYjYWItYmwtYWR2ZXJ0aXNlbWVudCcpOwogICAgICAgIH0KICAgICAgfSwKICAgICAgY2xlb2Rlc2t0b3BfY29tIDogewogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcy83MTEKICAgICAgICBob3N0IDogWydjbGVvZGVza3RvcC5jb20nXSwKICAgICAgICBvblN0YXJ0IDogZnVuY3Rpb24gKCkgewogICAgICAgICAgQWFrLmFkZEJhaXRFbGVtZW50KCdkaXYjbXlUZXN0QWQnKTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGltYWdlcmFpZGVyX2NvbSA6IHsKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXMvODI2CiAgICAgICAgaG9zdCA6IFsnaW1hZ2VyYWlkZXIuY29tJ10sCiAgICAgICAgb25TdGFydCA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEFhay5hZGRCYWl0RWxlbWVudCgnZGl2I215R0NvbnRhaW5lcicpOwogICAgICAgIH0KICAgICAgfSwKICAgICAgdm9pY2lfZnIgOiB7CiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ3JlYXN5Zm9yay5vcmcvZnIvZm9ydW0vZGlzY3Vzc2lvbi8xMDA5MwogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcy84MjYKICAgICAgICAvLyBzb3VyY2U6IGh0dHA6Ly9wYXN0ZWJpbi5jb20vekVWUUhUaUQKICAgICAgICBob3N0IDogWyd2b2ljaS5mcicsICdwcm9ncmFtbWUtdHYubmV0J10sCiAgICAgICAgb25TdGFydCA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEFhay5hZGRCYWl0RWxlbWVudCgnZGl2I3Nhc19zY3JpcHQyJyk7CiAgICAgICAgfQogICAgICB9LAogICAgICBtaWxfaW5rIDogewogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcy8xNjUyCiAgICAgICAgLy8gc291cmNlOiBodHRwOi8vcGFzdGViaW4uY29tLzQ3NE5aelBKCiAgICAgICAgaG9zdCA6IFsnbWlsLmluayddLAogICAgICAgIG9uU3RhcnQgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBBYWsuYWRkQmFpdEVsZW1lbnQoJ2RpdiNhZHNfZGl2Jyk7CiAgICAgICAgfQogICAgICB9LAogICAgICBjdWJldXBsb2FkX2NvbSA6IHsKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9ncmVhc3lmb3JrLm9yZy9lbi9mb3J1bS9kaXNjdXNzaW9uLzU5MTkKICAgICAgICBob3N0IDogWydjdWJldXBsb2FkLmNvbSddLAogICAgICAgIG9uU3RhcnQgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBBYWsuY3JlYXRlRWxlbWVudCh7CiAgICAgICAgICAgIHRhZyA6ICdpZnJhbWUnLAogICAgICAgICAgICBuYW1lIDogJ2lmcmFtZScsCiAgICAgICAgICAgIHNyYyA6ICdhYm91dDpibGFuaycsCiAgICAgICAgICAgIHN0eWxlIDogJ2Rpc3BsYXk6bm9uZTsnLAogICAgICAgICAgICBhcHBlbmQgOiBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfSwKICAgICAgc3RyZWFtNGZyZWVfZXUgOiB7CiAgICAgICAgaG9zdCA6IFsnc3RyZWFtNGZyZWUuZXUnXSwKICAgICAgICBvblN0YXJ0IDogZnVuY3Rpb24gKCkgewogICAgICAgICAgLy8gK2FicCBhbHQgc29sdXRpb24KICAgICAgICAgIEFhay5hZGRCYWl0RWxlbWVudCgnZGl2I2pwYXlkYXknKTsKICAgICAgICAgIEFhay51dy5qcGF5ZGF5X2FsZXJ0ID0gMTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIF8zZG5ld3NfcnUgOiB7CiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ3JlYXN5Zm9yay5vcmcvcnUvZm9ydW0vZGlzY3Vzc2lvbi81NzUwCiAgICAgICAgaG9zdCA6IFsnM2RuZXdzLnJ1J10sCiAgICAgICAgb25TdGFydCA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEFhay5zZXRDb29raWUoJ2FkYmxvY2t3YXJuJywgMSk7CiAgICAgICAgICBBYWsuYWRkU3R5bGUoIiNlYXJBZHMgeyB3aWR0aDogNDAxcHg7IH0iKTsKICAgICAgICAgIEFhay5hZGRCYWl0RWxlbWVudCgnZGl2I2VhckFkcycpOwogICAgICAgICAgQWFrLnV3Ll9fQVRfZGV0ZWN0ZWQgPSB0cnVlOwogICAgICAgIH0KICAgICAgfSwKICAgICAgXzNkc3RoZW1fZXMgOiB7CiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzP3E9M2RzdGhlbQogICAgICAgIGhvc3QgOiBbJzNkc3RoZW0uZXMnXSwKICAgICAgICBvblN0YXJ0IDogZnVuY3Rpb24gKCkgewogICAgICAgICAgLy9BYWsuYWRkU2NyaXB0KGZ1bmN0aW9uICgpIHt9KTsKICAgICAgICB9LAogICAgICAgIG9uQmVmb3JlU2NyaXB0IDogZnVuY3Rpb24gKCkgewogICAgICAgIC8qCiAgICAgICAgICByZXR1cm4gW3sKICAgICAgICAgICAgICBjb250YWlucyA6ICdtYWluLmpzJywKICAgICAgICAgICAgICBleHRlcm5hbCA6IHRydWUsCiAgICAgICAgICAgICAgb3ZlcnJpZGUgOiAnLy9wYXN0ZWJpbi5jb20vcmF3LzJ5R1JQaFJaJwogICAgICAgICAgICB9CiAgICAgICAgICBdOwogICAgICAgICovCiAgICAgICAgfQogICAgICB9LAogICAgICBfOG11c2VzX2NvbSA6IHsKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXM/cT04bXVzZXMKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9ncmVhc3lmb3JrLm9yZy9mb3J1bS9kaXNjdXNzaW9uLzg1MTUKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9ncmVhc3lmb3JrLm9yZy9lbi9mb3J1bS9kaXNjdXNzaW9uLzY0MDcKICAgICAgICAvLyBzb3VyY2U6IGh0dHA6Ly9wYXN0ZWJpbi5jb20vYk1ORHhlY3MKICAgICAgICBob3N0IDogWyc4bXVzZXMuY29tJ10sCiAgICAgICAgb25CZWZvcmVTY3JpcHQgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICByZXR1cm4gW3sKICAgICAgICAgICAgICBjb250YWlucyA6ICJ0eXBlb2YgZXhvIiwKICAgICAgICAgICAgICBleHRlcm5hbCA6IGZhbHNlLAogICAgICAgICAgICAgIHJlbW92ZSA6IHRydWUKICAgICAgICAgICAgfQogICAgICAgICAgXTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGhhcHB5dHJpcHNfY29tIDogewogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcz9xPWhhcHB5dHJpcHMKICAgICAgICAvLyBzb3VyY2U6IGh0dHA6Ly9wYXN0ZWJpbi5jb20vRVdTRWJudnYKICAgICAgICBob3N0IDogWydoYXBweXRyaXBzLmNvbSddLAogICAgICAgIG9uU3RhcnQgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBBYWsuc2V0UmVhZE9ubHkoJ2NhblJ1bicsIHRydWUpOwogICAgICAgIH0KICAgICAgfSwKICAgICAgbGdfZmlybXdhcmVfcm9tX2NvbSA6IHsKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXM/cT1sZy1maXJtd2FyZS1yb20uY29tCiAgICAgICAgaG9zdCA6IFsnbGctZmlybXdhcmUtcm9tLmNvbSddLAogICAgICAgIG9uU3RhcnQgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBBYWsuc2V0UmVhZE9ubHkoJ2tpbGxhZHMnLCB0cnVlKTsKICAgICAgICB9CiAgICAgIH0sICAgICAgCiAgICAgIG1pZF9kYXlfY29tIDogewogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcz9xPW1pZC1kYXkuY29tCiAgICAgICAgaG9zdCA6IFsnbWlkLWRheS5jb20nXSwKICAgICAgICBvblN0YXJ0IDogZnVuY3Rpb24gKCkgewogICAgICAgICAgQWFrLnNldFJlYWRPbmx5KCdjYW5SdW4nLCB0cnVlKTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGJhZHR2X25ldHdvcmsgOiB7CiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzP3E9YmFkdHYuaXQKICAgICAgICBob3N0IDogWydiYWR0di5pdCcsICdiYWR0YXN0ZS5pdCcsICdiYWRnYW1lcy5pdCcsICdiYWRjb21pY3MuaXQnXSwKICAgICAgICBvblN0YXJ0IDogZnVuY3Rpb24gKCkgewogICAgICAgICAgQWFrLnNldENvb2tpZSgnYWRCbG9ja0NoZWNrZWQnLCAnZGlzYXR0aXZvJyk7CiAgICAgICAgfQogICAgICB9LAogICAgICBpbmRlcGVuZGVudF9jb191ayA6IHsKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXM/cT1pbmRlcGVuZGVudC5jby51awogICAgICAgIGhvc3QgOiBbJ2luZGVwZW5kZW50LmNvLnVrJ10sCiAgICAgICAgb25TdGFydCA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEFhay5zZXRDb29raWUoJ2FkYmxvY2tfZGV0ZWN0ZWQnLCAnaWdub3JlZCcpOwogICAgICAgIH0KICAgICAgfSwKICAgICAgZXNtYXNfY29tIDogewogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcz9xPWVzbWFzLmNvbQogICAgICAgIGhvc3QgOiBbJ2VzbWFzLmNvbSddLAogICAgICAgIG9uU3RhcnQgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBBYWsuc2V0UmVhZE9ubHkoJ29wZW5lZF9hZGJibG9jaycsIGZhbHNlKTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIHBpbm95MXR2X25ldHdvcmsgOiB7CiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzP3E9cGlub3kxdHYKICAgICAgICBob3N0IDogWydwaW5veTF0di4nXSwKICAgICAgICBvblN0YXJ0IDogZnVuY3Rpb24gKCkgewogICAgICAgICAgQWFrLnNldFJlYWRPbmx5KCdhbGxvd2FkcycsIDEpOwogICAgICAgIH0KICAgICAgfSwKICAgICAgZXdhbGxzdHJlZXRlcl9jb20gOiB7CiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzP3E9ZXdhbGxzdHJlZXRlci5jb20KICAgICAgICBob3N0IDogWydld2FsbHN0cmVldGVyLmNvbSddLAogICAgICAgIG9uU3RhcnQgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBBYWsuc2V0UmVhZE9ubHkoJ09BU19yZGwnLCAxKTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGJ1c2luZXNzX3N0YW5kYXJkX2NvbSA6IHsKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXM/cT1idXNpbmVzcy1zdGFuZGFyZC5jb20KICAgICAgICBob3N0IDogWydidXNpbmVzcy1zdGFuZGFyZC5jb20nXSwKICAgICAgICBvblN0YXJ0IDogZnVuY3Rpb24gKCkgewogICAgICAgICAgQWFrLnNldFJlYWRPbmx5KCdhZHNMb2FkZWQnLCAxKTsKICAgICAgICAgIEFhay5zZXRDb29raWUoJ19wdycsICd0Jyk7ICAgICAgICAgIAogICAgICAgIH0KICAgICAgfSwKICAgICAgZXhwcmVzc19uZXR3b3JrIDogewogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcz9xPWZpbmFuY2lhbGV4cHJlc3MuY29tCiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzP3E9aW5kaWFuZXhwcmVzcy5jb20KICAgICAgICBob3N0IDogWydmaW5hbmNpYWxleHByZXNzLmNvbScsICdpbmRpYW5leHByZXNzLmNvbSddLAogICAgICAgIG9uU3RhcnQgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBBYWsuc2V0UmVhZE9ubHkoJ1J1bkFkcycsIDEpOwogICAgICAgIH0KICAgICAgfSwKICAgICAgaW5kaWF0aW1lc19jb20gOiB7CiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzP3E9aW5kaWF0aW1lcwogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcz9xPW1hbGF5YWxhbS5zYW1heWFtLmNvbQogICAgICAgIC8vIHRlc3Q6IGh0dHA6Ly90aW55dXJsLmNvbS96eHVzdnlmLCAKICAgICAgICBob3N0IDogWydpbmRpYXRpbWVzLmNvbScsICdzYW1heWFtLmNvbScsICdiYW5nYWxvcmVtaXJyb3IuY29tJ10sCiAgICAgICAgb25CZWZvcmVTY3JpcHQgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICByZXR1cm4gW3sKICAgICAgICAgICAgICBjb250YWlucyA6ICdcXFxceDYxXFxcXHg2NFxcXFx4NjInLAogICAgICAgICAgICAgIGV4dGVybmFsIDogZmFsc2UsCiAgICAgICAgICAgICAgcmVtb3ZlIDogdHJ1ZQogICAgICAgICAgICB9LCB7CiAgICAgICAgICAgICAgY29udGFpbnMgOiAnZnVuY3Rpb24gaW5pdEJsb2NrJywKICAgICAgICAgICAgICBleHRlcm5hbCA6IGZhbHNlLAogICAgICAgICAgICAgIHJlbW92ZSA6IHRydWUKICAgICAgICAgICAgfQogICAgICAgICAgXTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIHRoZWNoaXZlX2NvbSA6IHsKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXMvMTQ1MwogICAgICAgIC8vIHNvdXJjZTogaHR0cDovL3Bhc3RlYmluLmNvbS9UZHBQeXJiYgogICAgICAgIGhvc3QgOiBbJ3RoZWNoaXZlLmNvbSddLAogICAgICAgIG9uU3RhcnQgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBBYWsuYWRkU2NyaXB0KGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnRpZXMod2luZG93LCB7CiAgICAgICAgICAgICAgc3RlcGhhbmVEZXRlY3RvciA6IHsKICAgICAgICAgICAgICAgIHZhbHVlIDogewogICAgICAgICAgICAgICAgICBob29rIDogZnVuY3Rpb24gKGNiKSB7CiAgICAgICAgICAgICAgICAgICAgY2IoZmFsc2UpOwogICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICBpbml0IDogZnVuY3Rpb24gKCkge30sCiAgICAgICAgICAgICAgICAgIGJyb2FkY2FzdFJlc3VsdCA6IGZ1bmN0aW9uICgpIHt9CiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgd3JpdGFibGUgOiBmYWxzZQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIHJpY2hvbnJhaWxzX2NvbSA6IHsKICAgICAgICAvLyBieTogR2l3YXl1bWUKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXMvMTQ0NwogICAgICAgIC8vIHNvdXJjZTogaHR0cDovL3Bhc3RlYmluLmNvbS9Fd2Z3ZzhCRwogICAgICAgIGhvc3QgOiBbJ3JpY2hvbnJhaWxzLmNvbSddLAogICAgICAgIG9uSWRsZSA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEFhay5hZGRTY3JpcHQoZnVuY3Rpb24gKCkgewogICAgICAgICAgICB2YXIgYWRzQnlHb29nbGVIdG1sID0gJyI8aW5zK2lkPSJhc3dpZnRfMF9leHBhbmQiK3N0eWxlPSJkaXNwbGF5OmlubGluZS10YWJsZTtib3JkZXI6bm9uZTtoZWlnaHQ6OTBweDttYXJnaW46MDtwYWRkaW5nOjA7cG9zaXRpb246cmVsYXRpdmU7dmlzaWJpbGl0eTp2aXNpYmxlO3dpZHRoOjc1MHB4O2JhY2tncm91bmQtY29sb3I6dHJhbnNwYXJlbnQiPjxpbnMraWQ9ImFzd2lmdF8wX2FuY2hvciIrc3R5bGU9ImRpc3BsYXk6YmxvY2s7Ym9yZGVyOm5vbmU7aGVpZ2h0OjkwcHg7bWFyZ2luOjA7cGFkZGluZzowO3Bvc2l0aW9uOnJlbGF0aXZlO3Zpc2liaWxpdHk6dmlzaWJsZTt3aWR0aDo3NTBweDtiYWNrZ3JvdW5kLWNvbG9yOnRyYW5zcGFyZW50Ij48aWZyYW1lK21hcmdpbndpZHRoPSIwIittYXJnaW5oZWlnaHQ9IjAiK3ZzcGFjZT0iMCIraHNwYWNlPSIwIithbGxvd3RyYW5zcGFyZW5jeT0idHJ1ZSIrc2Nyb2xsaW5nPSJubyIrYWxsb3dmdWxsc2NyZWVuPSJ0cnVlIitvbmxvYWQ9InZhcitpPXRoaXMuaWQscz13aW5kb3cuZ29vZ2xlX2lmcmFtZV9vbmNvcHksSD1zJmFtcDsmYW1wO3MuaGFuZGxlcnMsaD1IJmFtcDsmYW1wO0hbaV0sdz10aGlzLmNvbnRlbnRXaW5kb3csZDt0cnl7ZD13LmRvY3VtZW50fWNhdGNoKGUpe31pZihoJmFtcDsmYW1wO2QmYW1wOyZhbXA7KCFkLmJvZHl8fCFkLmJvZHkuZmlyc3RDaGlsZCkpe2lmKGguY2FsbCl7c2V0VGltZW91dChoLDApfWVsc2UraWYoaC5tYXRjaCl7dHJ5e2g9cy51cGQoaCxpKX1jYXRjaChlKXt9dy5sb2NhdGlvbi5yZXBsYWNlKGgpfX0iK2lkPSJhc3dpZnRfMCIrbmFtZT0iYXN3aWZ0XzAiK3N0eWxlPSJsZWZ0OjA7cG9zaXRpb246YWJzb2x1dGU7dG9wOjA7Iit3aWR0aD0iNzUwIitmcmFtZWJvcmRlcj0iMCIraGVpZ2h0PSI5MCI+PC9pZnJhbWU+PC9pbnM+PC9pbnM+Iic7CiAgICAgICAgICAgICQuYWpheCh7CiAgICAgICAgICAgICAgdXJsIDogJCgiLmFydGljbGUtY29udGVudCIpLmRhdGEoInVybCIpLAogICAgICAgICAgICAgIGRhdGFUeXBlIDogInNjcmlwdCIsCiAgICAgICAgICAgICAgbWV0aG9kIDogInBvc3QiLAogICAgICAgICAgICAgIGRhdGEgOiB7CiAgICAgICAgICAgICAgICBodG1sIDogYWRzQnlHb29nbGVIdG1sCiAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICBzdWNjZXNzIDogZnVuY3Rpb24gKHJlc3VsdCkgewogICAgICAgICAgICAgICAgdmFyIGV4ZWMgPSByZXN1bHQucmVwbGFjZSgiJCgnLmFydGljbGUtY29udGVudCcpIiwgIiQoJy5hcnRpY2xlLWNvbnRlbnQtMicpIik7CiAgICAgICAgICAgICAgICBuZXcgRnVuY3Rpb24oZXhlYykoKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICAkKCIuYXJ0aWNsZS1jb250ZW50IikuYWZ0ZXIoJzxkaXYgY2xhc3M9ImFydGljbGUtY29udGVudC0yIj48L2Rpdj4nKS5yZW1vdmUoKTsKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfSwKICAgICAgcm1wcmVwdXNiX2NvbSA6IHsKICAgICAgICBob3N0IDogWydybXByZXB1c2IuY29tJ10sCiAgICAgICAgb25TdGFydCA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEFhay5zZXRDb29raWUoJ2pvdF92aWV3ZXInLCAzKTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIG5lb2RyaXZlX2NvIDogewogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcy8xMDAxCiAgICAgICAgaG9zdCA6IFsnbmVvZHJpdmUuY28nXSwKICAgICAgICBvbkFsd2F5cyA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIC8vIFByZXZlbnQgcG9wdW5kZXIKICAgICAgICAgIEFhay5zZXRDb29raWUoJ0tpZlBvcENudCcsIDEsIG51bGwsICcvZW1iZWQvJyk7CiAgICAgICAgfQogICAgICB9LAogICAgICBoZW50YWloYXZlbl9vcmcgOiB7CiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9nb3JoaWxsL3VCbG9jay9pc3N1ZXMvMTM0MAogICAgICAgIGhvc3QgOiBbJ2hlbnRhaWhhdmVuLm9yZyddLAogICAgICAgIG9uQWx3YXlzIDogZnVuY3Rpb24gKCkgewogICAgICAgICAgLy8gUHJldmVudCBwb3B1bmRlcgogICAgICAgICAgQWFrLnNldENvb2tpZSgnaGhfcHBuZHIxJywgMSk7CiAgICAgICAgICBBYWsuc2V0Q29va2llKCdoaF9wcG5kcjInLCAxKTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIHByaW1lc2hhcmVfdHYgOiB7CiAgICAgICAgaG9zdCA6IFsncHJpbWVzaGFyZS50diddLAogICAgICAgIG9uU3RhcnQgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBBYWsuYWRkQmFpdEVsZW1lbnQoJ2RpdiNhZGJsb2NrJyk7CiAgICAgICAgfQogICAgICB9LAogICAgICBkZWJyaWRuZXRfYW5kX2xpdmVkZWJyaWQgOiB7CiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzP3E9ZGVicmlkbmV0CiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzP3E9bGl2ZWRlYnJpZAogICAgICAgIGhvc3QgOiBbJ2RlYnJpZG5ldC5jb20nLCAnbGl2ZWRlYnJpZC5jb20nXSwKICAgICAgICBvblN0YXJ0IDogZnVuY3Rpb24gKCkgewogICAgICAgICAgQWFrLmFkZFN0eWxlKCIubXlUZXN0QWQyIHsgaGVpZ2h0OiA1cHg7IH0iKTsKICAgICAgICAgIEFhay5hZGRCYWl0RWxlbWVudCgnZGl2Lm15VGVzdEFkMicpOwogICAgICAgIH0KICAgICAgfSwKICAgICAgYmx1ZXNhdG9zaGlfY29tIDogewogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcy84NzMKICAgICAgICBob3N0IDogWydibHVlc2F0b3NoaS5jb20nXSwKICAgICAgICBvblN0YXJ0IDogZnVuY3Rpb24gKCkgewogICAgICAgICAgQWFrLmFkZFN0eWxlKCIjdGVzdCB7IGhlaWdodDogMjgwcHg7IH0iKTsKICAgICAgICAgIEFhay5hZGRCYWl0RWxlbWVudCgnZGl2I3Rlc3QnKTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIHJhemVyY3J5cHRfY29tIDogewogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcy84NzAKICAgICAgICBob3N0IDogWydyYXplcmNyeXB0LmNvbSddLAogICAgICAgIG9uU3RhcnQgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBBYWsuYWRkU3R5bGUoIiN0ZXN0IHsgaGVpZ2h0OiAyNTBweDsgfSIpOwogICAgICAgICAgQWFrLmFkZEJhaXRFbGVtZW50KCdkaXYjdGVzdCcpOwogICAgICAgIH0KICAgICAgfSwKICAgICAgc2F0b3NoaWVtcGlyZV9jb20gOiB7CiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzLzg3MgogICAgICAgIGhvc3QgOiBbJ3NhdG9zaGllbXBpcmUuY29tJ10sCiAgICAgICAgb25TdGFydCA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEFhay5hZGRTdHlsZSgiI3Rlc3QgeyBoZWlnaHQ6IDI1MHB4OyB9Iik7CiAgICAgICAgICBBYWsuYWRkQmFpdEVsZW1lbnQoJ2RpdiN0ZXN0Jyk7CiAgICAgICAgfQogICAgICB9LAogICAgICBvbmVhZGZhdWNldF9jb20gOiB7CiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzLzg3MQogICAgICAgIGhvc3QgOiBbJ29uZWFkZmF1Y2V0LmNvbSddLAogICAgICAgIG9uU3RhcnQgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBBYWsuYWRkU3R5bGUoIiN0ZXN0IHsgaGVpZ2h0OiAyNTBweDsgfSIpOwogICAgICAgICAgQWFrLmFkZEJhaXRFbGVtZW50KCdkaXYjdGVzdCcpOwogICAgICAgIH0KICAgICAgfSwKICAgICAgamthbmltZV9uZXQgOiB7CiAgICAgICAgaG9zdCA6IFsnamthbmltZS5uZXQnXSwKICAgICAgICAvLyBAQHx8amthbmltZS5uZXQvYXNzZXRzL2pzL2FkdmVydGlzZW1lbnQyLmpzCiAgICAgICAgb25TdGFydCA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEFhay5hZGRCYWl0RWxlbWVudCgnZGl2I3JlY28nKTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIF83MjBwbWt2X2NvbSA6IHsKICAgICAgICBob3N0IDogWyc3MjBwbWt2LmNvbSddLAogICAgICAgIG9uU3RhcnQgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBBYWsuYWRkQmFpdEVsZW1lbnQoJ2RpdiNhZHZlcnQnKTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIHBhaWR2ZXJ0c19jb20gOiB7CiAgICAgICAgaG9zdCA6IFsncGFpZHZlcnRzLmNvbSddLAogICAgICAgIG9uU3RhcnQgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBBYWsuYWRkQmFpdEVsZW1lbnQoJ2Rpdi5hZnNfYWRzJyk7CiAgICAgICAgfQogICAgICB9LAogICAgICBpdGFsaWF0dl9vcmcgOiB7CiAgICAgICAgaG9zdCA6IFsnaXRhbGlhdHYub3JnJ10sCiAgICAgICAgb25TdGFydCA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEFhay5hZGRCYWl0RWxlbWVudCgnZGl2I2ZhYjEzJyk7CiAgICAgICAgfQogICAgICB9LAogICAgICBjaHJpc3Ntb292ZV9jb20gOiB7CiAgICAgICAgaG9zdCA6IFsnY2hyaXNzbW9vdmUuY29tJ10sCiAgICAgICAgb25TdGFydCA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIC8vQWFrLmFkZEJhaXRFbGVtZW50KCdkaXYjYWRzZXJ2ZXInKTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGV2ZW50aHVic19jb20gOiB7CiAgICAgICAgaG9zdCA6IFsnZXZlbnRodWJzLmNvbSddLAogICAgICAgIG9uU3RhcnQgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBBYWsuYWRkQmFpdEVsZW1lbnQoJ2RpdiNibGFoeWJsYWNpMScpOwogICAgICAgIH0KICAgICAgfSwKICAgICAgc3VwZXJhbmltZXNfY29tIDogewogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcy8xMjk1CiAgICAgICAgLy8gc291cmNlOiBodHRwOi8vcGFzdGViaW4uY29tL0ZEUEFLalRRCiAgICAgICAgaG9zdCA6IFsnc3VwZXJhbmltZXMuY29tJ10sCiAgICAgICAgb25TdGFydCA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEFhay5hZGRCYWl0RWxlbWVudCgnZGl2I2Jhbm5lckxvamEnKTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGZvcnVtX3BhY19yb21fY29tIDogewogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcy8yNDMKICAgICAgICBob3N0IDogWydmb3J1bS5wYWMtcm9tLmNvbSddLAogICAgICAgIG9uU3RhcnQgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBBYWsuYWRkQmFpdEVsZW1lbnQoJ2Rpdi5iYW5uZXJfYWRzJyk7CiAgICAgICAgfQogICAgICB9LAogICAgICBsaXR2X3R2IDogewogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcy8xMjk5CiAgICAgICAgLy8gc291cmNlOiBodHRwOi8vcGFzdGViaW4uY29tL3pjZGR2VHVDCiAgICAgICAgaG9zdCA6IFsnbGl0di50diddLAogICAgICAgIG9uU3RhcnQgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBBYWsuYWRkQmFpdEVsZW1lbnQoJ2Rpdi5wbGF5ZXJfbWFzaycpOwogICAgICAgIH0KICAgICAgfSwKICAgICAgbGV2ZWxkb3duX2ZyIDogewogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcy81OTUKICAgICAgICBob3N0IDogWydsZXZlbGRvd24uZnInXSwKICAgICAgICBvblN0YXJ0IDogZnVuY3Rpb24gKCkgewogICAgICAgICAgQWFrLmFkZEJhaXRFbGVtZW50KCdkaXYjYWRibG9jaycpOwogICAgICAgICAgQWFrLmFkZEJhaXRFbGVtZW50KCdkaXYjYWRibG9ja3Rlc3QnKTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGdsb2Jlc2xvdF9jb20gOiB7CiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzLzkyNAogICAgICAgIGhvc3QgOiBbJ2dsb2Jlc2xvdC5jb20nXSwKICAgICAgICBvblN0YXJ0IDogZnVuY3Rpb24gKCkgewogICAgICAgICAgQWFrLmFkZEJhaXRFbGVtZW50KCdkaXYjYWRkJyk7CiAgICAgICAgICBBYWsuYWRkQmFpdEVsZW1lbnQoJ2RpdiNhZGQxJyk7CiAgICAgICAgfQogICAgICB9LAogICAgICBhbnRlbm5lc3BvcnRfY29tIDogewogICAgICAgIGhvc3QgOiBbJ2FudGVubmVzcG9ydC5jb20nLCAnc2VydmVyaGQuZXUnXSwKICAgICAgICBvbklkbGUgOiBmdW5jdGlvbiAoKSB7IC8vIGZvciBhbnRlbm5lc3BvcnQKICAgICAgICAgIC8vIFJlbW92ZSBQdWIKICAgICAgICAgIEFhay5yZW1vdmVFbGVtZW50KCIjcHViIC5wdWJjbG9zZSIpOwogICAgICAgICAgLy8gUmVkaXJlY3QgdG8gUGxheWVyCiAgICAgICAgICBBYWsuc2V0RWxlbWVudCgnI3B1YiAuZW1iZWQgaWZyYW1lJywgewogICAgICAgICAgICBzcmMgOiAnL2VtYmVkL2VtYmVkLnBocCcKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfSwKICAgICAgZGlzYWJsZUFsZXJ0Ym94IDogewogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dyZWFzeWZvcmsub3JnL2VuL2ZvcnVtL2Rpc2N1c3Npb24vODYxMQogICAgICAgIGhvc3QgOiBbJ2RyaXZlYXJhYmlhLmNvbScsICdwdXRsb2NrZXIuY29tJywgJ2RvYXRvb2xzaXRhLmFsdGVydmlzdGEub3JnJywgJ3NvY2tzaGFyZS5jb20nLCAnZnJlZS1tb3ZpZS1ob21lLmNvbScsICdwYy5vbmxpbmUxNDMuY29tJywgJ2tvb29yYS5jb20nLCAnc3RyM2FtdHYuY28ubnInLCAnc3RyM2FtdHYuYWx0ZXJ2aXN0YS5vcmcnLCAnc3RyM2FtLmFsdGVydmlzdGEub3JnJywgJ2ZpbGVjb20ubmV0JywgJ3BpcG9jYXMudHYnLCAnZ2VuZXJhdHVwcmVtaXVtLmJpeicsICdtZWdhLWRlYnJpZC5ldScsICdwcmVtaXVtc3QwcmUuYmxvZ3Nwb3QuY29tJywgJ2RsLXByb3RlY3QuY29tJywgJ25ld3NpbmxldmVscy5jb20nLCAndmlwcmFjaW5nLmJpeicsICdidXNpbmVzc3RvZGF5LmluJ10sCiAgICAgICAgb25BbHdheXMgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBBYWsudXcuYWxlcnQgPSBmdW5jdGlvbiAoKSB7fTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGdlbmVyYXR1cHJlbWl1bV9iaXogOiB7CiAgICAgICAgaG9zdCA6IFsnZ2VuZXJhdHVwcmVtaXVtLmJpeiddLAogICAgICAgIG9uU3RhcnQgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAvLyBEaXNhYmxlIENvbmZpcm0gQm94CiAgICAgICAgICAvL0Fhay51dy5jb25maXJtID0gZnVuY3Rpb24gKCl7fTsKICAgICAgICAgIEFhay5zZXRDb29raWUoJ2dlbmVyYScsIGZhbHNlKTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIG5ld3N0YXRlc21hbl9jb20gOiB7CiAgICAgICAgaG9zdCA6IFsnbmV3c3RhdGVzbWFuLmNvbSddLAogICAgICAgIG9uU3RhcnQgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBBYWsuc2V0Q29va2llKCdkb25hdGlvblBvcHVwJywgJ2hpZGUnKTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGFkc3dpenpfY29tIDogewogICAgICAgIC8vIGJ5OiBTa3I0dGNoR3IzYXp5TW9ua2lCYWxsbGxsbFp6enoKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXMvODA5CiAgICAgICAgaG9zdCA6IFsneWVzLmZtJ10sCiAgICAgICAgb25TdGFydCA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEFhay5hZGRTY3JpcHQoZnVuY3Rpb24gKCkgewogICAgICAgICAgICB3aW5kb3cuY29tX2Fkc3dpenpfc3luY2hyb19pbml0aWFsaXplID0gZnVuY3Rpb24gKCkge307CiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGRlcnN0YW5kYXJkX2F0IDogewogICAgICAgIC8vIGJ5OiBBbGV4YW5kZXIyNTUKICAgICAgICAvLyBwYXRjaDogaHR0cDovL3Bhc3RlYmluLmNvbS9yYXcucGhwP2k9cjdRNERyZkIKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXM/cT1kZXJzdGFuZGFyZAogICAgICAgIGhvc3QgOiBbJ2RlcnN0YW5kYXJkLmF0J10sCiAgICAgICAgb25TdGFydCA6IGZ1bmN0aW9uICgpIHsKCiAgICAgICAgICB2YXIgbWFrZUlTT1RpbWVzdGFtcFVUQyA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgdmFyIHBhZCA9IGZ1bmN0aW9uIChhbW91bnQsIHdpZHRoKSB7CiAgICAgICAgICAgICAgdmFyIHBhZGRpbmcgPSAiIjsKICAgICAgICAgICAgICB3aGlsZSAocGFkZGluZy5sZW5ndGggPCB3aWR0aCAtIDEgJiYgYW1vdW50IDwgTWF0aC5wb3coMTAsIHdpZHRoIC0gcGFkZGluZy5sZW5ndGggLSAxKSkgewogICAgICAgICAgICAgICAgcGFkZGluZyArPSAiMCI7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIHJldHVybiBwYWRkaW5nICsgYW1vdW50LnRvU3RyaW5nKCk7CiAgICAgICAgICAgIH07CgogICAgICAgICAgICB2YXIgZGF0ZSA9IG5ldyBEYXRlKCk7CiAgICAgICAgICAgIHJldHVybiBbcGFkKGRhdGUuZ2V0VVRDRnVsbFllYXIoKSwgNCksICItIiwKICAgICAgICAgICAgICBwYWQoZGF0ZS5nZXRVVENNb250aCgpICsgMSwgMiksICItIiwKICAgICAgICAgICAgICBwYWQoZGF0ZS5nZXRVVENEYXRlKCksIDIpLCAiVCIsCiAgICAgICAgICAgICAgcGFkKGRhdGUuZ2V0VVRDSG91cnMoKSwgMiksICI6IiwKICAgICAgICAgICAgICBwYWQoZGF0ZS5nZXRVVENNaW51dGVzKCksIDIpLCAiOiIsCiAgICAgICAgICAgICAgcGFkKGRhdGUuZ2V0VVRDU2Vjb25kcygpLCAyKV0uam9pbigpOwogICAgICAgICAgfTsKCiAgICAgICAgICBkb2N1bWVudC5jb29raWUuc3BsaXQoJzsgJykuZm9yRWFjaChmdW5jdGlvbiAoY29va2llKSB7CiAgICAgICAgICAgIC8vIEZpbmQgbWFpbiBzdG9yYWdlIGNvb2tpZQogICAgICAgICAgICBpZiAoY29va2llLnN1YnN0cigwLCA2KSA9PSAiTUdVSUQ9IikgewogICAgICAgICAgICAgIC8vIERlY29tcG9zZSBpbmZvcm1hdGlvbiBmcm9tIG1haW4gc3RvcmFnZSBjb29raWUKICAgICAgICAgICAgICB2YXIgdmFsdWVzID0ge307CiAgICAgICAgICAgICAgY29va2llLnN1YnN0cig2KS5zcGxpdCgiJiIpLmZvckVhY2goZnVuY3Rpb24gKGFzc2lnbm1lbnQpIHsKICAgICAgICAgICAgICAgIHZhciBwb3MgPSBhc3NpZ25tZW50LmluZGV4T2YoJz0nKTsKICAgICAgICAgICAgICAgIGlmIChwb3MgPiAtMSkgewogICAgICAgICAgICAgICAgICB2YWx1ZXNbYXNzaWdubWVudC5zdWJzdHIoMCwgcG9zKV0gPSBhc3NpZ25tZW50LnN1YnN0cihwb3MgKyAxKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgLy8gVXBkYXRlICJmaXJzdCB2aWV3ZWQiIHRpbWVzdGFtcAogICAgICAgICAgICAgIHZhbHVlcy5UaW1lc3RhbXAgPSBtYWtlSVNPVGltZXN0YW1wVVRDKCk7CgogICAgICAgICAgICAgIC8vIFJlY29tcG9zZSBpbmZvcm1hdGlvbiBpbiBtYWluIHN0b3JhZ2UgY29va2llCiAgICAgICAgICAgICAgY29va2llID0gIk1HVUlEPSI7CiAgICAgICAgICAgICAgZm9yICh2YXIga2V5IGluIHZhbHVlcykgewogICAgICAgICAgICAgICAgaWYgKHZhbHVlcy5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7CiAgICAgICAgICAgICAgICAgIGNvb2tpZSArPSBrZXkgKyAiPSIgKyB2YWx1ZXNba2V5XSArICImIjsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgY29va2llID0gY29va2llLnN1YnN0cigwLCAoY29va2llLmxlbmd0aCAtIDEpKTsKCiAgICAgICAgICAgICAgLy8gVXBkYXRlIGNvb2tpZQogICAgICAgICAgICAgIGRvY3VtZW50LmNvb2tpZSA9IGNvb2tpZTsKICAgICAgICAgICAgfQogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9LAogICAgICB0ZWtfZG9tYWlucyA6IHsKICAgICAgICAvLyBieTogUmVlaywgQWxleGFuZGVyMjU1CiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzLzc4OAogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcy81MTIKICAgICAgICBob3N0IDogWyd0ZWsubm8nLCAnZ2FtZXIubm8nLCAndGVrbm9maWwubm8nLCAnaW5zaWRldGVsZWNvbS5ubycsICdwcmlzZ3VpZGUubm8nLCAnZGlza3Vzam9uLm5vJywgJ3Rla25vam9iYi5ubycsICdha2FtLm5vJywgJ2hhcmR3YXJlLm5vJywgJ2Ftb2JpbC5ubyddLAogICAgICAgIG9uSWRsZSA6IGZ1bmN0aW9uICgpIHsKCiAgICAgICAgICAvKgogICAgICAgICAgdmFyIGFkX2ZyYW1lID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiaWZyYW1lIik7CiAgICAgICAgICBhZF9mcmFtZS5uYW1lID0gIl9mcmFtZSI7CiAgICAgICAgICBhZF9mcmFtZS5zdHlsZS5kaXNwbGF5ID0gIm5vbmUiOwogICAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChhZF9mcmFtZSk7CiAgICAgICAgICBhZF9mcmFtZS5jb250ZW50V2luZG93LndyYXBwZWRKU09iamVjdC5pbkZJRiA9IHRydWU7CiAgICAgICAgICAgKi8KCiAgICAgICAgICAvLyBmaXggMjcuMTEuMjAxNQogICAgICAgICAgQWFrLmNyZWF0ZUVsZW1lbnQoewogICAgICAgICAgICB0YWcgOiAnZGl2JywKICAgICAgICAgICAgaWQgOiAnZ29vZ2xlX2Fkc19pZnJhbWVfJywKICAgICAgICAgICAgaHRtbCA6ICc8cD48L3A+JywKICAgICAgICAgICAgYXBwZW5kIDogJ2JvZHknCiAgICAgICAgICB9KTsKCiAgICAgICAgfQogICAgICB9LAogICAgICBwbGFuZXRhdHZvbmxpbmVoZF9uZXR3b3JrIDogewogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcy8xNDY3CiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzLzE1OQogICAgICAgIGhvc3QgOiBbJ3BsYW5ldGF0dm9ubGluZWhkLmJsb2dzcG90LicsICdwbGFuZXRhdHZvbmxpbmVoZC5jb20nXSwKICAgICAgICBvblN0YXJ0IDogZnVuY3Rpb24gKCkgewogICAgICAgICAgQWFrLmFkZFN0eWxlKCcuYWRzYW50aWxvayB7IGhlaWdodDogMXB4OyB9Jyk7CiAgICAgICAgICAvL0Fhay51dy5qUUFudGlBZHNCbG9jayA9IGZ1bmN0aW9uICgpe307IC8vIGRvbid0IHdvcmsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGJldGFfc3BlZWR0ZXN0X25ldCA6IHsKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXMvNjI4CiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzLzU2MgogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcy80ODQKICAgICAgICAvLyBzb3VyY2U6IGh0dHA6Ly9wYXN0ZTIub3JnLzUzeW1naFgxCiAgICAgICAgaG9zdCA6IFsnYmV0YS5zcGVlZHRlc3QubmV0J10sCiAgICAgICAgb25BbHdheXMgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBBYWsudXcuYWRzT29rbGFDb21SZWFjaGFibGUgPSB0cnVlOwogICAgICAgICAgQWFrLnV3LnNjcmlwdHNMb2FkZWQgPSBmdW5jdGlvbiAoKSB7fTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGJpbmJ1Y2tzX2NvbSA6IHsKICAgICAgICAvLyBieTogQWxleGFuZGVyMjU1CiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzLzU0NQogICAgICAgIGhvc3QgOiBbJ2JpbmJ1Y2tzLmNvbSddLAogICAgICAgIG9uSWRsZSA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEFhay51dy50ZXN0SnVpY3lQYXkgPSB0cnVlOwogICAgICAgICAgQWFrLnV3LnRlc3RTZW5zZVBheSA9IHRydWU7CiAgICAgICAgfQogICAgICB9LAogICAgICB3aGlza3lwcmljZXNfZG9tYWlucyA6IHsKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXMvMTI4NAogICAgICAgIC8vIHNvdXJjZTogaHR0cDovL3Bhc3RlYmluLmNvbS9FcHI1dFJFTAogICAgICAgIGhvc3QgOiBbJ3doaXNreXByaWp6ZW4uY29tJywgJ3doaXNreXByaWNlcy5jby51aycsICd3aGlza3lwcmVpc2UuY29tJywgJ3doaXNreXByaXguZnInXSwKICAgICAgICBvbkFsd2F5cyA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEFhay51dy5PQV9zaG93ID0gdHJ1ZTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIG5pY29ibG9nX29yZyA6IHsKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXMvMTE4NAogICAgICAgIC8vIHNvdXJjZTogaHR0cDovL3Bhc3RlYmluLmNvbS9NTkhwTHMyVgogICAgICAgIGhvc3QgOiBbJ25pY29ibG9nLm9yZyddLAogICAgICAgIG9uSWRsZSA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHZhciBlbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5zcmMnKTsKICAgICAgICAgIGVsLnJlbW92ZUF0dHJpYnV0ZSgnY2xhc3MnKTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGRpX3NlIDogewogICAgICAgIC8vIG5vdGU6IGFkZCB0aGlzIHJ1bGUgZm9yIGNocm9tZSB1c2VyCiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzLzEzMTkKICAgICAgICAvLyBzb3VyY2U6IGh0dHA6Ly9wYXN0ZWJpbi5jb20vOWJEUFF6TVgKICAgICAgICBob3N0IDogWydkaS5zZSddLAogICAgICAgIG9uSWRsZSA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEFhay5yZW1vdmVFbGVtZW50KCcjaGVhZGVyX292ZXJsYXknKTsKICAgICAgICAgIEFhay5yZW1vdmVFbGVtZW50KCcjbWVzc2FnZV9tb2RhbCcpOwogICAgICAgIH0KICAgICAgfSwKICAgICAgbWVnb2dvX25ldCA6IHsKICAgICAgICAvLyBpc3N1ZTogUE0KICAgICAgICAvLyBzb3VyY2UxOiBodHRwOi8vcGFzdGViaW4uY29tL2NjSFFnM2huCiAgICAgICAgLy8gc291cmNlMjogaHR0cDovL3Bhc3RlYmluLmNvbS9nazB2RVFITgogICAgICAgIC8vIG5vdGU6IHR3byBhZGJsb2NrIGNoZWNrCiAgICAgICAgaG9zdCA6IFsnbWVnb2dvLm5ldCddLAogICAgICAgIG9uU3RhcnQgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQWFrLnV3LCAiYWRCbG9jayIsIHsKICAgICAgICAgICAgZW51bWVyYWJsZSA6IHRydWUsCiAgICAgICAgICAgIHdyaXRhYmxlIDogZmFsc2UsCiAgICAgICAgICAgIHZhbHVlIDogZmFsc2UKICAgICAgICAgIH0pOwogICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEFhay51dywgInNob3dBZEJsb2NrTWVzc2FnZSIsIHsKICAgICAgICAgICAgZW51bWVyYWJsZSA6IHRydWUsCiAgICAgICAgICAgIHdyaXRhYmxlIDogZmFsc2UsCiAgICAgICAgICAgIHZhbHVlIDogZnVuY3Rpb24gKCkge30KICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfSwKICAgICAgbGliZXJ0YWRkaWdpdGFsX2NvbSA6IHsKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXMvMTY0MgogICAgICAgIC8vIHNvdXJjZTogaHR0cDovL3Bhc3RlYmluLmNvbS82RnpwMHZyRQogICAgICAgIGhvc3QgOiBbJ2xpYmVydGFkZGlnaXRhbC5jb20nXSwKICAgICAgICBvblN0YXJ0IDogZnVuY3Rpb24gKCkgewogICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEFhay51dywgImFkX2FscmVhZHlfcGxheWVkIiwgewogICAgICAgICAgICBlbnVtZXJhYmxlIDogdHJ1ZSwKICAgICAgICAgICAgd3JpdGFibGUgOiBmYWxzZSwKICAgICAgICAgICAgdmFsdWUgOiB0cnVlCiAgICAgICAgICB9KTsKICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShBYWsudXcsICJwdWVkZU1vc3RyYXJBZHMiLCB7CiAgICAgICAgICAgIGVudW1lcmFibGUgOiB0cnVlLAogICAgICAgICAgICB3cml0YWJsZSA6IGZhbHNlLAogICAgICAgICAgICB2YWx1ZSA6IHRydWUKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfSwgICAgIAogICAgICBmb2xoYV91b2xfY29tX2JyIDogewogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcy8xMzk2CiAgICAgICAgLy8gc291cmNlOiBmKCAoIHR5cGVvZiBwYXl3YWxsX2FjY2VzcyA9PSAidW5kZWZpbmVkIiB8fCBwYXl3YWxsX2FjY2VzcyAhPSB0cnVlICkgJiYgKCB0eXBlb2YgZm9saGFfYWRzID09ICJ1bmRlZmluZWQiIHx8IGZvbGhhX2FkcyAhPSB0cnVlICkgKSB7CiAgICAgICAgaG9zdCA6IFsnZm9saGEudW9sLmNvbS5iciddLAogICAgICAgIG9uU3RhcnQgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQWFrLnV3LCAicGF5d2FsbF9hY2Nlc3MiLCB7CiAgICAgICAgICAgIGVudW1lcmFibGUgOiB0cnVlLAogICAgICAgICAgICB3cml0YWJsZSA6IGZhbHNlLAogICAgICAgICAgICB2YWx1ZSA6IHRydWUKICAgICAgICAgIH0pOwogICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEFhay51dywgImZvbGhhX2FkcyIsIHsKICAgICAgICAgICAgZW51bWVyYWJsZSA6IHRydWUsCiAgICAgICAgICAgIHdyaXRhYmxlIDogZmFsc2UsCiAgICAgICAgICAgIHZhbHVlIDogdHJ1ZQogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9LAogICAgICBnYW1lcl9jb21fdHcgOiB7CiAgICAgICAgLy8gYnk6IG1taXMxMDAwCiAgICAgICAgLy8gdXNlcnNjcmlwdDogaHR0cHM6Ly9ncmVhc3lmb3JrLm9yZy9lbi9zY3JpcHRzLzE2NTI1CiAgICAgICAgLy8gaXNzdWU6IDogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXMvOTc1CiAgICAgICAgaG9zdCA6IFsnZ2FtZXIuY29tLnR3J10sCiAgICAgICAgb25TdGFydCA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShBYWsudXcsICdBbnRpQWQnLCB7CiAgICAgICAgICAgIGVudW1lcmFibGUgOiB0cnVlLAogICAgICAgICAgICB3cml0YWJsZSA6IGZhbHNlLAogICAgICAgICAgICB2YWx1ZSA6IG51bGwKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfSwKICAgICAgYXJtb3JnYW1lc19jb20gOiB7CiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzLzg0NQogICAgICAgIGhvc3QgOiBbJ2FybW9yZ2FtZXMuY29tJ10sCiAgICAgICAgb25TdGFydCA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShBYWsudXcsICdnYV9kZXRlY3QnLCB7CiAgICAgICAgICAgIGVudW1lcmFibGUgOiB0cnVlLAogICAgICAgICAgICB3cml0YWJsZSA6IGZhbHNlLAogICAgICAgICAgICB2YWx1ZSA6IG51bGwKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfSwKICAgICAgbWFuZ2Fob3N0X2NvbSA6IHsKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXMvOTU3CiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzLzU1OAogICAgICAgIC8vIHNvdXJjZTogaHR0cDovL3Bhc3RlYmluLmNvbS9HcnBiSkVOQQogICAgICAgIGhvc3QgOiBbJ21hbmdhaG9zdC5jb20nXSwKICAgICAgICBvblN0YXJ0IDogZnVuY3Rpb24gKCkgewogICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEFhay51dywgInRlc3REaXNwbGF5IiwgewogICAgICAgICAgICBlbnVtZXJhYmxlIDogdHJ1ZSwKICAgICAgICAgICAgd3JpdGFibGUgOiBmYWxzZSwKICAgICAgICAgICAgdmFsdWUgOiBmYWxzZQogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9LAogICAgICB2aWRlb3dvb2RfdHYgOiB7CiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzLzEzMzkKICAgICAgICAvLyBzb3VyY2U6IGh0dHA6Ly92aWRlb3dvb2QudHYvYnVpbGQvYXNzZXRzL2pzL3BlbWJlZC05N2E2NDBmNjI1LmpzCiAgICAgICAgaG9zdCA6IFsndmlkZW93b29kLnR2J10sCiAgICAgICAgb25TdGFydCA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEFhay51dy5vcGVuID0gZnVuY3Rpb24gKCkge307IC8vIHByZXZlbnQgcG9wdXAKICAgICAgICAgIEFhay51dy5jb25maWcgPSB7fTsKICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShBYWsudXcuY29uZmlnLCAiYWRiX3JlbWluZCIsIHsKICAgICAgICAgICAgZW51bWVyYWJsZSA6IHRydWUsCiAgICAgICAgICAgIHdyaXRhYmxlIDogZmFsc2UsCiAgICAgICAgICAgIHZhbHVlIDogZmFsc2UKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfSwKICAgICAgaW5mb2pvYnNfY29tX2JyIDogewogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcy8xMzM5CiAgICAgICAgLy8gc291cmNlOiBodHRwOi8vcGFzdGViaW4uY29tL0xQZzYwOTNVCiAgICAgICAgLy8gcmVkaXJlY3Q6IGh0dHA6Ly93d3cuaW5mb2pvYnMuY29tLmJyL25vcHVibGljaXR5LmFzcHgKICAgICAgICBob3N0IDogWydpbmZvam9icy5jb20uYnInXSwKICAgICAgICBvblN0YXJ0IDogZnVuY3Rpb24gKCkgewogICAgICAgICAgQWFrLmFkZFNjcmlwdChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIHZhciB3ZWJVSSA9IHdlYlVJIHx8IHt9OwogICAgICAgICAgICB3ZWJVSS5VdGlscyA9IHdlYlVJLlV0aWxzIHx8IHt9OwogICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkod2ViVUkuVXRpbHMsICJTdG9wQWRCbG9jayIsIHsKICAgICAgICAgICAgICBlbnVtZXJhYmxlIDogdHJ1ZSwKICAgICAgICAgICAgICB3cml0YWJsZSA6IGZhbHNlLAogICAgICAgICAgICAgIHZhbHVlIDogZnVuY3Rpb24gKCkge30KICAgICAgICAgICAgfSk7CiAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9LAogICAgICBjbG91ZHdlYmNvcHlfY29tIDogewogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcy83MTQKICAgICAgICBob3N0IDogWydjbG91ZHdlYmNvcHkuY29tJ10sCiAgICAgICAgb25TdGFydCA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHZhciBzZXRUaW1lb3V0Q2xvbmUgPSBBYWsudXcuc2V0VGltZW91dDsKICAgICAgICAgIEFhay51dy5zZXRUaW1lb3V0ID0gbnVsbDsKICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICAgICAgICBBYWsudXcuc2V0VGltZW91dCA9IHNldFRpbWVvdXRDbG9uZTsKICAgICAgICAgIH0sIDUwMDApOwogICAgICAgIH0KICAgICAgfSwKICAgICAgbmFya2l2ZV9jb20gOiB7CiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzLzU2OQogICAgICAgIGhvc3QgOiBbJ25hcmtpdmUuY29tJ10sCiAgICAgICAgb25BbHdheXMgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBBYWsudXcuYWRibG9ja19zdGF0dXMgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgIH07CiAgICAgICAgfQogICAgICB9LAogICAgICBwcmVnZW5fbmV0IDogewogICAgICAgIGhvc3QgOiBbJ3ByZWdlbi5uZXQnXSwKICAgICAgICBvblN0YXJ0IDogZnVuY3Rpb24gKCkgewogICAgICAgICAgLy8gc2tpcCBwYWdlIGluZm8KICAgICAgICAgIEFhay5zZXRDb29raWUoJ3BnbicsIDEpOwogICAgICAgIH0KICAgICAgfSwKICAgICAgcGh5c19vcmcgOiB7CiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzLzc2OAogICAgICAgIGhvc3QgOiBbJ3BoeXMub3JnJ10sCiAgICAgICAgb25BbHdheXMgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBBYWsudXcuY2hrQUIgPSBmdW5jdGlvbiAoKSB7fTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIG9udmFzb3J0aXJfY29tIDogewogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcz9xPW9udmFzb3J0aXIuY29tCiAgICAgICAgaG9zdCA6IFsnb252YXNvcnRpci5jb20nXSwKICAgICAgICBvbkFsd2F5cyA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIC8vICthYnAgcnVsZSBhbHQgc29sdXRpb24KICAgICAgICAgIEFhay51dy5KZUJsb3F1ZSA9IGZ1bmN0aW9uICgpIHt9OwogICAgICAgIH0KICAgICAgfSwKICAgICAgZnVsbGhkemV2a2lfY29tIDogewogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcz9xPWZ1bGxoZHpldmtpLmNvbQogICAgICAgIGhvc3QgOiBbJ2Z1bGxoZHpldmtpLmNvbSddLAogICAgICAgIG9uQWx3YXlzIDogZnVuY3Rpb24gKCkgewogICAgICAgICAgLy8gK2FicCBydWxlIGFsdCBzb2x1dGlvbgogICAgICAgICAgQWFrLnV3LmNoZWNrID0gZnVuY3Rpb24gKCkge307CiAgICAgICAgfQogICAgICB9LAogICAgICB2aWxsZV9pZGVhbGVfY29tIDogewogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcy8yNTgKICAgICAgICAvLyBzb3VyY2U6IGh0dHA6Ly9wYXN0ZWJpbi5jb20vMTZtbm1lTWMKICAgICAgICBob3N0IDogWyd2aWxsZS1pZGVhbGUuY29tJ10sCiAgICAgICAgb25BbHdheXMgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAvLyArYWJwIHJ1bGUgYWx0IHNvbHV0aW9uCiAgICAgICAgICBBYWsudXcuZXhlY3NwID0gZnVuY3Rpb24gKCkge307CiAgICAgICAgfQogICAgICB9LAogICAgICBub3RyZV9wbGFuZXRlX2luZm8gOiB7CiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzLzI1OAogICAgICAgIC8vIHNvdXJjZTogaHR0cDovL3Bhc3RlYmluLmNvbS9xclM2UUdHRQogICAgICAgIGhvc3QgOiBbJ25vdHJlLXBsYW5ldGUuaW5mbyddLAogICAgICAgIG9uQWx3YXlzIDogZnVuY3Rpb24gKCkgewogICAgICAgICAgLy8gK2FicCBydWxlIGFsdCBzb2x1dGlvbgogICAgICAgICAgQWFrLnV3LnB1YnBvcCA9IGZ1bmN0aW9uICgpIHt9OwogICAgICAgIH0KICAgICAgfSwKICAgICAgYXBrbWlycm9yX2NvbSA6IHsKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXMvMzc4CiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzLzIyNAogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcy83OAogICAgICAgIGhvc3QgOiBbJ2Fwa21pcnJvci5jb20nXSwKICAgICAgICBvbkFsd2F5cyA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEFhay51dy5kb0NoZWNrID0gZnVuY3Rpb24gKCkge307CiAgICAgICAgfQogICAgICB9LAogICAgICBtdGxibG9nX2NvbSA6IHsKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXMvOTQ4CiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ3JlYXN5Zm9yay5vcmcvZm9ydW0vZGlzY3Vzc2lvbi83NzUzCiAgICAgICAgLy8gc291cmNlOiBodHRwOi8vcGFzdGViaW4uY29tL0JGckRQTTZiCiAgICAgICAgaG9zdCA6IFsnbXRsYmxvZy5jb20nXSwKICAgICAgICBvblN0YXJ0IDogZnVuY3Rpb24gKCkgewogICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEFhay51dywgJ3B1YWJzJywgewogICAgICAgICAgICBlbnVtZXJhYmxlIDogdHJ1ZSwKICAgICAgICAgICAgdmFsdWUgOiBmdW5jdGlvbiAoKSB7fQogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9LAogICAgICBhbml6bV9jb20gOiB7CiAgICAgICAgLy8gaXNzdWU6CiAgICAgICAgaG9zdCA6IFsnYW5pem0uY29tJ10sCiAgICAgICAgb25BbHdheXMgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBBYWsudXcuc3RvcEFkQmxvY2sgPSB7fTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGRpYXJpb2luZm9ybWFjaW9uX2NvbSA6IHsKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXMvMTU1MAogICAgICAgIGhvc3QgOiBbJ2RpYXJpb2luZm9ybWFjaW9uLmNvbSddLAogICAgICAgIG9uU3RhcnQgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQWFrLnV3LCAncHJfb2t2YWxpZGEnLCB7CiAgICAgICAgICAgIGVudW1lcmFibGUgOiB0cnVlLAogICAgICAgICAgICB2YWx1ZSA6IHRydWUKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfSwKICAgICAgY25iZXRhX2NvbSA6IHsKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXMvMTMwMQogICAgICAgIC8vIHNvdXJjZTogaHR0cDovL3Bhc3RlYmluLmNvbS92WE5DenR3eAogICAgICAgIGhvc3QgOiBbJ2NuYmV0YS5jb20nXSwKICAgICAgICBvblN0YXJ0IDogZnVuY3Rpb24gKCkgewogICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEFhay51dywgJ0pCJywgewogICAgICAgICAgICBlbnVtZXJhYmxlIDogdHJ1ZSwKICAgICAgICAgICAgdmFsdWUgOiBmdW5jdGlvbiAoKSB7fQogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9LAogICAgICB0aGVtYXJrZXJfaGFhcmV0eiA6IHsKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXMvMTI5MgogICAgICAgIC8vIHNvdXJjZTogaHR0cDovL3Bhc3RlYmluLmNvbS9tMDhka0RUNAogICAgICAgIGhvc3QgOiBbJ3RoZW1hcmtlci5jb20nLCAnaGFhcmV0ei5jby5pbCddLAogICAgICAgIG9uU3RhcnQgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQWFrLnV3LCAnQWRCbG9ja1V0aWwnLCB7CiAgICAgICAgICAgIGVudW1lcmFibGUgOiB0cnVlLAogICAgICAgICAgICB2YWx1ZSA6IHt9CiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIHBpcG9jYXNfdHYgOiB7CiAgICAgICAgLy8gaXNzdWU6CiAgICAgICAgaG9zdCA6IFsncGlwb2Nhcy50diddLAogICAgICAgIG9uU3RhcnQgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAvLyBBbHNvIGFkZGVkIGluIGRpc2FibGVBbGVydGJveAogICAgICAgICAgLy8gTm8gcG9wdXAKICAgICAgICAgIEFhay5zZXRDb29raWUoJ3BvcHVwX3VzZXJfbG9naW4nLCAneWVzJyk7CiAgICAgICAgfQogICAgICB9LAogICAgICBfMTVtaW5fbHQgOiB7CiAgICAgICAgLy8gbm90ZTogcmVndWxhcnkgdXBkYXRlIHNjcmlwdAogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcz9xPTE1bWluLml0CiAgICAgICAgLy8gc291cmNlOiBodHRwOi8vcGFzdGViaW4uY29tL1lXZjNIVHFyCiAgICAgICAgLy8gdGVzdDogaHR0cDovL3Rpbnl1cmwuY29tL2g2YzQzMzYKICAgICAgICBob3N0IDogWycxNW1pbi5sdCddLAogICAgICAgIG9uU3RhcnQgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQWFrLnV3LCAnUk9VVEUnLCB7CiAgICAgICAgICAgIGVudW1lcmFibGUgOiB0cnVlLAogICAgICAgICAgICB3cml0YWJsZSA6IGZhbHNlLAogICAgICAgICAgICB2YWx1ZSA6ICdfYmVfcmVrbGFtb3MnCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIHNjMmNhc3RzX2NvbSA6IHsKICAgICAgICAvLyBieTogR2l3YXl1bWUKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXMvMTU5OQogICAgICAgIGhvc3QgOiBbJ3NjMmNhc3RzLmNvbSddLAogICAgICAgIG9uU3RhcnQgOiBmdW5jdGlvbigpIHsKICAgICAgICAgIEFhay5hZGRTY3JpcHQoZnVuY3Rpb24oKSB7CiAgICAgICAgICAgIHdpbmRvdy5fZ2FxID0geyBwdXNoOmZ1bmN0aW9uKCkge30gfTsKICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHdpbmRvdywgInNob3dkaWFsb2ciLCB7CiAgICAgICAgICAgICAgdmFsdWU6IGZ1bmN0aW9uKCkge30sCiAgICAgICAgICAgICAgY29uZmlndXJhYmxlOiBmYWxzZSwKICAgICAgICAgICAgICB3cml0YWJsZTogZmFsc2UKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh3aW5kb3csICJzaG93UG9wdXAyIiwgewogICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbigpIHt9LAogICAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogZmFsc2UsCiAgICAgICAgICAgICAgd3JpdGFibGU6IGZhbHNlCiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9LAogICAgICB2Z3VuZXR3b3JrX2NvbSA6IHsKICAgICAgICAvLyBpc3N1ZToKICAgICAgICBob3N0IDogWyd2Z3VuZXR3b3JrLmNvbSddLAogICAgICAgIG9uSWRsZSA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEFhay5zZXRDb29raWUoJ3N0b3BJdCcsIDEpOwogICAgICAgICAgdmFyIGNsb3NlID0gQWFrLmdldEVsZW1lbnQoJyNzb21lX2FkX2Jsb2NrX2tleV9jbG9zZScpOwogICAgICAgICAgaWYgKGNsb3NlKSB7CiAgICAgICAgICAgIGNsb3NlLmNsaWNrKCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9LAogICAgICBsaW5rY3J5cHRfd3MgOiB7CiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzLzI4NgogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL3B1bGwvNjcKICAgICAgICBob3N0IDogWydsaW5rY3J5cHQud3MnXSwKICAgICAgICBvbklkbGUgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBBYWsuc2V0RWxlbWVudCgnI2FkX2NvbnQnLCB7CiAgICAgICAgICAgIGlkIDogJycsCiAgICAgICAgICAgIHN0eWxlIDogJ2Rpc3BsYXk6YmxvY2s7JwogICAgICAgICAgfSk7CiAgICAgICAgICBBYWsuc2V0RWxlbWVudCgnI2NvbnRhaW5lcl9jaGVjaycsIHsKICAgICAgICAgICAgc3R5bGUgOiAnZGlzcGxheTpub25lOycKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfSwKICAgICAgZXZlbnRvc3Bwdl9tZSA6IHsKICAgICAgICAvLyBpc3N1ZTogCiAgICAgICAgaG9zdCA6IFsnZXZlbnRvc3Bwdi5tZSddLAogICAgICAgIG9uSWRsZSA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEFhay5yZW1vdmVFbGVtZW50KCcjbmYzNycpOwogICAgICAgIH0KICAgICAgfSwKICAgICAgYm9sb3JfdG9saV9jb20gOiB7CiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzLzU1MgogICAgICAgIGhvc3QgOiBbJ2JvbG9yLXRvbGkuY29tJ10sCiAgICAgICAgb25FbmQgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICB2YXIgYWRzID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgnYmFubmVyJyk7CiAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFkcy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICB2YXIgYWQgPSBhZHNbaV07CiAgICAgICAgICAgIGFkLmlubmVySFRNTCA9ICc8YnI+JzsKICAgICAgICAgICAgYWQuc3R5bGUuaGVpZ2h0ID0gJzFweCc7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9LAogICAgICB2aXZvX3N4IDogewogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcy8yODAKICAgICAgICBob3N0IDogWyd2aXZvLnN4J10sCiAgICAgICAgb25FbmQgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICB2YXIgYWxlcnQgPSBBYWsuZ2V0RWxlbWVudCgnI2FsZXJ0LXRocm90dGxlJyk7CiAgICAgICAgICBpZiAoYWxlcnQpIHsKICAgICAgICAgICAgQWFrLnJlbW92ZUVsZW1lbnQoYWxlcnQpOwogICAgICAgICAgfQogICAgICAgICAgdmFyIGJ1dHRvbiA9IEFhay5nZXRFbGVtZW50KCdidXR0b24jYWNjZXNzJyk7CiAgICAgICAgICBpZiAoYnV0dG9uKSB7CiAgICAgICAgICAgIGJ1dHRvbi5yZW1vdmVBdHRyaWJ1dGUoJ2lkJyk7CiAgICAgICAgICAgIGJ1dHRvbi5yZW1vdmVBdHRyaWJ1dGUoJ2Rpc2FibGVkJyk7CiAgICAgICAgICAgIGJ1dHRvbi5pbm5lckhUTUwgPSAnQ29udGludWUgdG8gdmlkZW8nOwogICAgICAgICAgfQogICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIHZhciBpbnB1dCA9IEFhay5nZXRFbGVtZW50KCdpbnB1dFtuYW1lPSJ0aHJvdHRsZSJdJyk7CiAgICAgICAgICAgIGlmIChpbnB1dCkgewogICAgICAgICAgICAgIEFhay5yZW1vdmVFbGVtZW50KGlucHV0KTsKICAgICAgICAgICAgfQogICAgICAgICAgfSwgMTAwMCk7CiAgICAgICAgfQogICAgICB9LAogICAgICBsdXh5YWRfY29tIDogeyAvLyBza2lwIHJlZGlyZWN0IG15YW5pbWVzLmxpCiAgICAgICAgLy8gaXNzdWU6CiAgICAgICAgaG9zdCA6IFsnbHV4eWFkLmNvbSddLAogICAgICAgIG9uSWRsZSA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIGlmICgnL0luZm9ybWF0aW9uLnBocCcgPT0gbG9jYXRpb24ucGF0aG5hbWUpIHsKICAgICAgICAgICAgdmFyIGhyZWYgPSBsb2NhdGlvbi5ocmVmOwogICAgICAgICAgICBsb2NhdGlvbi5ocmVmID0gaHJlZi5zdWJzdHIoaHJlZi5pbmRleE9mKCd1cmw9JykgKyA0LCBocmVmLmxlbmd0aCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9LAogICAgICBtcnBpcmFjeV9kb21haW5zIDogewogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcy8xNDA1CiAgICAgICAgaG9zdCA6IFsnbXJwaXJhY3kueHl6JywgJ21ycGlyYWN5LmNsdWInXSwKICAgICAgICBvbkJlZm9yZVNjcmlwdCA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHJldHVybiBbewogICAgICAgICAgICAgIGNvbnRhaW5zIDogJ0Rlc2F0aXZhIG8gQWRCbG9jayBwYXJhIGNvbnRpbnVhcicsCiAgICAgICAgICAgICAgZXh0ZXJuYWwgOiBmYWxzZSwKICAgICAgICAgICAgICByZW1vdmUgOiB0cnVlCiAgICAgICAgICAgIH0KICAgICAgICAgIF07CiAgICAgICAgfQogICAgICB9LAogICAgICBkYnBsYW5ldF9uZXQgOiB7CiAgICAgICAgLy8gaXNzdWU6IFBNCiAgICAgICAgaG9zdCA6IFsnZGJwbGFuZXQubmV0J10sCiAgICAgICAgb25TdGFydCA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEFhay5zZXRDb29raWUoJ25ld25vTW9yZUFkc05vdycsIDEpOwogICAgICAgIH0KICAgICAgfSwKICAgICAgYWlkZW11X2ZyIDogewogICAgICAgIC8vIGlzc3VlOgogICAgICAgIGhvc3QgOiBbJ2FpZGVtdS5mciddLAogICAgICAgIG9uU3RhcnQgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBBYWsuc2V0Q29va2llKCdhZGJsb2NrUG9wdXAnLCB0cnVlKTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGVhbWlfaW4gOiB7CiAgICAgICAgLy8gaXNzdWU6CiAgICAgICAgaG9zdCA6IFsnZWFtaS5pbiddLAogICAgICAgIG9uQWx3YXlzIDogZnVuY3Rpb24gKCkgewogICAgICAgICAgQWFrLnNldENvb2tpZSgnYWRfbG9ja2VkJywgMSk7CiAgICAgICAgfQogICAgICB9LAogICAgICBiaWdkb3dubG9hZGVyX2NvbSA6IHsKICAgICAgICAvLyBpc3N1ZToKICAgICAgICBob3N0IDogWydiaWdkb3dubG9hZGVyLmNvbSddLAogICAgICAgIG9uSWRsZSA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEFhay5yZW1vdmVFbGVtZW50KCcjYW50aV9hZGJsb2NrJyk7CiAgICAgICAgfQogICAgICB9LAogICAgICBmcmVlc2tpZXJfY29tIDogewogICAgICAgIC8vIGJ5OiBHb3JoaWxsCiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzLzYzOQogICAgICAgIC8vIG5vdGU6IGFsc28gYWRkZWQgbGlzdCBydWxlCiAgICAgICAgaG9zdCA6IFsnZnJlZXNraWVyLmNvbSddLAogICAgICAgIG9uSWRsZSA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHZhciBlbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJhZGItbm90LWVuYWJsZWQiKTsKICAgICAgICAgIGlmIChlbCAhPT0gbnVsbCkgewogICAgICAgICAgICBlbC5zdHlsZS5yZW1vdmVQcm9wZXJ0eSgiZGlzcGxheSIpOwogICAgICAgICAgfQogICAgICAgICAgZWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgidmlkZW9Db250YWluZXIiKTsKICAgICAgICAgIGlmIChlbCAhPT0gbnVsbCkgewogICAgICAgICAgICBlbC5zdHlsZS5yZW1vdmVQcm9wZXJ0eSgiZGlzcGxheSIpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSwKICAgICAgZ2FtZXRyYWlsZXJzX2NvbSA6IHsKICAgICAgICAvLyBpc3N1ZToKICAgICAgICBob3N0IDogWydnYW1ldHJhaWxlcnMuY29tJ10sCiAgICAgICAgb25JZGxlIDogZnVuY3Rpb24gKCkgewogICAgICAgICAgQWFrLnJlbW92ZUVsZW1lbnQoJyNhZF9ibG9ja2luZycpOwogICAgICAgIH0KICAgICAgfSwKICAgICAgc2Nhbl9vbmVwaWVjZV9uYXJ1dG9fbXggOiB7CiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzLzU4MgogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcy8yNzkKICAgICAgICBob3N0IDogWydzY2FuLW14LmNvbScsICdvbmVwaWVjZS1teC5uZXQnLCAnbmFydXRvLW14Lm5ldCddLAogICAgICAgIG9uQWx3YXlzIDogZnVuY3Rpb24gKCkgewogICAgICAgICAgQWFrLnV3LmFkX2Jsb2NrX3Rlc3QgPSBmdW5jdGlvbiAoKSB7fTsKICAgICAgICB9LAogICAgICAgIG9uSWRsZSA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEFhay5zZXRFbGVtZW50KCcjeW9wJywgewogICAgICAgICAgICBpZCA6ICcnCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIC8vIEJpdGNvaW5zCiAgICAgIGJpdGNvaW5rZXJfY29tIDogewogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcy8yMzAKICAgICAgICBob3N0IDogWydiaXRjb2lua2VyLmNvbSddLAogICAgICAgIG9uU3RhcnQgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBBYWsudXcuY2xhaW0gPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICAgfTsKICAgICAgICB9LAogICAgICAgIG9uSWRsZSA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEFhay5yZW1vdmVFbGVtZW50KCcjRTMzRkNDY1gyZlcnKTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIG1vb25kb2dlX2NvX2luIDogewogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcy8zODQKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXMvMjMyCiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzLzIzMwogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcy8yMzYKICAgICAgICBob3N0IDogWydtb29uZG9nZS5jby5pbicsICdtb29ubGl0ZWNvLmluJywgJ21vb25iaXQuY28uaW4nLCAnYml0Y29pbnplYnJhLmNvbSddLAogICAgICAgIG9uSWRsZSA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEFhay5yZW1vdmVFbGVtZW50KCcjQUIsICNFNDQyRHYsICNlQ0M1aCcpOwogICAgICAgIH0KICAgICAgfSwKICAgICAgYml0Y29pbmVyX25ldCA6IHsKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXMvMzQ5CiAgICAgICAgaG9zdCA6IFsnYml0Y29pbmVyLm5ldCcsICdsaXRlY29pbmVyLm5ldCddLAogICAgICAgIG9uU3RhcnQgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBBYWsuYWRkQmFpdEVsZW1lbnQoJ2RpdiN0ZXN0ZXInKTsKICAgICAgICAgIEFhay5hZGRCYWl0RWxlbWVudCgnZGl2I2FkLXRvcCcpOwogICAgICAgIH0KICAgICAgfSwKICAgICAgYml0Y29pbnNfbnhfdGMgOiB7CiAgICAgICAgLy8gaXNzdWU6CiAgICAgICAgaG9zdCA6IFsnZnJlZWJpdGNvaW5zLm54LnRjJywgJ2dldGJpdGNvaW5zLm54LnRjJ10sCiAgICAgICAgb25BbHdheXMgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBBYWsudXcuYWRfYmxvY2tfdGVzdCA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAgfTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGZyZWVjb2luczRfbWUgOiB7CiAgICAgICAgLy8gaXNzdWU6CiAgICAgICAgaG9zdCA6IFsnZnJlZWNvaW5zNC5tZSddLAogICAgICAgIG9uQWx3YXlzIDogZnVuY3Rpb24gKCkgewogICAgICAgICAgQWFrLnV3LmNoZWNrID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICB9OwogICAgICAgIH0KICAgICAgfSwKICAgICAgdG9ycmVudF90dl9ydSA6IHsKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXMvNTM3CiAgICAgICAgaG9zdCA6IFsndG9ycmVudC10di5ydSddLAogICAgICAgIG9uQWx3YXlzIDogZnVuY3Rpb24gKCkgewogICAgICAgICAgQWFrLnV3LmNfT29fQWR2ZXJ0X1Nob3duID0gdHJ1ZTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGN3dHZfY29tIDogewogICAgICAgIC8vIGJ5OiBLYWxiYXNpdAogICAgICAgIC8vIHB1bGw6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvcHVsbC83NjMKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXMvMzQwCiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzLzc2MgogICAgICAgIGhvc3QgOiBbJ2N3dHYuY29tJ10sCiAgICAgICAgb25BbHdheXMgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBBYWsudXcuQ1dUVklzQWRCbG9ja2luZyA9IHVuZGVmaW5lZDsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGJpbGRfZGUgOiB7CiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzP3E9YmlsZAogICAgICAgIGhvc3QgOiBbJ2JpbGQuZGUnXSwKICAgICAgICBvbkJlZm9yZVNjcmlwdCA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHJldHVybiBbewogICAgICAgICAgICAgIGNvbnRhaW5zIDogJ2h0dHA6Ly93d3cuYmlsZC5kZS93YS9sbC9iaWxkLWRlL3VuYW5nZW1lbGRldC00MjkyNTUxNi5iaWxkLmh0bWwnLAogICAgICAgICAgICAgIGV4dGVybmFsIDogZmFsc2UsCiAgICAgICAgICAgICAgcmVwbGFjZSA6IFsnamF2YXNjcmlwdCcsICd2b2lkKDApOyddLmpvaW4oJzonKQogICAgICAgICAgICB9CiAgICAgICAgICBdOwogICAgICAgIH0KICAgICAgfSwKICAgICAgaW5uX2NvX2lsIDogewogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcy81MzIKICAgICAgICBob3N0IDogWydpbm4uY28uaWwnXSwKICAgICAgICBvblN0YXJ0IDogZnVuY3Rpb24gKCkgewogICAgICAgICAgQWFrLmFkZFNjcmlwdChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIHZhciBUUkMgPSB7fTsKICAgICAgICAgICAgVFJDLmJsb2NrZXIgPSB7CiAgICAgICAgICAgICAgc3RhdGVzIDogewogICAgICAgICAgICAgICAgQUJQX0RFVEVDVElPTl9ESVNBQkxFRCA6IC0yLAogICAgICAgICAgICAgICAgQUJQX05PVF9ERVRFQ1RFRCA6IDAsCiAgICAgICAgICAgICAgICBBQlBfREVURUNURUQgOiAxCiAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICBjcmVhdGVCbG9ja0RldGVjdGlvbkRpdiA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgIHJldHVybiBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJkaXYiKTsKICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgIGlzQmxvY2tEZXRlY3RlZE9uRGl2IDogZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgcmV0dXJuIDA7CiAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICBpc0Jsb2NrRGV0ZWN0ZWRPbkNsYXNzTmFtZXMgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gMDsKICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgIGdldEJsb2NrZWRTdGF0ZSA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgIHJldHVybiAwOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfTsKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfSwKICAgICAgYmhhc2thcl9jb20gOiB7CiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzP3E9Ymhhc2thcgogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcz9xPWRpdnlhYmhhc2thci5jby5pbgogICAgICAgIGhvc3QgOiBbJ2JoYXNrYXIuY29tJywgJ2RpdnlhYmhhc2thci5jby5pbiddLAogICAgICAgIG9uQWx3YXlzIDogZnVuY3Rpb24gKCkgewogICAgICAgICAgQWFrLnV3Lm9wZW5Qb3BVcEZvckJyZWFrUGFnZSA9IGZ1bmN0aW9uICgpIHt9OwogICAgICAgICAgQWFrLnV3LmNhbkFCUCA9IHRydWU7CiAgICAgICAgICBBYWsudXcuY2FuUnVuQWRzID0gdHJ1ZTsKICAgICAgICAgIEFhay51dy5jYW5DaGVja0FkcyA9IHRydWU7CiAgICAgICAgfQogICAgICB9LAogICAgICB0dXJrYW5pbWVfdHYgOiB7CiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzLzQ0NgogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcy8xMzkKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9ncmVhc3lmb3JrLm9yZy90ci9mb3J1bS9kaXNjdXNzaW9uLzQyODIvCiAgICAgICAgaG9zdCA6IFsndHVya2FuaW1lLnR2J10sCiAgICAgICAgb25BbHdheXMgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBBYWsudXcuYWRibG9ja2Jsb2NrID0gZnVuY3Rpb24gKCkge307CiAgICAgICAgICBBYWsudXcuQmxva0tvbnRyb2wgPSB7fTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIHd0ZmJpdF9jaCA6IHsKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXMvNDA3CiAgICAgICAgaG9zdCA6IFsnd3RmYml0LmNoJ10sCiAgICAgICAgb25BbHdheXMgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBBYWsudXcud3JpdGVIVE1MYXNKUyA9IGZ1bmN0aW9uICgpIHt9OwogICAgICAgIH0KICAgICAgfSwKICAgICAgYXJhbnp1bGxhX2l0IDogewogICAgICAgIC8vIGJ5OiBSb2JvdGV4CiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzP3E9YXJhbnp1bGxhLml0CiAgICAgICAgLy8gc291cmNlOiBodHRwOi8vcGFzdGViaW4uY29tL3lNTTZZZ3hXCiAgICAgICAgaG9zdCA6IFsnYXJhbnp1bGxhLml0J10sCiAgICAgICAgb25TdGFydCA6IGZ1bmN0aW9uKCkgewogICAgICAgICAgQWFrLmFkZFN0eWxlKCcjYWJ0MSArIFNUWUxFICsgZGl2W2lkXVtjbGFzc10ge2Rpc3BsYXk6bm9uZTt9Jyk7CiAgICAgICAgfSwKICAgICAgICBvbkJlZm9yZVNjcmlwdCA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHJldHVybiBbewogICAgICAgICAgICAgIGNvbnRhaW5zIDogJ25hdmlnYXRvci51c2VyQWdlbnR8fG5hdmlnYXRvci52ZW5kb3J8fHdpbmRvdy5vcGVyYScsCiAgICAgICAgICAgICAgZXh0ZXJuYWwgOiBmYWxzZSwKICAgICAgICAgICAgICByZW1vdmUgOiB0cnVlCiAgICAgICAgICAgIH0KICAgICAgICAgIF07CiAgICAgICAgfQogICAgICB9LAogICAgICBuZHR2X2NvbSA6IHsKICAgICAgICAvLyBub3RlOiBjYW5SdW5BZHMgaW52ZXJ0ZWQgdmFsdWUKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXM/cT1uZHR2LmNvbQogICAgICAgIC8vIHRlc3Q6IGh0dHA6Ly90aW55dXJsLmNvbS9oY2ZuY2R2CiAgICAgICAgaG9zdCA6IFsnbmR0di5jb20nXSwKICAgICAgICBvblN0YXJ0IDogZnVuY3Rpb24gKCkgewogICAgICAgICAgQWFrLnNldFJlYWRPbmx5KCdfX19wX19wJywgMSk7CiAgICAgICAgICBBYWsuc2V0UmVhZE9ubHkoJ2dldE5vVG9wTGF0ZXN0TmV3cycsIGZ1bmN0aW9uICgpIHt9KTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGxlc2VjaG9zX2ZyIDogewogICAgICAgIC8vIFJlZWssIEdpd2F5dW1lCiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzP3E9bGVzZWNob3MuZnIKICAgICAgICAvLyBzb3VyY2U6IGh0dHA6Ly9wYXN0ZWJpbi5jb20vQ01NOFdHTGoKICAgICAgICBob3N0IDogWydsZXNlY2hvcy5mcicsICdsZXNlY2hvcy5jb20nXSwKICAgICAgICBvblN0YXJ0IDogZnVuY3Rpb24oKSB7CiAgICAgICAgICBBYWsuYWRkU2NyaXB0KGZ1bmN0aW9uKCkgewogICAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkod2luZG93LCAiY2hlY2tBZEJsb2NrIiwgewogICAgICAgICAgICAgIHZhbHVlOiBmdW5jdGlvbigpIHt9LAogICAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogZmFsc2UsCiAgICAgICAgICAgICAgd3JpdGFibGU6IGZhbHNlCiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSk7CiAgICAgICAgfSwKICAgICAgICBvbkFsd2F5cyA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEFhay51dy5jYWxsX0FkID0gMTsKICAgICAgICAgIEFhay51dy5wYXl3YWxsX2FkYmxvY2tfYXJ0aWNsZSA9IGZ1bmN0aW9uICgpIHt9OwogICAgICAgIH0KICAgICAgfSwKICAgICAgYml0dmlzaXRzX2NvbSA6IHsKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXMvMjY2CiAgICAgICAgaG9zdCA6IFsnYml0dmlzaXRzLmNvbSddLAogICAgICAgIG9uQWx3YXlzIDogZnVuY3Rpb24gKCkgewogICAgICAgICAgQWFrLnV3LmJsb2NrQWRibG9ja1VzZXIgPSBmdW5jdGlvbiAoKSB7fTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGV4cmFwaWRsZWVjaF9pbmZvIDogewogICAgICAgIC8vIGJ5OiBBbGV4YW5kZXIyNTUsIFJlZWssIEdpd2F5dW1lCiAgICAgICAgLy8gcGF0Y2g6IGh0dHA6Ly9wYXN0ZWJpbi5jb20vUTY2NGRpUTIKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXM/cT1leHJhcGlkbGVlY2gKICAgICAgICAvLyBzb3VyY2U6IGh0dHA6Ly9wYXN0ZWJpbi5jb20vNWUyN3N5akEKICAgICAgICBob3N0IDogWydleHJhcGlkbGVlY2guaW5mbyddLAogICAgICAgIG9uU3RhcnQgOiBmdW5jdGlvbiAoKSB7CgogICAgICAgICAgdmFyIHRvbW9ycm93ID0gbmV3IERhdGUoKTsKICAgICAgICAgIHRvbW9ycm93LnNldERhdGUodG9tb3Jyb3cuZ2V0RGF0ZSgpICsgMSk7CgogICAgICAgICAgLy8gcHJldmVudCBwb3B1cAogICAgICAgICAgQWFrLnNldENvb2tpZSgncG9wY2FzaHB1Q2FwJywgMSk7CiAgICAgICAgICBBYWsuc2V0Q29va2llKCdwb3BjYXNocHUnLCAxKTsKICAgICAgICAgIEFhay5zZXRDb29raWUoJ25vcG9wYXRhbGwnLCB0b21vcnJvdy5nZXRUaW1lKCkudG9TdHJpbmcoKSk7CiAgICAgICAgICBBYWsuc2V0Q29va2llKCdub2FkdnRkYXknLCAwKTsKICAgICAgICAgIC8vQWFrLnNldENvb2tpZSgnYnZfRFNLc2tkY2tfczFkJywgJ2J2RFNLc2tkY2tzMWQnKTsKCiAgICAgICAgICAvLyBoaWRlIG5vdGljZQogICAgICAgICAgQWFrLmFkZFN0eWxlKCdkaXYuYWxlcnQuYWxlcnQtZGFuZ2VyLmxlYWQge29wYWNpdHk6MDt9Jyk7CiAgICAgICAgICAKICAgICAgICAgIC8vIHByZXZlbnQgcmVkaXJlY3QgdG8gdmVyaWZ5IHBhZ2UKICAgICAgICAgIEFhay5zZXRSZWFkT25seSgnYmR2Ym5yX3BpZCcsIFtdKTsKICAgICAgICAgIEFhay5zZXRSZWFkT25seSgnUG9wQWRzJywgMSk7CgogICAgICAgICAgQWFrLmFkZFNjcmlwdChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgLy8gcHJldmVudCBwb3B1cAogICAgICAgICAgICAgIHdpbmRvdy5vcGVuID0gZnVuY3Rpb24gKCkge307CgogICAgICAgICAgICAgIC8vIHByZXZlbnQgcmVkaXJlY3QgdG8gdmVyaWZ5IHBhZ2UKICAgICAgICAgICAgICB2YXIgZnJhbWUxID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaWZyYW1lJyk7CiAgICAgICAgICAgICAgZnJhbWUxLnNyYyA9ICdodHRwOi8vYmRmcm0uYmlkdmVydGlzZXIuY29tL0JpZFZlcnRpc2VyLmRibT9waWQ9MzgzODY1JmJpZD0xNzM3NDE4JlJEPSc7CiAgICAgICAgICAgICAgZnJhbWUxLmlkID0gJ2JkdmknOwogICAgICAgICAgICAgIGZyYW1lMS5zdHlsZSA9ICdkaXNwbGF5Om5vbmUnOwogICAgICAgICAgICAgIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5hcHBlbmRDaGlsZChmcmFtZTEpOwogICAgICAgICAgICB9KSgpOwogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9LAogICAgICB2aXBsZWFndWVfZG9tYWlucyA6IHsKICAgICAgICAvLyBub3RlOiBhbHNvIGtpbGxlZCBieSBBYWtMaXN0CiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzP3E9dmlwYm94CiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzP3E9dmlwbGVhZ3VlCiAgICAgICAgLy8gc291cmNlOiBodHRwOi8vcGFzdGViaW4uY29tL05FUlZ6SHpTCiAgICAgICAgaG9zdCA6IFsidmlwbGVhZ3VlLmlzIiwgInZpcGxlYWd1ZS53cyIsICJ2aXBsZWFndWUudHYiLCAidmlwbGVhZ3VlLnNlIiwgInZpcGxlYWd1ZS50diIsICJ2aXBsZWFndWUubWUiLCAidmlwbGVhZ3VlLm1vYmkiLCAidmlwbGVhZ3VlLmNvIiwgInZpcGxlYWd1ZS5zeCIsICJ2aXBsZWFndWUuY2giLCAidmlwYm94LnR2IiwgInZpcGJveC5jbyIsICJ2aXBib3guYml6IiwgInZpcGJveC5zeCIsICJ2aXBib3guZXUiLCAidmlwYm94LnNvIiwgInZpcGJveC5udSIsICJ2aXBib3hzYS5jbyIsICJzdHJpa2VvdXQuY28iLCAic3RyaWtlb3V0Lm1lIiwgImhvbWVydW4ucmUiLCAidmlwYm94dHYuY28iLCAidmlwYXBwLm1lIl0sCiAgICAgICAgb25TdGFydCA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEFhay51dy5pRXhpc3QgPSB0cnVlOwogICAgICAgICAgQWFrLnNldENvb2tpZSgneGNsc3ZpcCcsIDEpOwogICAgICAgICAgQWFrLmFkZFN0eWxlKCIudmlwXzA1MngwMDMgeyBoZWlnaHQ6IDI1MHB4OyB9Iik7CiAgICAgICAgICBBYWsuYWRkU3R5bGUoIi52aXBfMDl4ODI3IHsgaGVpZ2h0OiAyNnB4OyB9Iik7CiAgICAgICAgICBBYWsuYWRkU3R5bGUoIiNvdmVybGF5IHsgZGlzcGxheTogbm9uZTsgfSIpOwogICAgICAgIH0KICAgICAgfSwKICAgICAgem9vbXR2X21lIDogewogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcz9xPXpvb210di5tZQogICAgICAgIC8vIHNvdXJjZTogaHR0cDovL3Bhc3RlYmluLmNvbS9tNHpBWEdjdwogICAgICAgIGhvc3QgOiBbJ3pvb210di5tZSddLAogICAgICAgIG9uQWx3YXlzIDogZnVuY3Rpb24gKCkgewogICAgICAgICAgQWFrLnV3LmlheHBFbmFibGVkID0gdHJ1ZTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIHZnX25vIDogewogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcy8yOTIKICAgICAgICAvLyArYWJwIHJ1bGUKICAgICAgICBob3N0IDogWyd2Zy5ubycsICdlMjQubm8nXSwKICAgICAgICBvbkFsd2F5cyA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEFhay51dy5fX0FCX18gPSBmdW5jdGlvbiAoKSB7fTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIHBvcm52ZV9jb20gOiB7CiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzLzk0NwogICAgICAgIC8vIHNvdXJjZTogaHR0cDovL3Bhc3RlYmluLmNvbS83VFBQa3ExMgogICAgICAgIGhvc3QgOiBbJ3Bvcm52ZS5jb20nXSwKICAgICAgICBvbkFsd2F5cyA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEFhay51dy5hZHhqd3VwZGF0ZSA9IDE7CiAgICAgICAgfQogICAgICB9LAogICAgICBsb2xfbW9hX3R3IDogewogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcy8xMTE0CiAgICAgICAgaG9zdCA6IFsnbG9sLm1vYS50dyddLAogICAgICAgIG9uSWRsZSA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEFhay5hZGRTY3JpcHQoZnVuY3Rpb24gKCkgewogICAgICAgICAgICB2YXIgTW9hT2JqID0gTW9hT2JqIHx8IHt9OwogICAgICAgICAgICBNb2FPYmouYWQgPSBNb2FPYmouYWQgfHwge307CQkJCiAgICAgICAgICAgIE1vYU9iai5hZC5oYXNBZGJsb2NrID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgICAgfTsKICAgICAgICAgICAgTW9hT2JqLmFkLmNoZWNrQUJQID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgICAgfTsKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfSwKICAgICAgbXVsdGl1cF9vcmcgOiB7CiAgICAgICAgLy8gYnk6IFdhdGlsaW4KICAgICAgICAvLyBub3RlOiBhbHRlcm5hdGl2ZSBzb2x1dGlvbgogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcz9xPW11bHRpdXAub3JnCiAgICAgICAgaG9zdCA6IFsnbXVsdGl1cC5vcmcnXSwKICAgICAgICBvblN0YXJ0IDogZnVuY3Rpb24gKCkgewogICAgICAgICAgQWFrLnNldENvb2tpZSgndmlzaXQnLCAxKTsgLy8gcHJldmVudCBwb3B1cAogICAgICAgICAgQWFrLnNldFJlYWRPbmx5KCdoaScsIGZ1bmN0aW9uICgpIHt9KTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGRhaWx5Yml0Y29pbnNfb3JnIDogewogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcy8xMDcKICAgICAgICBob3N0IDogWydkYWlseWJpdGNvaW5zLm9yZyddLAogICAgICAgIG9uSWRsZSA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEFhay5yZW1vdmVFbGVtZW50KCcuYWQtaW1nJyk7CiAgICAgICAgfQogICAgICB9LAogICAgICBrb3phY3pla196ZWJlcmthIDogewogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcy80MTQKICAgICAgICBob3N0IDogWydrb3phY3play5wbCcsICd6ZWJlcmthLnBsJ10sCiAgICAgICAgb25TdGFydCA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEFhay5zZXRDb29raWUoJ2FibGMnLCAxKTsKICAgICAgICAgIEFhay5zZXRDb29raWUoJ2Nvb2tpZV9wb2xpY3knLCAxKTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIHNwYW5rd2lyZV9zaXRlcyA6IHsKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXMvODg3CiAgICAgICAgLy8gc291cmNlOiBodHRwOi8vcGFzdGViaW4uY29tL1RGQjFkdGdiCiAgICAgICAgaG9zdCA6IFsnc3Bhbmt3aXJlLmNvbScsICdrZWV6bW92aWVzLmNvbScsICdleHRyZW1ldHViZS5jb20nLCAnbW9mb3NleC5jb20nXSwKICAgICAgICBvblN0YXJ0IDogZnVuY3Rpb24gKCkgewogICAgICAgICAgQWFrLnNldENvb2tpZSgiYWJDbG9zZWQiLCAidHJ1ZSIpOwogICAgICAgICAgQWFrLnNldENvb2tpZSgiaGlkZV9hZF9tc2ciLCAiMSIpOwogICAgICAgIH0KICAgICAgfSwKICAgICAgeW91cG9ybl9uZXR3b3JrIDogewogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcy84ODcKICAgICAgICAvLyBzb3VyY2U6IGh0dHA6Ly9wYXN0ZWJpbi5jb20vVEZCMWR0Z2IKICAgICAgICBob3N0IDogWyd5b3Vwb3JuLmNvbScsICd5b3Vwb3JuZ2F5LmNvbSddLAogICAgICAgIG9uU3RhcnQgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBBYWsuc2V0Q29va2llKCJhZGJsb2NrX21lc3NhZ2UiLCAiY2xvc2VkIik7CiAgICAgICAgfQogICAgICB9LAogICAgICBjaXRhdGlvbm1hY2hpbmVfbmV0IDogewogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcz9xPWNpdGF0aW9ubWFjaGluZS5uZXQKICAgICAgICBob3N0IDogWydjaXRhdGlvbm1hY2hpbmUubmV0J10sCiAgICAgICAgb25TdGFydCA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEFhay5zZXRDb29raWUoInNibV9jbV9jaXRhdGlvbnMiLCAwKTsKICAgICAgICB9CiAgICAgIH0sICAgICAgCiAgICAgIHBzYXJpcHNfY29tIDogewogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcy8xNTMKICAgICAgICBob3N0IDogWydwc2FyaXBzLmNvbSddLAogICAgICAgIG9uU3RhcnQgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBBYWsuYWRkQmFpdEVsZW1lbnQoJ2RpdiNhZHZlcnQnKTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGV4dHJhdG9ycmVudF9kb21haW5zIDogewogICAgICAgIGhvc3QgOiBbJ2V4dHJhdG9ycmVudC5jYycsICdleHRyYXRvcnJlbnQuY29tJ10sCiAgICAgICAgb25TdGFydCA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIC8vIHByZXZlbnQgcG9wdXAKICAgICAgICAgIC8vIHNvdXJjZSBhcmUgb2JmdXNjYXRlZCBpbiBleHRlcm5hbCBqcwogICAgICAgICAgQWFrLnNldENvb2tpZSgncHB1X2RlbGF5JywgMSk7CiAgICAgICAgICBBYWsuc2V0Q29va2llKCdwcHVfbWFpbicsIDEpOwogICAgICAgICAgQWFrLnNldENvb2tpZSgncHB1X3N1YicsIDEpOwogICAgICAgICAgQWFrLnNldENvb2tpZSgncHB1X3Nob3dfb24nLCAxKTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIHRueV9jeiA6IHsKICAgICAgICBob3N0IDogWyd0bnkuY3onLCAncGFzdGVkLmNvJ10sCiAgICAgICAgb25TdGFydCA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIC8vIHByZXZlbnQgcG9wdXAKICAgICAgICAgIEFhay5zZXRDb29raWUoJ19fLnBvcHVuZGVyQ2FwJywgMSk7CiAgICAgICAgICBBYWsuc2V0Q29va2llKCdfXy5wb3B1bmRlcicsIDEpOwogICAgICAgIH0KICAgICAgfSwKICAgICAgY2x1YmVkb2hhcmR3YXJlX2NvbV9iciA6IHsgLy8gdHdvIGFudGlhZGJsb2NrCiAgICAgICAgaG9zdCA6IFsnY2x1YmVkb2hhcmR3YXJlLmNvbS5iciddLAogICAgICAgIG9uU3RhcnQgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBpZiAoQWFrLmNvbnRhaW5zKGxvY2F0aW9uLmhvc3QsICdmb3J1bScpKSB7CiAgICAgICAgICAgIC8vIFNvbHV0aW9uIDEKICAgICAgICAgICAgQWFrLmFkZFN0eWxlKCIjYmFubmVyLCBzY3JpcHQgeyBoZWlnaHQ6IDUxcHg7IH0iKTsKICAgICAgICAgICAgQWFrLmFkZEJhaXRFbGVtZW50KCdkaXYjYmFubmVyJyk7CiAgICAgICAgICB9IGVsc2UgeyAvLyBXZWJzaXRlCiAgICAgICAgICAgIC8vIFNvbHV0aW9uIDEKICAgICAgICAgICAgQWFrLmFkZEJhaXRFbGVtZW50KCdkaXYuYmFubmVyX3RvcG8nKTsKICAgICAgICAgIH0KICAgICAgICB9LAogICAgICAgIG9uSWRsZSA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIGlmIChBYWsuY29udGFpbnMobG9jYXRpb24uaG9zdCwgJ2ZvcnVtJykpIHsKICAgICAgICAgICAgLy8gU29sdXRpb24gMgogICAgICAgICAgICBBYWsudXcuYWRkQmxvY2tpbmcuaGlkZSgpOwogICAgICAgICAgICBBYWsudXcuYWRkQmxvY2tpbmcua2lsbCgpOwogICAgICAgICAgfSBlbHNlIHsgLy8gV2Vic2l0ZQogICAgICAgICAgICAvLyBTb2x1dGlvbiAyCiAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuaWQgPSAnJzsKICAgICAgICAgICAgQWFrLnJlbW92ZUVsZW1lbnQoJy5hZGJsb2NrJyk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9LAogICAgICBkZWJyYXN0YWdpX2NvbSA6IHsKICAgICAgICBob3N0IDogWydkZWJyYXN0YWdpLmNvbSddLAogICAgICAgIG9uSWRsZSA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEFhay5yZW1vdmVFbGVtZW50KCcjc3RwLW1haW4nKTsKICAgICAgICAgIEFhay5yZW1vdmVFbGVtZW50KCcjc3RwLWJnJyk7CiAgICAgICAgfQogICAgICB9LAogICAgICBkZGxmcmVuY2hfb3JnIDogewogICAgICAgIGhvc3QgOiBbJ2RkbGZyZW5jaC5vcmcnXSwKICAgICAgICBvbklkbGUgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAvLyBGaXggYnVnIGRpc3BsYXkgY29udGVudAogICAgICAgICAgQWFrLnNldEVsZW1lbnQoJyNkbGUtY29udGVudCAuZC1jb250ZW50JywgewogICAgICAgICAgICAnY2xhc3MnIDogJycKICAgICAgICAgIH0pOwogICAgICAgICAgQWFrLnNldEVsZW1lbnQoJyNjb250ZW50JywgewogICAgICAgICAgICAnaWQnIDogJycKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfSwKICAgICAgbWVnYWRlYnJpZF9ldSA6IHsKICAgICAgICBob3N0IDogWydtZWdhLWRlYnJpZC5ldSddLAogICAgICAgIG9uRW5kIDogZnVuY3Rpb24gKCkgewogICAgICAgICAgLy8gQWN0aXZhdGUgYnV0dG9uIGRlYnJpZAogICAgICAgICAgQWFrLnNldEVsZW1lbnQoJy5yZWFsYnV0dG9uJywgewogICAgICAgICAgICAnb25jbGljaycgOiAnJywKICAgICAgICAgICAgJ3R5cGUnIDogJ3N1Ym1pdCcKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfSwKICAgICAgc2xpZGVwbGF5ZXJfZG9tYWlucyA6IHsKICAgICAgICAvLyBieTogQWxleGFuZGVyMjU1CiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzLzEzMzMKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXMvNTE1CiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzLzI5NgogICAgICAgIC8vIGRlbW86IGh0dHA6Ly9zbGlkZXBsYXllci5mci9zbGlkZS8xMzA0MDI2LyMKICAgICAgICBob3N0IDogWydzbGlkZXBsYXllci4qJ10sCiAgICAgICAgb25FbmQgOiBmdW5jdGlvbiAoKSB7CgogICAgICAgICAgLy8gRGlzYWJsZSBhbnRpLWFkYmxvY2tlcgogICAgICAgICAgQWFrLnV3LmZvcmNlX3JlbW92ZV9hZHMgPSB0cnVlOwoKICAgICAgICAgIC8vIENpcmN1bXZlbnQgInNoYXJlIHRvIGRvd25sb2FkIiBydWxlCiAgICAgICAgICBBYWsuYWRkU2NyaXB0KGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgdmFyIHNsaWRlX2lkID0gd2luZG93LmdldF9jdXJyZW50X3NsaWRlX2lkKCk7CiAgICAgICAgICAgIHZhciBzbGlkZV9zcnYgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgicGxheWVyX2ZyYW1lIikuc3JjLnNwbGl0KCIvIilbM107CiAgICAgICAgICAgIHZhciB0aW1lID0gODY0MDAgKyBNYXRoLmZsb29yKERhdGUubm93KCkgLyAxMDAwKTsKICAgICAgICAgICAgdmFyIHNlY3JldCA9IGVuY29kZVVSSUNvbXBvbmVudCh3aW5kb3cuc3RydHIod2luZG93Lk1ENS5iYXNlNjQoInNlY3JldF9wcmV2ZWQgc2xpZGVwbGF5ZXIgbmV2ZXIgc29sdmVkICIgKyB0aW1lICsgc2xpZGVfaWQgKyAiLnBwdCIpLCAiKy8iLCAiLSAiKSk7CgogICAgICAgICAgICB2YXIgdXJsID0gImh0dHA6Ly9wbGF5ZXIuc2xpZGVwbGF5ZXIub3JnL2Rvd25sb2FkLyIgKyBzbGlkZV9zcnYgKyAiLyIgKyBzbGlkZV9pZCArICIvIiArIHNlY3JldCArICIvIiArIHRpbWUgKyAiLyIgKyBzbGlkZV9pZCArICIucHB0IjsKICAgICAgICAgICAgdmFyIGxpbmtzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgiYS5kb3dubG9hZF9saW5rIik7CiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGlua3MubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgICAvKiBSZW1vdmUgb3JpZ2luYWwgInNoYXJlIHRvIGRvd25sb2FkIiBwb3B1cCBldmVudCBsaXN0ZW5lciAqLwogICAgICAgICAgICAgIHZhciBldmVudHMgPSAkLl9kYXRhKGxpbmtzW2ldKS5ldmVudHMuY2xpY2s7CiAgICAgICAgICAgICAgZXZlbnRzLnNwbGljZSgwLCBldmVudHMubGVuZ3RoKTsKCiAgICAgICAgICAgICAgLyogU2V0IG5vcm1hbCBsaW5rIGhyZWYgaW5zdGVhZCAqLwogICAgICAgICAgICAgIGxpbmtzW2ldLmhyZWYgPSB1cmw7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0pOwoKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGJva2Vwc3BvdF9jb20gOiB7CiAgICAgICAgaG9zdCA6IFsnYm9rZXBzcG90LmNvbSddLAogICAgICAgIG9uU3RhcnQgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAvLyBIaWRlIERpc2NsYWltZXIKICAgICAgICAgIEFhay5zZXRDb29raWUoJ2hpZGVEaWFsb2cnLCAnaGlkZScpOwogICAgICAgIH0sCiAgICAgICAgb25JZGxlIDogZnVuY3Rpb24gKCkgewogICAgICAgICAgLy8gUmVtb3ZlIERpc2FibGUgQWRCbG9jawogICAgICAgICAgQWFrLnJlbW92ZUVsZW1lbnQoJyN0dXBpa2xhbicpOwogICAgICAgIH0KICAgICAgfSwKICAgICAgcGljbG9hZF9jb20gOiB7CiAgICAgICAgaG9zdCA6IFsncGljbG9hZC5vcmcnXSwKICAgICAgICBvblN0YXJ0IDogZnVuY3Rpb24gKCkgewogICAgICAgICAgQWFrLnNldENvb2tpZSgncGxfYWRibG9ja2VyJywgZmFsc2UpOwogICAgICAgIH0sCiAgICAgICAgb25JZGxlIDogZnVuY3Rpb24gKCkgewogICAgICAgICAgQWFrLnV3LmFkc19sb2FkZWQgPSB0cnVlOwogICAgICAgICAgQWFrLnV3LmltYWdlQWRzID0gZmFsc2U7CiAgICAgICAgICBBYWsucmVtb3ZlRWxlbWVudCgnZGl2W29uY29udGV4dG1lbnU9InJldHVybiBmYWxzZTsiXScpOwogICAgICAgIH0KICAgICAgfSwKICAgICAgZnJlZXplZG93bmxvYWRfY29tIDogewogICAgICAgIGhvc3QgOiBbJ2ZyZWV6ZWRvd25sb2FkLmNvbSddLAogICAgICAgIG9uSWRsZSA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIGlmICgvZnJlZXplZG93bmxvYWQuY29tXC9kb3dubG9hZFwvLy50ZXN0KGxvY2F0aW9uLmhyZWYpKSB7CiAgICAgICAgICAgIEFhay5yZW1vdmVFbGVtZW50KCdib2R5ID4gZGl2W2lkXScpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSwKICAgICAgbW9ubnN1dG9nYXR5YV9jb20gOiB7CiAgICAgICAgLy8gaXNzdWU6IFBNCiAgICAgICAgLy8gc291cmNlOiBodHRwOi8vcGFzdGViaW4uY29tLzFMdzYwaDZrCiAgICAgICAgaG9zdCA6IFsnbW9ubnN1dG9nYXR5YS5jb20nXSwKICAgICAgICBvbklkbGUgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBBYWsuYWRkU3R5bGUoIiNzaXRlLWJveCB7ZGlzcGxheTpibG9jazt9Iik7CiAgICAgICAgICBBYWsucmVtb3ZlRWxlbWVudCgnI2Zvci1hZC1ibG9ja2VyJyk7CiAgICAgICAgfQogICAgICB9LAogICAgICByYXBpZDhfY29tIDogewogICAgICAgIGhvc3QgOiBbJ3JhcGlkOC5jb20nXSwKICAgICAgICBvbklkbGUgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBBYWsucmVtb3ZlRWxlbWVudCgnZGl2LmJhY2trICsgI2JsY29rTXpnJyk7CiAgICAgICAgICBBYWsucmVtb3ZlRWxlbWVudCgnZGl2LmJhY2trJyk7CiAgICAgICAgfQogICAgICB9LAogICAgICB0dXJrZG93bl9jb20gOiB7CiAgICAgICAgaG9zdCA6IFsndHVya2Rvd24uY29tJ10sCiAgICAgICAgb25JZGxlIDogZnVuY3Rpb24gKCkgewogICAgICAgICAgLy8gcmVtb3ZlIGZhY2Vib29rIGJveAogICAgICAgICAgQWFrLnJlbW92ZUVsZW1lbnQoJyNkdXl1cnUnKTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGZpbG1vdml6aWphX2RvbWFpbnMgOiB7CiAgICAgICAgaG9zdCA6IFsnZmlsbW92aXppamEubWUnLCAnZmlsbW92aXppamEuY29tJywgJ2ZpbG1vdml6aWphLmluJywgJ2ZpbG1vdml6aWphLm5ldCddLAogICAgICAgIG9uSWRsZSA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIC8qCiAgICAgICAgICB2YXIgZCA9IG5ldyBEYXRlKCk7CiAgICAgICAgICB2YXIgd2Vla2RheSA9IFsiU3VuZGF5IiwgIk1vbmRheSIsICJUdWVzZGF5IiwgIldlZG5lc2RheSIsICJUaHVyc2RheSIsICJGcmlkYXkiLCAiU2F0dXJkYXkiXTsKICAgICAgICAgIHZhciBuID0gd2Vla2RheVtkLmdldERheSgpXTsKICAgICAgICAgIEFhay5zZXRFbGVtZW50KCcjJyArIG4sIHsKICAgICAgICAgIGh0bWwgOiAnJwogICAgICAgICAgfSk7CiAgICAgICAgICBBYWsucmVtb3ZlRWxlbWVudCgnIycgKyBuKTsKICAgICAgICAgICAqLwogICAgICAgIH0KICAgICAgfSwKICAgICAgaGFja2ludG9zaF96b25lIDogewogICAgICAgIC8vIGJ5OiBBbGV4YW5kZXIyNTUKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXM/cT1oYWNraW50b3NoLnpvbmUKICAgICAgICAvLyBzb3VyY2U6IGh0dHA6Ly9wYXN0ZTIub3JnL0RuQjlPajRmCiAgICAgICAgaG9zdCA6IFsnaGFja2ludG9zaC56b25lJ10sCiAgICAgICAgb25JZGxlIDogZnVuY3Rpb24gKCkgewoKICAgICAgICAgIHZhciBoZWFkID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoImhlYWQiKVswXTsKICAgICAgICAgIC8vIEZha2UgR29vZ2xlIGFkIGZyYW1lIGNvbnRlbnQKICAgICAgICAgIHZhciBhZDEgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJpbnMiKTsKICAgICAgICAgIGFkMS5jbGFzc05hbWUgPSAiYWRzYnlnb29nbGUiOwogICAgICAgICAgYWQxLmFwcGVuZENoaWxkKGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKCJBQUsiKSk7CiAgICAgICAgICBoZWFkLmluc2VydEJlZm9yZShhZDEsIGhlYWQuY2hpbGROb2Rlc1swXSk7CgogICAgICAgICAgLyoKICAgICAgICAgIC8vIEZha2UgQ2xlYW5NeU1hYyBhZCBmcmFtZSBzaXplCiAgICAgICAgICB2YXIgYWQyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2Iik7CiAgICAgICAgICBhZDIuaWQgID0gIm55Y3VoZXZncWkiOwogICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGFkMi53cmFwcGVkSlNPYmplY3QsICdjbGllbnRIZWlnaHQnLCB7dmFsdWU6IDF9KTsKICAgICAgICAgIGhlYWQuaW5zZXJ0QmVmb3JlKGFkMiwgaGVhZC5jaGlsZE5vZGVzWzBdKTsKICAgICAgICAgICAqLwoKICAgICAgICAgIHZhciBlbGVtcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5hZHNlbnNlZ3JleScpOwogICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBlbGVtcy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICB2YXIgbm9kZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImltZyIpOwogICAgICAgICAgICBub2RlLnNyYyA9IEFhay5pbWdCYWl0OwogICAgICAgICAgICBlbGVtc1tpXS5hcHBlbmRDaGlsZChub2RlKTsKICAgICAgICAgIH0KCiAgICAgICAgfSwKICAgICAgICBvbkJlZm9yZVNjcmlwdCA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHJldHVybiBbewogICAgICAgICAgICAgIGNvbnRhaW5zIDogJ2Rpc2FibGUgQURCbG9jayBjb21wbGV0ZWx5JywKICAgICAgICAgICAgICBleHRlcm5hbCA6IGZhbHNlLAogICAgICAgICAgICAgIHJlbW92ZSA6IHRydWUKICAgICAgICAgICAgfQogICAgICAgICAgXTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIHByaXZhdGVpbnN0YV9jb20gOiB7CiAgICAgICAgaG9zdCA6IFsncHJpdmF0ZWluc3RhLmNvbSddLAogICAgICAgIG9uSWRsZSA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIC8vICsgYWJwIHJ1bGUKICAgICAgICAgIEFhay51dy5kb250X3Njcm9sbCA9IGZhbHNlOwogICAgICAgICAgQWFrLnJlbW92ZUVsZW1lbnQoIiNvdmVybGF5X2RpdiIpOwogICAgICAgICAgQWFrLnJlbW92ZUVsZW1lbnQoIiNvdmVybGF5X21haW5fZGl2Iik7CiAgICAgICAgfQogICAgICB9LAogICAgICByaXNpa29nZXN1bmRoZWl0X2RlIDogewogICAgICAgIGhvc3QgOiBbJ3Jpc2lrby1nZXN1bmRoZWl0LmRlJ10sCiAgICAgICAgb25JZGxlIDogZnVuY3Rpb24gKCkgewogICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIHdpbmRvdy5zdG9wKCk7CiAgICAgICAgICB9LCA1MDAwKTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIG9uZXBsYXlsaXN0X2V1X3BuIDogewogICAgICAgIGhvc3QgOiBbJ29uZXBsYXlsaXN0LmV1LnBuJ10sCiAgICAgICAgb25JZGxlIDogZnVuY3Rpb24gKCkgewogICAgICAgICAgLy8ga2lsbCBwb3B1bmRlcgogICAgICAgICAgQWFrLnV3Lm1ha2VQb3B1bmRlciA9IGZhbHNlOwogICAgICAgIH0KICAgICAgfSwKICAgICAgb25tZWRhX2RlIDogewogICAgICAgIC8vIG5vdGU6IHNjcmlwdCBvYmZ1c2NhdGVkIGxpbmUgMTExMAogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dyZWFzeWZvcmsub3JnL2ZvcnVtL2Rpc2N1c3Npb24vODU3NgogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcy8xMDY3CiAgICAgICAgLy8gc291cmNlOiBodHRwOi8vcGFzdGViaW4uY29tL3FmNDZiTjN6CiAgICAgICAgLy8gc291cmNlOiBodHRwOi8vcGFzdGViaW4uY29tL1J3SHlGME5MCiAgICAgICAgaG9zdCA6IFsnb25tZWRhLmRlJ10sCiAgICAgICAgb25BbHdheXMgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBBYWsudXcuJEFEUCA9IHRydWU7CiAgICAgICAgICBBYWsudXcuc2FzX2NhbGxBZCA9IGZ1bmN0aW9uICgpIHt9OwogICAgICAgICAgQWFrLnV3LnNhc19jYWxsQWRzID0gZnVuY3Rpb24gKCkge307CiAgICAgICAgfQogICAgICB9LAogICAgICB0dXJib2RlYnJpZGV1cl9jb20gOiB7CiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzLzU5OQogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcy81NjMKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXMvNTI2CiAgICAgICAgaG9zdCA6IFsndHVyYm9kZWJyaWRldXIuY29tJ10sCiAgICAgICAgb25JZGxlIDogZnVuY3Rpb24gKCkgewogICAgICAgICAgQWFrLmNyZWF0ZUVsZW1lbnQoewogICAgICAgICAgICB0YWcgOiAnZGl2JywKICAgICAgICAgICAgaWQgOiAncHViZGlyZWN0ZScsCiAgICAgICAgICAgIGh0bWwgOiAnPGltZyAgc3JjPSInICsgQWFrLmltZ0JhaXQgKyAnIi8+PGEgIGhyZWY9IiMiPiZuYnNwOzwvYT4nLAogICAgICAgICAgICBhcHBlbmQgOiAnYm9keScKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfSwKICAgICAgcm9ja2ZpbGVfZXUgOiB7CiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzLzEyNTYKICAgICAgICBob3N0IDogWydyb2NrZmlsZS5ldSddLAogICAgICAgIG9uSWRsZSA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEFhay5jcmVhdGVFbGVtZW50KHsKICAgICAgICAgICAgdGFnIDogJ2lmcmFtZScsCiAgICAgICAgICAgIHNyYyA6ICdhYm91dDpibGFuaycsCiAgICAgICAgICAgIHN0eWxlIDogJ3Zpc2liaWxpdHk6aGlkZGVuOycsCiAgICAgICAgICAgIGFwcGVuZCA6ICdib2R5JwogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9LAogICAgICBsaW5rYnVja3NfYW50aWFkYmxvY2sgOiB7CiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzLzkzMgogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcy80NjkKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXMvMjc3CiAgICAgICAgLy8gdjM6IGh0dHA6Ly9wYXN0ZWJpbi5jb20vMGdoOExNR0gKICAgICAgICAvLyBub3RlOiBubyBzb2x1dGlvbiwgYW50aS1hZGJsb2NrIGRpZmZpY3VsdCB0byBieXBhc3MgLS0+IGh0dHA6Ly9wYXN0ZWJpbi5jb20vMU5ScTdXdloKICAgICAgICBob3N0IDogWydsaW5rYnVja3MuY29tJywgJ21pbml1cmxzLmNvJywgJ3BpY2J1Y2tzLmNvbScsICdwaWN0dXJlc2V0Yy5uZXQnLCAncGxhY2VwaWN0dXJlcy5jb20nLCAncG9vbnRvd24ubmV0JywgJ3FxYy5jbycsICdxdnZvLmNvbScsICdyZWFsZmlsZXMubmV0JywgJ3JxcS5jbycsICdzZXJpb3VzZGVhbHMubmV0JywgJ3NlcmlvdXNmaWxlcy5jb20nLCAnc2VyaW91c3VybHMuY29tJywgJ3NleHBhbGFjZS5ncycsICd0aGVzZWJsb2dzLmNvbScsICd0aGVzZWZpbGVzLmNvbScsICd0aGVzZWZvcnVtcy5jb20nLCAndGhvc2VnYWxsZXJpZXMuY29tJywgJ3RpbnlidWNrcy5uZXQnLCAndGlueWxpbmtzLmNvJywgJ3RuYWJ1Y2tzLmNvbScsICd0dWJldmlyYWwuY29tJywgJ3ViZXJwaWN6LmNvbScsICd1YmVydmlkei5jb20nLCAndWJ1Y2tzLm5ldCcsICd1Z2FsbGVyaWVzLm5ldCcsICd1bHRyYWZpbGVzLm5ldCcsICd1cmxiZWF0Lm5ldCcsICd1cmxwdWxzZS5uZXQnLCAnd2hhY2t5dmlkei5jb20nLCAneW91ZmFwLm1lJywgJ3l5di5jbycsICd6eHhvLm5ldCcsICd6ZmYuY28nLCAnbGlua2J1Y2tzZG5zLmNvJywgJ21pbml1cmxzLmNvbScsICdkeW8uZ3MnLCAnZ29uZXZpcmFsLmNvbScsICdlYWZ5ZnN1aC5uZXQnLCAnc2Fzb250bndjLm5ldCddLAogICAgICAgIG9uU3RhcnQgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAvLyBkbyBub3RoaW5nLi4uCiAgICAgICAgfQogICAgICB9LAogICAgICBsaW5rYnVja3NfdmlzaXRzY3JpcHQgOiB7CiAgICAgICAgLy8gaXNzdWU6CiAgICAgICAgaG9zdCA6IFsncmVmZXJlbmNlbWVnYS5jb20nLCAnZnBhYmQuY29tJywgJ2NyYWNrYWNjLmNvbSddLAogICAgICAgIG9uU3RhcnQgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAvLyBTa2lwIHZpc2l0U2NyaXB0IHdoZW4gc2l0ZSB1c2UgQ2xvdWRGbGFyZSBSb2NrZXQgU2NyaXB0CiAgICAgICAgICBBYWsuc2V0Q29va2llKCdfbGJHYXRlUGFzc2VkJywgdHJ1ZSk7CiAgICAgICAgfQogICAgICB9LAogICAgICBsaW5rX3RsIDogewogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcz9xPWxpbmsudGwKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9ncmVhc3lmb3JrLm9yZy9mci9mb3J1bS9kaXNjdXNzaW9uLzg0MzcKICAgICAgICAvLyBzb3VyY2U6IGh0dHA6Ly9wYXN0ZWJpbi5jb20vMU1rQ25tTDcKICAgICAgICBob3N0IDogWydsaW5rLnRsJ10sCiAgICAgICAgb25TdGFydCA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEFhay5hZGRTdHlsZSgnLmFkYmxvY2sgeyBoZWlnaHQ6MXB4OyB9Jyk7CiAgICAgICAgICBBYWsudXcuYWRibG9ja2VyID0gZmFsc2U7CiAgICAgICAgfQogICAgICB9LAogICAgICB3c3RyZWFtX3ZpZGVvIDogewogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcy8xMzgyCiAgICAgICAgLy8gc291cmNlOiBodHRwOi8vcGFzdGViaW4uY29tL0VpQVJWUVh0CiAgICAgICAgaG9zdCA6IFsnd3N0cmVhbS52aWRlbyddLAogICAgICAgIG9uU3RhcnQgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBBYWsuYWRkU3R5bGUoJyNhZGl2IHsgaGVpZ2h0OjRweDsgfScpOwogICAgICAgIH0KICAgICAgfSwKICAgICAgXzRzaGFyZWRfY29tIDogewogICAgICAgIGhvc3QgOiBbJzRzaGFyZWQuY29tJ10sCiAgICAgICAgb25JZGxlIDogZnVuY3Rpb24gKCkgewogICAgICAgICAgLy8gSGlkZSAiRGlzYWJsZSBBZEJsb2RrIiBtZXNzYWdlcwogICAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignYm9keScpLmNsYXNzTGlzdC5yZW1vdmUoImpzQmxvY2tEZXRlY3QiKTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIHByb19kb21haW5zIDogewogICAgICAgIGhvc3QgOiBbJ3Byby16aWsud3MnLCAncHJvLXRlY3Qud3MnLCAncHJvLWRkbC53cycsICdwcm8tc3BvcnQud3MnXSwKICAgICAgICBvblN0YXJ0IDogZnVuY3Rpb24gKCkgewogICAgICAgICAgQWFrLnNldENvb2tpZSgndmlzaXRlZGYnLCB0cnVlKTsKICAgICAgICAgIEFhay5zZXRDb29raWUoJ3Zpc2l0ZWRoJywgdHJ1ZSk7CiAgICAgICAgfQogICAgICB9LAogICAgICBjb21wdG9pcmhhcmR3YXJlX2NvbSA6IHsKICAgICAgICBob3N0IDogWydjb21wdG9pci1oYXJkd2FyZS5jb20nXSwKICAgICAgICBvbkFsd2F5cyA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEFhay51dy5hZGJsb2NrID0gJ25vbic7CiAgICAgICAgfQogICAgICB9LAogICAgICBiYWtlcnNmaWVsZF9jb20gOiB7CiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzLzY1NwogICAgICAgIC8vIG5vdGU6IGFsc28gc29sdXRpb24gdG8gQWFrTGlzdAogICAgICAgIGhvc3QgOiBbJ2Jha2Vyc2ZpZWxkLmNvbSddLAogICAgICAgIG9uQWx3YXlzIDogZnVuY3Rpb24gKCkgewogICAgICAgICAgQWFrLnV3LkFEX1NMT1RfUkVOREVSRUQgPSB0cnVlOwogICAgICAgIH0KICAgICAgfSwKICAgICAgZWtzdHJhYmxhZGV0X2RrIDogewogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcz9xPWVrc3RyYWJsYWRldAogICAgICAgIC8vIHNvdXJjZTogaHR0cDovL3Bhc3RlYmluLmNvbS9SMDI5WHBDcgogICAgICAgIGhvc3QgOiBbJ2Vrc3RyYWJsYWRldC5kaycsICdlYi5kayddLAogICAgICAgIG9uQWx3YXlzIDogZnVuY3Rpb24gKCkgewogICAgICAgICAgQWFrLnV3LkFEVEVDSCA9IHt9OwogICAgICAgIH0KICAgICAgfSwKICAgICAgcGNnYW1lc19kb3dubG9hZF9uZXQgOiB7CiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzLzE0NTEKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9ncmVhc3lmb3JrLm9yZy9mb3J1bS9kaXNjdXNzaW9uLzkzMjgKICAgICAgICAvLyBzb3VyY2U6IGh0dHA6Ly9wYXN0ZWJpbi5jb20vRUJWWmczVkIKICAgICAgICBob3N0IDogWydwY2dhbWVzLWRvd25sb2FkLm5ldCddLAogICAgICAgIG9uQWx3YXlzIDogZnVuY3Rpb24gKCkgewogICAgICAgICAgQWFrLnNldENvb2tpZSgnbm9BZGJsb2NrTmljZU1lc3NhZ2UnLCAxKTsKICAgICAgICAgIEFhay51dy5tZ0NhbkxvYWQzMDU0NyA9IHRydWU7CiAgICAgICAgfQogICAgICB9LAogICAgICBsYWNoYWluZW1ldGVvX2NvbSA6IHsKICAgICAgICAvLyBub3RlOiBhbHNvIGtpbGxlZCBieSBBYWtMaXN0CiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzLzU5MAogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcy8yNDUKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXMvMjE1CiAgICAgICAgaG9zdCA6IFsnbGFjaGFpbmVtZXRlby5jb20nXSwKICAgICAgICBvbkFsd2F5cyA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEFhay51dy5qc19sb2FkZWQgPSB0cnVlOwogICAgICAgIH0KICAgICAgfSwKICAgICAgbWFjNGV2ZXJfY29tIDogewogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcy85OTcKICAgICAgICAvLyBzb3VyY2U6IGh0dHA6Ly9wYXN0ZWJpbi5jb20vUlFuQ0VZSzYKICAgICAgICBob3N0IDogWydtYWM0ZXZlci5jb20nXSwKICAgICAgICBvbkFsd2F5cyA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEFhay51dy5jb3F1aW5vdSA9IGZ1bmN0aW9uICgpIHt9OwogICAgICAgIH0KICAgICAgfSwKICAgICAgXzUyNzhiYnNfY29tIDogewogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcz9xPTUyNzhiYnMuY29tCiAgICAgICAgaG9zdCA6IFsnNTI3OGJicy5jb20nXSwKICAgICAgICBvbkFsd2F5cyA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEFhay51dy5teWFhYnBmdW4xMiA9IGZ1bmN0aW9uICgpIHt9OwogICAgICAgIH0KICAgICAgfSwKICAgICAgdGhlc2ltc3Jlc291cmNlX2NvbSA6IHsKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXM/cT10aGVzaW1zcmVzb3VyY2UuY29tCiAgICAgICAgLy8gc291cmNlOiBodHRwOi8vcGFzdGViaW4uY29tL0RFOXJianhZCiAgICAgICAgaG9zdCA6IFsndGhlc2ltc3Jlc291cmNlLmNvbSddLAogICAgICAgIG9uQWx3YXlzIDogZnVuY3Rpb24gKCkgewogICAgICAgICAgQWFrLnV3LmdhZHNpemUgPSB0cnVlOwogICAgICAgICAgQWFrLnV3LmlIYXZlTG9hZGVkQWRzID0gdHJ1ZTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIHllbGxvd2JyaWRnZV9jb20gOiB7CiAgICAgICAgaG9zdCA6IFsneWVsbG93YnJpZGdlLmNvbSddLAogICAgICAgIG9uQWx3YXlzIDogZnVuY3Rpb24gKCkgewogICAgICAgICAgQWFrLnV3LmZpbmFsaXplUGFnZSA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgfTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGdhbWVfZGViYXRlX2NvbSA6IHsKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXMvMTM2NgogICAgICAgIC8vIHNvdXJjZTogaHR0cDovL3Bhc3RlYmluLmNvbS9VenNpWDBGSwogICAgICAgIGhvc3QgOiBbJ2dhbWUtZGViYXRlLmNvbSddLAogICAgICAgIG9uQWx3YXlzIDogZnVuY3Rpb24gKCkgewogICAgICAgICAgQWFrLnV3LmFkX2Jsb2NrX3Rlc3QgPSBmdW5jdGlvbiAoKSB7fTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGFkc2NlbmRtZWRpYSA6IHsKICAgICAgICBob3N0IDogWydhZHNjZW5kbWVkaWEuY29tJ10sCiAgICAgICAgb25TdGFydCA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIC8vIGFkc2NlbmRtZWRpYSAtIGh0dHBzOi8vd3d3LmFkc2NlbmRtZWRpYS5jb20vCiAgICAgICAgICB2YXIgcmVmID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYScpLmhyZWYgPSBkb2N1bWVudC5yZWZlcnJlcjsKICAgICAgICAgIHZhciBob3N0ID0gbG9jYXRpb24uaG9zdDsKICAgICAgICAgIHZhciBwYXRoID0gbG9jYXRpb24ucGF0aG5hbWU7CiAgICAgICAgICBpZiAoQWFrLmNvbnRhaW5zKHBhdGgsICcvd2lkZ2V0X2FkYmxvY2sucGhwJykgJiYgIUFhay5jb250YWlucyhyZWYuaG9zdCwgaG9zdCkpIHsKICAgICAgICAgICAgLy8gQXV0byByZXBvcnQKICAgICAgICAgICAgQWFrLmRldGVjdGVkKCdBZHNjZW5kbWVkaWEnLCByZWYuaG9zdCwgaG9zdCk7CiAgICAgICAgICAgIC8vIE5vdGlmaWNhdGlvbgogICAgICAgICAgICBBYWsubm90aWZpY2F0aW9uKCdZb3UgbXVzdCBzdWJzY3JpYmUgdG8gPGI+QWFrTGlzdCAoQW50aS1BZGJsb2NrIEtpbGxlciApPC9iPiA8YSBocmVmPSInICsgQWFrLnN1YnNjcmliZVVSTCArICciIHRhcmdldD0iX2JsYW5rIj5TdWJzY3JpYmU8L2E+Jyk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9LAogICAgICBhZHdvcmttZWRpYSA6IHsKICAgICAgICBob3N0IDogWydhZHdvcmttZWRpYS5jb20nLCAnbG94dGsuY29tJywgJ2NvbnRlbnRsb2NraW5nbmV0d29ya3MuY29tJ10sCiAgICAgICAgb25TdGFydCA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIC8vIEFkV29ya01lZGlhIC0gaHR0cHM6Ly93d3cuYWR3b3JrbWVkaWEuY29tLwogICAgICAgICAgdmFyIHJlZiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EnKS5ocmVmID0gZG9jdW1lbnQucmVmZXJyZXI7CiAgICAgICAgICB2YXIgaG9zdCA9IGxvY2F0aW9uLmhvc3Q7CiAgICAgICAgICB2YXIgcGF0aCA9IGxvY2F0aW9uLnBhdGhuYW1lOwogICAgICAgICAgaWYgKEFhay5jb250YWlucyhwYXRoLCAnL2hlbHAvcmVtb3ZlQUIucGhwJykgJiYgIUFhay5jb250YWlucyhyZWYuaG9zdCwgaG9zdCkpIHsKICAgICAgICAgICAgLy8gQXV0byByZXBvcnQKICAgICAgICAgICAgQWFrLmluZm8oJ0Fkd29ya21lZGlhJywgcmVmLmhvc3QsIGhvc3QpOwogICAgICAgICAgICAvLyBOb3RpZmljYXRpb24KICAgICAgICAgICAgQWFrLm5vdGlmaWNhdGlvbignWW91IG11c3Qgc3Vic2NyaWJlIHRvIDxiPkFha0xpc3QgKEFudGktQWRibG9jayBLaWxsZXIgKTwvYj4gPGEgaHJlZj0iJyArIEFhay5zdWJzY3JpYmVVUkwgKyAnIiB0YXJnZXQ9Il9ibGFuayI+U3Vic2NyaWJlPC9hPicpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSwKICAgICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAgICAgLy8gUGxheWVycwogICAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogICAgICBraXNzYW5pbWVfY29tIDogewogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcy80NTEKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXMvMzgxCiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzLzMwMgogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcy8yNTcKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXMvMTc4CiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzLzE5NgogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcy81NgogICAgICAgIGhvc3QgOiBbJ2tpc3NhbmltZS5jb20nLCAna2lzc2FuaW1lLnRvJ10sCiAgICAgICAgb25TdGFydCA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIC8vIE1hc2tpbmcgYWRzCiAgICAgICAgICBBYWsuYWRkU3R5bGUoJ2lmcmFtZVtpZF49ImFkc0lmcm1lIl0sIC5kaXZDbG9zZUJ1dCB7IGRpc3BsYXk6bm9uZTsgfScpOwogICAgICAgICAgLy8gU29sdXRpb24gMQogICAgICAgICAgQWFrLnV3LkRvRGV0ZWN0MiA9IG51bGw7CiAgICAgICAgfSwKICAgICAgICBvbklkbGUgOiBmdW5jdGlvbiAoKSB7CgogICAgICAgICAgLy8gU29sdXRpb24gMSBhYnAgcnVsZQogICAgICAgICAgLy8gQEB8fGtpc3NhbmltZS5jb21eJGVsZW1oaWRlCgogICAgICAgICAgdmFyIGRpdkNvbnRlbnRWaWRlbyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNkaXZDb250ZW50VmlkZW8nKTsKCiAgICAgICAgICAvLyBTb2x1dGlvbiAyCiAgICAgICAgICBpZiAoQWFrLnV3LkRvRGV0ZWN0MikgewogICAgICAgICAgICBBYWsudXcuRG9EZXRlY3QyID0gbnVsbDsKICAgICAgICAgICAgQWFrLnV3LkNoZWNrQWRJbWFnZSA9IG51bGw7CiAgICAgICAgICAgIEFhay5pbmZvKCdTb2x1dGlvbiAyJyk7CiAgICAgICAgICB9IC8vU29sdXRpb24gMwogICAgICAgICAgZWxzZSBpZiAoZGl2Q29udGVudFZpZGVvKSB7CgogICAgICAgICAgICB2YXIgZGl2RG93bmxvYWQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjZGl2RG93bmxvYWQnKS5jbG9uZU5vZGUodHJ1ZSk7CgogICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICBkaXZDb250ZW50VmlkZW8uaW5uZXJIVE1MID0gJyc7CiAgICAgICAgICAgICAgQWFrLnV3LkRvSGlkZUZha2UoKTsKICAgICAgICAgICAgICBkaXZDb250ZW50VmlkZW8uYXBwZW5kQ2hpbGQoZGl2RG93bmxvYWQpOwogICAgICAgICAgICAgIEFhay5yZW1vdmVFbGVtZW50KCdpZnJhbWVbaWRePSJhZHNJZnJtZSJdLCAuZGl2Q2xvc2VCdXQnKTsKICAgICAgICAgICAgICBBYWsuaW5mbygnU29sdXRpb24gMycpOwogICAgICAgICAgICB9LCA1NTAwKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0sCiAgICAgIEtpc3NjYXJ0b29uX21lIDogewogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcy80ODgKICAgICAgICBob3N0IDogWydraXNzY2FydG9vbi5tZSddLAogICAgICAgIG9uQWx3YXlzIDogZnVuY3Rpb24gKCkgewogICAgICAgICAgQWFrLnV3LnhhWmxFID0gZnVuY3Rpb24gKCkge307CiAgICAgICAgfSwKICAgICAgICBvbklkbGUgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBBYWsucmVtb3ZlRWxlbWVudCgnaWZyYW1lW2lkXj0iYWRzSWZybWUiXScpOwogICAgICAgIH0KICAgICAgfSwKICAgICAgb3BlbmxvYWRfZG9tYWlucyA6IHsKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXM/cT1vcGVubG9hZAogICAgICAgIGhvc3QgOiBbJ29wZW5sb2FkLmNvJywgJ29wZW5sb2FkLmlvJywgJ29wZW5sb2FkLnR2J10sCiAgICAgICAgb25TdGFydCA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEFhay51dy5hZGJsb2NrID0gZmFsc2U7CiAgICAgICAgICBBYWsudXcuYWRibG9jazIgPSBmYWxzZTsKICAgICAgICAgIEFhay51dy5wb3BBZHNMb2FkZWQgPSB0cnVlOwogICAgICAgICAgLy8gaGlkZSBmYWtlIHBsYXkgYnV0dG9uIHVzZWQgdG8gb3BlbiBwb3B1bmRlcgogICAgICAgICAgLy9BYWsuYWRkU3R5bGUoJyN2aWRlb292ZXJsYXkgeyBkaXNwbGF5Om5vbmU7IH0nKQogICAgICAgIH0KICAgICAgfSwKICAgICAgeW91d2F0Y2hfb3JnIDogewogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcz9xPXlvdXdhdGNoCiAgICAgICAgLy8gdGVzdDogaHR0cDovL3lvdXdhdGNoLm9yZy9lbWJlZC01OXA3aTNjZGtzZTAtNDUzeDMyMC5odG1sCiAgICAgICAgLy8gdGVzdDogaHR0cDovL3lvdXdhdGNoLm9yZy81OXA3aTNjZGtzZTAKICAgICAgICBob3N0IDogWyd5b3V3YXRjaC5vcmcnLCAnY2hvdWhhYS5pbmZvJywgJ2FoemFoZzZvaGIuY29tJywgJ2FoemFoZzZvaGIuY29tJ10sCiAgICAgICAgb25TdGFydCA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIC8vIHNraXAgYW50aS1hZGJsb2NrCiAgICAgICAgICBBYWsudXcuYWRzU2hvd1BvcHVwMSA9IDE7CiAgICAgICAgfSwKICAgICAgICBvbklkbGUgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAvLyByZW5vdmUgYWRzICsgZmFrZSBwbGF5IGJ1dHRvbgogICAgICAgICAgQWFrLnJlbW92ZUVsZW1lbnQoJyNwbGF5ZXJfaW1qLCAjcGxheWVyX2ltaiArIGRpdltpZF0nKTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGV4YXNoYXJlX2NvbSA6IHsKICAgICAgICAvLyBieTogV2F0aWxpbgogICAgICAgIC8vIHB1bGw6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvcHVsbC81MTkKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXM/cT1leGFzaGFyZS5jb20KICAgICAgICAvLyB0ZXN0OiAgaHR0cDovL2V4YXNoYXJlLmNvbS9nYWx3MmdlMmt6c3YKICAgICAgICBob3N0IDogWydleGFzaGFyZS5jb20nLCAnY2hlZnRpLmluZm8nLCAnYm9qZW0zYS5pbmZvJywgJ2FqaWhlem8uaW5mbycsICd5YWhtYWliM2FpLmNvbScsICd5YWhtYWliM2FpLmNvbSddLAogICAgICAgIG9uU3RhcnQgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAvLyBza2lwIGFudGktYWRibG9jawogICAgICAgICAgQWFrLnV3LmFkc1Nob3dQb3B1cDEgPSAxOwogICAgICAgIH0sCiAgICAgICAgb25JZGxlIDogZnVuY3Rpb24gKCkgewogICAgICAgICAgLy8gcmVub3ZlIGFkcyArIGZha2UgcGxheSBidXR0b24KICAgICAgICAgIEFhay5yZW1vdmVFbGVtZW50KCcjcGxheWVyX2dheiwgI3BsYXllcl9nYXogKyBkaXZbaWRdJyk7CiAgICAgICAgfQogICAgICB9LAogICAgICBhbjFtZV9zZSA6IHsKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXMvMTkwCiAgICAgICAgaG9zdCA6IFsnYW4xbWUuc2UnXSwKICAgICAgICBvbklkbGUgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgQWFrLnV3LmlzQmxvY2tBZHMyID0gZmFsc2U7CiAgICAgICAgICB9LCAxMDAwMCk7CiAgICAgICAgfQogICAgICB9LAogICAgICBocXFfdHYgOiB7IC8vIHB1dGxvY2tlci5pcwogICAgICAgIGhvc3QgOiBbJ2hxcS50diddLAogICAgICAgIG9uSWRsZSA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIC8vICsgYWJwIHJ1bGUKICAgICAgICAgIC8vIGh0dHA6Ly9ocXEudHYvcGxheWVyL2VtYmVkX3BsYXllci5waHA/dmlkPVIzREdIRzNHS1hYNyZhdXRvcGxheT1ubwogICAgICAgICAgaWYgKCcvcGxheWVyL2VtYmVkX3BsYXllci5waHAnID09IGxvY2F0aW9uLnBhdGhuYW1lKSB7CiAgICAgICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2Zvcm1baWRePSJmb3JtLSJdJykuc3VibWl0KCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9LAogICAgICAvLyBQb2xhbmQKICAgICAgd3BfZG9tYWlucyA6IHsKICAgICAgICAvLyBOb3RlOiBkaXNhYmxlIEVhc3lQcml2YWN5CiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzLzk1NgogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcy85MDUKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXMvMzAwCiAgICAgICAgaG9zdCA6IFsnYml6dG9rLnBsJywgJ3dwLnR2JywgJ3dwLnBsJywgJ3Nwb3J0b3dlZmFrdHkucGwnLCAna2FmZXRlcmlhLnR2JywgJ2thZmV0ZXJpYS5wbCcsICcud3J6dXRhLnBsJywgJ3B1ZGVsZWsudHYnLCAna29tZWRpb3dvLnBsJywgJ3Nmb3JhLnBsJywgJ2F1dG9rcmF0YS5wbCcsICdzcG9ydGZhbi5wbCcsICd3YXdhbG92ZS5wbCcsICdob3Rtb25leS5wbCcsICdhbGVzZXJpYWxlLnBsJywgJ2JhYm9sLnBsJywgJ3Nub2JrYS5wbCcsICdub2NvdHkucGwnLCAnbW9uZXkucGwnLCAnYWJjemRyb3dpZS5wbCcsICdnYWR6ZXRvbWFuaWEucGwnLCAnYXV0b2t1bHQucGwnLCAna29tb3Jrb21hbmlhLnBsJ10sCiAgICAgICAgb25TdGFydCA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIC8vIHByZXZlbnQgcG9wdXAgYW50aS1hZGJsb2NrIGZyb20gYWJjemRyb3dpZS5wbAogICAgICAgICAgQWFrLnNldENvb2tpZSgnQUJDQUJDJywgdHJ1ZSk7CiAgICAgICAgfSwKICAgICAgICBvbklkbGUgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAKICAgICAgICAgIEFhay5oYXNFbGVtZW50KCcud3AtcGxheWVyJywgZnVuY3Rpb24gKCkgewogICAgICAgICAgCiAgICAgICAgICAgIHZhciByZXBsYWNlUGxheWVyV1AgPSBmdW5jdGlvbiAobWlkLCBwbGF5ZXIpIHsKICAgICAgICAgICAgICAvKiBSZXF1ZXN0CiAgICAgICAgICAgICAgaHR0cDovL2dldC53cC50di8/bWlkPTE2NjEwNTYKICAgICAgICAgICAgICBodHRwOi8vd3AudHYvcGxheWVyL21pZCwxNjYxMDU2LGVtYmVkLmpzb24KICAgICAgICAgICAgICBodHRwOi8vZ2V0LndwLnR2Lz9mPTI4OTY0NjIuMTQyNjMyOTA1NjkwNC5sLndlYm0mcm5kPTEKICAgICAgICAgICAgICBodHRwczovL3dwLnR2L3BsYXllci9taWQsMTc0NzExNyxlbWJlZC5qc29uCiAgICAgICAgICAgICAgICovCiAgICAgICAgICAgICAgQWFrLnJlcXVlc3QoewogICAgICAgICAgICAgICAgdXJsIDogJ2h0dHA6Ly93cC50di9wbGF5ZXIvbWlkLCcgKyBtaWQgKyAnLGVtYmVkLmpzb24nLAogICAgICAgICAgICAgICAgb25sb2FkIDogZnVuY3Rpb24gKHJlc3VsdCkgewogICAgICAgICAgICAgICAgICB2YXIgcmVzID0gcmVzdWx0LnJlc3BvbnNlVGV4dDsKICAgICAgICAgICAgICAgICAgdmFyIG9iaiA9IEpTT04ucGFyc2UocmVzKTsKICAgICAgICAgICAgICAgICAgQWFrLmxvZyhvYmopOwoKICAgICAgICAgICAgICAgICAgdmFyIFBsYXllciA9IG5ldyBBYWsucGxheWVyKCk7CiAgICAgICAgICAgICAgICAgIFBsYXllci52aWRlb2pzKHBsYXllciwgewogICAgICAgICAgICAgICAgICAgIHNvdXJjZSA6IEFhay5maXhQcm90b2NvbFVSTChvYmouY2xpcC51cmxbMV0udXJsKSwgLy8gSEQKICAgICAgICAgICAgICAgICAgICB0eXBlIDogJ21wNCcsCiAgICAgICAgICAgICAgICAgICAgYXV0b3BsYXkgOiBmYWxzZQogICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfTsKCiAgICAgICAgICAgIHZhciByZXBsYWNlUGxheWVyV3J6dXRhID0gZnVuY3Rpb24gKGtleSwgY2hhbm5lbCwgZWxlbSkgewogICAgICAgICAgICAgIEFhay5yZXF1ZXN0KHsKICAgICAgICAgICAgICAgIC8vIGh0dHA6Ly93d3cud3J6dXRhLnBsL25wcC9lbWJlZC93b2xuYXBvbHNrYTIvMEkwSFEybXV0SmMKICAgICAgICAgICAgICAgIHVybCA6ICdodHRwOi8vd3d3LndyenV0YS5wbC9ucHAvZW1iZWQvJyArIGNoYW5uZWwgKyAnLycgKyBrZXksCiAgICAgICAgICAgICAgICBvbmxvYWQgOiBmdW5jdGlvbiAocmVzdWx0KSB7CiAgICAgICAgICAgICAgICAgIHZhciByZXMgPSByZXN1bHQucmVzcG9uc2VUZXh0OwogICAgICAgICAgICAgICAgICB2YXIgb2JqID0gSlNPTi5wYXJzZShyZXMpOwogICAgICAgICAgICAgICAgICBBYWsubG9nKG9iaik7CgogICAgICAgICAgICAgICAgICB2YXIgUGxheWVyID0gbmV3IEFhay5wbGF5ZXIoKTsKICAgICAgICAgICAgICAgICAgUGxheWVyLnZpZGVvanMoZWxlbSwgewogICAgICAgICAgICAgICAgICAgIHNvdXJjZSA6IEFhay5maXhQcm90b2NvbFVSTChvYmoudXJsWzBdLnVybCksIC8vSEQKICAgICAgICAgICAgICAgICAgICB0eXBlIDogJ21wNCcsCiAgICAgICAgICAgICAgICAgICAgYXV0b3BsYXkgOiBmYWxzZQogICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfTsKCiAgICAgICAgICAgIC8vIFVzaW5nIGFuIGV4dGVybmFsIGZsYXNoIHBsYXllciBpcyBpbXBvc3NpYmxlIGJlY2F1c2UgcHJvdGVjdGVkIGJ5IGNyb3NzZG9tYWluLnhtbAogICAgICAgICAgICB2YXIgcGxheWVycyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy53cC1wbGF5ZXInKTsgLy8gICNQbGF5ZXIwLCAjUGxheWVyMSwgI21haW5QbGF5ZXIKICAgICAgICAgICAgaWYgKHBsYXllcnMubGVuZ3RoKSB7CiAgICAgICAgICAgICAgLy8gZml4YnVnIGdtX3hociBsb29wIHJlcXVlc3QgLSBodHRwOi8vdGlueXVybC5jb20vcHFhOWh0cQogICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcGxheWVycy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICAgICAgdmFyIG1pZCA9IG51bGw7CiAgICAgICAgICAgICAgICB2YXIgcGxheWVyID0gcGxheWVyc1tpXTsKICAgICAgICAgICAgICAgIHZhciBwYXJlbnQgPSBwbGF5ZXIucGFyZW50Tm9kZTsKICAgICAgICAgICAgICAgIHZhciBzY3JpcHQgPSBwbGF5ZXIucHJldmlvdXNTaWJsaW5nOwogICAgICAgICAgICAgICAgdmFyIHRpdGxlID0gcGxheWVyLnF1ZXJ5U2VsZWN0b3IoJy50aXRsZUNvbnQgYS50aXRsZScpOwogICAgICAgICAgICAgICAgdmFyIGVtYmVkdmlkZW9zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnc2NyaXB0W3NyYyo9Ii9lbWJlZF92aWRlby5qcyJdJyk7CiAgICAgICAgICAgICAgICBBYWsubG9nKHBsYXllciwgcGFyZW50LCBzY3JpcHQsIHRpdGxlKTsKCiAgICAgICAgICAgICAgICBpZiAoZW1iZWR2aWRlb3MubGVuZ3RoKSB7CiAgICAgICAgICAgICAgICAgIC8vIHB1ZGVsZWsud3J6dXRhLnBsOiBodHRwOi8vdGlueXVybC5jb20vbDhqbzV2MgogICAgICAgICAgICAgICAgICAvLyBwdWRlbGVrLnR2OiBodHRwOi8vdGlueXVybC5jb20va2x5emg2ciwgaHR0cDovL3Rpbnl1cmwuY29tL3o3ZnI4OXYKICAgICAgICAgICAgICAgICAgLy8gcHVkZWxlay50diAodHJpcGxlKTogaHR0cDovL3Rpbnl1cmwuY29tL245YjI3bzIKICAgICAgICAgICAgICAgICAgLy8gZmlsbS53cC5wbDogaHR0cDovL3Rpbnl1cmwuY29tL3E3azVieHAKICAgICAgICAgICAgICAgICAgdmFyIGVtYmVkdmlkZW8gPSBlbWJlZHZpZGVvc1tpXTsKICAgICAgICAgICAgICAgICAgdmFyIGtleSA9IC9rZXk9KFx3KykvLmV4ZWMoZW1iZWR2aWRlby5zcmMpWzFdOwogICAgICAgICAgICAgICAgICB2YXIgY2hhbm5lbCA9IC9sb2dpbj0oXHcrKS8uZXhlYyhlbWJlZHZpZGVvLnNyYylbMV07CiAgICAgICAgICAgICAgICAgIHZhciBhdXRvc3RhcnQgPSAvYXV0b3BsYXkvLnRlc3QoZW1iZWR2aWRlby5zcmMpOwogICAgICAgICAgICAgICAgICByZXBsYWNlUGxheWVyV3J6dXRhKGtleSwgY2hhbm5lbCwgcGxheWVyLCBhdXRvc3RhcnQpOwogICAgICAgICAgICAgICAgICBBYWsubG9nKCdlbWJlZF92aWRlby5qcycpOwogICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0aXRsZSAmJiAvbWlkLy50ZXN0KHRpdGxlLmhyZWYpKSB7CiAgICAgICAgICAgICAgICAgIC8vIHNwb3J0b3dlZmFrdHkucGw6IGh0dHA6Ly90aW55dXJsLmNvbS9sNnphYmN4CiAgICAgICAgICAgICAgICAgIG1pZCA9IHRpdGxlLmhyZWYubWF0Y2goL21pZFs9LF0oWzAtOV0rKS8pOwogICAgICAgICAgICAgICAgICBBYWsubG9nKCd0aXRsZS5ocmVmJyk7CiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHBhcmVudC5pZCkgewogICAgICAgICAgICAgICAgICBpZiAocGFyZW50LmRhdGFzZXQudXJsKSB7CiAgICAgICAgICAgICAgICAgICAgLy8gd3AudHY6IGh0dHA6Ly90aW55dXJsLmNvbS9wemRlMjl0CiAgICAgICAgICAgICAgICAgICAgbWlkID0gcGFyZW50LmRhdGFzZXQudXJsLm1hdGNoKC9taWRbPSxdKFswLTldKykvKTsKICAgICAgICAgICAgICAgICAgICBBYWsubG9nKCdwYXJlbnQuZGF0YXNldC51cmwnKTsKICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICBpZiAocGFyZW50LnByZXZpb3VzU2libGluZy5pbm5lckhUTUwpIHsKICAgICAgICAgICAgICAgICAgICAgIC8vIHdpYWRvbW9zY2kud3AucGw6IGh0dHA6Ly90aW55dXJsLmNvbS9ncXR0OWNhCiAgICAgICAgICAgICAgICAgICAgICBtaWQgPSBwYXJlbnQucHJldmlvdXNTaWJsaW5nLmlubmVySFRNTC5tYXRjaCgvbWlkWz0sXShbMC05XSspLyk7CiAgICAgICAgICAgICAgICAgICAgICBBYWsubG9nKCdzY3JpcHQuaW5saW5lLmlubmVySFRNTCcpOwogICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAvLyBrYWZldGVyaWEudHY6IGh0dHA6Ly90aW55dXJsLmNvbS9ub2ZwNThhCiAgICAgICAgICAgICAgICAgICAgICAvLyBhYmN6ZHJvd2llLnBsOiBodHRwOi8vdGlueXVybC5jb20vaHg2czVldAogICAgICAgICAgICAgICAgICAgICAgbWlkID0gcGFyZW50LmlubmVySFRNTC5tYXRjaCgvbWlkWz0sXShbMC05XSspLyk7CiAgICAgICAgICAgICAgICAgICAgICBBYWsubG9nKCdwYXJlbnQuaW5uZXJIVE1MJyk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHNjcmlwdCAmJiBzY3JpcHQudGFnTmFtZSA9PSAnU0NSSVBUJykgewogICAgICAgICAgICAgICAgICAvLyBmaWxtLndwLnBsOiBodHRwOi8vdGlueXVybC5jb20vbWg5b25mdwogICAgICAgICAgICAgICAgICAvLyBwdWRlbGVrLnR2IChkb3VibGUpOiBodHRwOi8vdGlueXVybC5jb20vbGVmdnd0eAogICAgICAgICAgICAgICAgICBtaWQgPSBzY3JpcHQuaW5uZXJIVE1MLm1hdGNoKC9taWRbPSxdKFswLTldKykvKTsKICAgICAgICAgICAgICAgICAgQWFrLmxvZygnc2NyaXB0LnNyYy5pbm5lckhUTUwnKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGlmIChtaWQgIT09IG51bGwgJiYgbWlkLmxlbmd0aCA9PSAyKSB7CiAgICAgICAgICAgICAgICAgIHJlcGxhY2VQbGF5ZXJXUChtaWRbMV0sIHBsYXllcik7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIG1vamVfZmlsbXlfbmV0d29yazogewogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcy8xMDEwCiAgICAgICAgLy8gc291cmNlOiBodHRwOi8vcGFzdGViaW4uY29tLzdHMlJCbnFxCiAgICAgICAgaG9zdCA6IFsnbW9qZS1maWxteS50aycsICdtb2plLWZpbG15LmxpdmUnXSwKICAgICAgICBvbklkbGUgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICB2YXIgc2VhcmNodmFsdWUgPSBbJ3ZhciBwbGF5ZXJJbnN0YW5jZScsICd9KTsnXTsKICAgICAgICAgIHZhciBzY3JpcHQgPSBBYWsuaGFzU2NyaXB0KHNlYXJjaHZhbHVlWzBdKTsKCiAgICAgICAgICBpZiAoc2NyaXB0KSB7CiAgICAgICAgICAgIHZhciBzb3VyY2UgPSBzY3JpcHQuaW5uZXJIVE1MOwogICAgICAgICAgICB2YXIgc3RyID0gc291cmNlLnN1YnN0cmluZyhzb3VyY2UubGFzdEluZGV4T2Yoc2VhcmNodmFsdWVbMF0pLCBzb3VyY2UubGFzdEluZGV4T2Yoc2VhcmNodmFsdWVbMV0pICsgc2VhcmNodmFsdWVbMV0ubGVuZ3RoKTsKICAgICAgICAgICAgQWFrLmFkZFNjcmlwdChzdHIpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSwKICAgICAgdHZuX3BsIDogewogICAgICAgIC8vIGJ5OiBSZWVrLCBNYXJlawogICAgICAgIC8vIHNvbHV0aW9uOiBodHRwOi8vdGlueXVybC5jb20vb2hidno0ciwgaHR0cDovL3Rpbnl1cmwuY29tL2pxOHM0NjIKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXM/cT10dm4ucGwKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXM/cT10dm4yNC5wbAogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcz9xPXBsYXllci5wbAogICAgICAgIC8vIHRlc3Q6IGh0dHA6Ly90aW55dXJsLmNvbS9vNmQ5aDY2LCBodHRwOi8vdGlueXVybC5jb20vejc3bTR6aAogICAgICAgIGhvc3QgOiBbJ3R2bi5wbCcsICd0dm4yNC5wbCcsICdwbGF5ZXIucGwnXSwKICAgICAgICBvbkVuZCA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEFhay5oYXNFbGVtZW50KCdoZWFkZXIuZGV0YWlsSW1hZ2UnLCBmdW5jdGlvbiAodGhpc0VsZW1lbnQpIHsKICAgICAgICAgICAgaWYgKEFhay5nZXRDb29raWUoJ2NvdW50cnlfY29kZScpICYmIEFhay5nZXRTZXNzaW9uKCdnZW5lcmF0ZVRva2VuJykpIHsKICAgICAgICAgICAgICAgIHZhciBwYXJ0cyA9IGRvY3VtZW50LmxvY2F0aW9uLmhyZWYuc3BsaXQoL1suLF0vKTsKICAgICAgICAgICAgICAgIHZhciBpZCA9IHBhcnRzW3BhcnRzLmxlbmd0aCAtIDJdOwogICAgICAgICAgICAgICAgdmFyIHBhcmFtcyA9IHsKICAgICAgICAgICAgICAgICAgcGxhdGZvcm0gOiAiTW9iaWxlIiwKICAgICAgICAgICAgICAgICAgdGVybWluYWwgOiAiQW5kcm9pZCIsCiAgICAgICAgICAgICAgICAgIGZvcm1hdCA6ICJqc29uIiwKICAgICAgICAgICAgICAgICAgdiA6ICIyLjAiLAogICAgICAgICAgICAgICAgICBhdXRoS2V5IDogImI0YmM5NzE4NDBkZTYzZDEwNWIzMTY2NDAzYWExYmVhIiwKICAgICAgICAgICAgICAgICAgdHlwZSA6ICJlcGlzb2RlIiwKICAgICAgICAgICAgICAgICAgaWQgOiBpZCwKICAgICAgICAgICAgICAgICAgc29ydCA6ICJuZXdlc3QiLAogICAgICAgICAgICAgICAgICBtIDogImdldEl0ZW0iLAogICAgICAgICAgICAgICAgICBkZXZpY2VTY3JlZW5IZWlnaHQgOiAxNjAwLAogICAgICAgICAgICAgICAgICBkZXZpY2VTY3JlZW5XaWR0aCA6IDI1NjAKICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICB2YXIgYXBpID0gJ2h0dHBzOi8vYXBpLnR2bnBsYXllci5wbC9hcGkvPycgKyBBYWsuc2VyaWFsaXplKHBhcmFtcyk7CiAgICAgICAgICAgICAgICB2YXIgcHJveHkgPSAnaHR0cDovL3d3dy5wcm94eS54bWMucGwvaW5kZXgucGhwP2hsPTNlNSZxPSc7CQogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAvLyBHZXQgdmlkZW9VcmwKICAgICAgICAgICAgICAgIEFhay5yZXF1ZXN0KHsKICAgICAgICAgICAgICAgICAgdXJsIDogQWFrLmdldENvb2tpZSgnY291bnRyeV9jb2RlJykgIT0gJ1BMJyA/IHByb3h5ICsgQWFrLmVuY29kZVVSSShhcGkpIDogYXBpLAogICAgICAgICAgICAgICAgICBoZWFkZXJzIDogewogICAgICAgICAgICAgICAgICAgICJVc2VyLUFnZW50IiA6ICJNb3ppbGxhLzUuMCAoTGludXg7IFU7IEFuZHJvaWQgNC4yOyBlbi11czsgTmV4dXMgMTAgQnVpbGQvSlZQMTVJKSBBcHBsZVdlYktpdC81MzQuMzAgKEtIVE1MLCBsaWtlIEdlY2tvKSBWZXJzaW9uLzQuMCBTYWZhcmkvNTM0LjMwIgogICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICBvbmxvYWQgOiBmdW5jdGlvbiAocmVzdWx0KSB7CiAgICAgICAgICAgICAgICAgICAgdmFyIHJlcyA9IHJlc3VsdC5yZXNwb25zZVRleHQ7CiAgICAgICAgICAgICAgICAgICAgQWFrLmxvZyhyZXMpOwogICAgICAgICAgICAgICAgICAgIHZhciBvID0gSlNPTi5wYXJzZShyZXMpOwogICAgICAgICAgICAgICAgICAgIHZhciB2aWRlb1VybCA9IG8uaXRlbS52aWRlb3MubWFpbi52aWRlb19jb250ZW50W051bWJlcihBYWsub3B0cy52aWRlb0hEKV0udXJsOwogICAgICAgICAgICAgICAgICAgIHZhciBnZW5lcmF0ZVRva2VuID0gbmV3IEZ1bmN0aW9uKCd2aWRlb1VybCcsIEFhay5nZXRTZXNzaW9uKCdnZW5lcmF0ZVRva2VuJykpOwogICAgICAgICAgICAgICAgICAgIHZhciB2aWRlb1VybFdpdGhTZWVkID0gZ2VuZXJhdGVUb2tlbih2aWRlb1VybCk7CiAgICAgICAgICAgICAgICAgICAgdmFyIFBsYXllciA9IG5ldyBBYWsucGxheWVyKCk7CiAgICAgICAgICAgICAgICAgICAgUGxheWVyLnZpZGVvanModGhpc0VsZW1lbnQsIHsKICAgICAgICAgICAgICAgICAgICAgIHNvdXJjZSA6IHZpZGVvVXJsV2l0aFNlZWQsCiAgICAgICAgICAgICAgICAgICAgICB0eXBlIDogJ21wNCcsCiAgICAgICAgICAgICAgICAgICAgICBhdXRvcGxheTogZmFsc2UKICAgICAgICAgICAgICAgICAgICB9LCB7fSwge2luc2VydDonaW5uZXInfSk7CiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIEFhay5yZXF1ZXN0KHsgLy8gZ2V0IGFuZCBzdG9yZSBnZW5lcmF0ZVRva2VuIGZ1bmN0aW9uCiAgICAgICAgICAgICAgICB1cmwgOiAnaHR0cDovL3Bhc3RlYmluLmNvbS9yYXcvRDlxTTREUjMnLAogICAgICAgICAgICAgICAgb25sb2FkIDogZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgICAgICAgICAgIHZhciByZXMgPSByZXNwb25zZS5yZXNwb25zZVRleHQ7CiAgICAgICAgICAgICAgICAgIEFhay5zZXRTZXNzaW9uKCdnZW5lcmF0ZVRva2VuJywgcmVzKTsKICAgICAgICAgICAgICAgICAgQWFrLnJlcXVlc3QoeyAvLyBnZXQgdXNlciBpcAogICAgICAgICAgICAgICAgICAgIHVybCA6ICdodHRwOi8vaXAtYXBpLmNvbS9qc29uJywKICAgICAgICAgICAgICAgICAgICBvbmxvYWQgOiBmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICAgICAgICAgICAgICAgIHZhciByZXMgPSByZXNwb25zZS5yZXNwb25zZVRleHQ7CiAgICAgICAgICAgICAgICAgICAgICB2YXIganNvbiA9IEpTT04ucGFyc2UocmVzKTsKICAgICAgICAgICAgICAgICAgICAgIEFhay5zZXRDb29raWUoJ2NvdW50cnlfY29kZScsIGpzb24uY291bnRyeUNvZGUpOwogICAgICAgICAgICAgICAgICAgICAgQWFrLnJlZnJlc2goKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9CiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGlwbGFfdHYgOiB7CiAgICAgICAgLy8gYnk6IE1hcmVrCiAgICAgICAgLy8gc29sdXRpb246IGh0dHA6Ly90aW55dXJsLmNvbS9wdGI0eWJnCiAgICAgICAgLy8gaXNzdWUuIGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzLzUyMgogICAgICAgIC8vIHRlc3Q6IGh0dHA6Ly90aW55dXJsLmNvbS9oejdncHh4CiAgICAgICAgaG9zdCA6IFsnaXBsYS50diddLAogICAgICAgIG9uSWRsZSA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEFhay5hZGRTdHlsZSgnLmh0bWw1LXBsYXllci13cmFwcGVyIHsgZGlzcGxheTpub25lOyB9Jyk7IC8vIGNocm9tZS9vcGVyYQogICAgICAgICAgdmFyIG9sZFBsYXllciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5odG1sNS1wbGF5ZXItd3JhcHBlciwgI3ZvZC1wbGF5ZXInKTsKICAgICAgICAgIEFhay5yZXF1ZXN0KHsKICAgICAgICAgICAgdXJsIDogJy9WT0QvcGxheS1pbi1pcGxhLycgKyBsb2NhdGlvbi5ocmVmLm1hdGNoKC9cL3ZvZC0oXGQrKS8pWzFdLAogICAgICAgICAgICBvbmxvYWQgOiBmdW5jdGlvbiAocmVzdWx0KSB7CiAgICAgICAgICAgICAgdmFyIHZpZGVvVVJMOwogICAgICAgICAgICAgIHZhciByZXMgPSByZXN1bHQucmVzcG9uc2VUZXh0OwogICAgICAgICAgICAgIHZhciBpZG4gPSByZXMubWF0Y2goL2lwbGE6XC9cL3BsYXl2b2QtMVx8KFthLXowLTldKykvKVsxXTsKICAgICAgICAgICAgICBBYWsubG9nKGlkbik7CiAgICAgICAgICAgICAgQWFrLnJlcXVlc3QoewogICAgICAgICAgICAgICAgdXJsIDogJ2h0dHA6Ly9nZXRtZWRpYS5yZWRlZmluZS5wbC92b2RzL2dldF92b2QvP2NwaWQ9MSZ1YT1taXBsYS8yMyZtZWRpYV9pZD0nICsgaWRuLAogICAgICAgICAgICAgICAgb25sb2FkIDogZnVuY3Rpb24gKHJlc3VsdCkgewogICAgICAgICAgICAgICAgICB2YXIgcmVzID0gcmVzdWx0LnJlc3BvbnNlVGV4dDsKICAgICAgICAgICAgICAgICAgdmFyIG8gPSBKU09OLnBhcnNlKHJlcyk7CiAgICAgICAgICAgICAgICAgIEFhay5sb2cobyk7CiAgICAgICAgICAgICAgICAgIGlmIChvLnZvZC52aWRlb19oZCkgewogICAgICAgICAgICAgICAgICAgIHZpZGVvVVJMID0gby52b2QudmlkZW9faGQ7CiAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoby52b2QudmlkZW8pIHsKICAgICAgICAgICAgICAgICAgICB2aWRlb1VSTCA9IG8udm9kLnZpZGVvOwogICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIHZpZGVvVVJMID0gby52b2QuY29waWVzWzBdLnVybDsKICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgdmFyIFBsYXllciA9IG5ldyBBYWsucGxheWVyKCk7CiAgICAgICAgICAgICAgICAgIFBsYXllci52aWRlb2pzKG9sZFBsYXllciwgewogICAgICAgICAgICAgICAgICAgIHNvdXJjZSA6IHZpZGVvVVJMLAogICAgICAgICAgICAgICAgICAgIHR5cGUgOiAnbXA0JywKICAgICAgICAgICAgICAgICAgICB3aWR0aCA6IDgyMCwKICAgICAgICAgICAgICAgICAgICBoZWlnaHQgOiA0NTAsCiAgICAgICAgICAgICAgICAgICAgYXV0b3BsYXkgOiBmYWxzZQogICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfQogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9LAogICAgICBrb3NjaWFuX25ldCA6IHsKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXMvOTE0CiAgICAgICAgLy8gc291cmNlOiBodHRwOi8vcGFzdGViaW4uY29tL3lHU1BCUnFlCiAgICAgICAgaG9zdCA6IFsna29zY2lhbi5uZXQnXSwKICAgICAgICBvbklkbGUgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICB2YXIgZWxlbXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuYmFuJyk7CiAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGVsZW1zLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIGVsZW1zW2ldLnJlbW92ZSgpOwogICAgICAgICAgICAvL2VsZW1zW2ldLmlubmVySFRNTCA9ICc8YnI+JzsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0sCiAgICAgIC8vIEZyYW5jZQogICAgICBwbGF5dHZfZnIgOiB7IC8vIHJlc2VhcmNoIHNvbHV0aW9uCiAgICAgICAgaG9zdCA6IFsncGxheS50dicsICdwbGF5dHYuZnInXSwKICAgICAgICBvbkFsd2F5cyA6IGZ1bmN0aW9uICgpIHt9LAogICAgICAgIG9uRW5kIDogZnVuY3Rpb24gKCkge30KICAgICAgfSwKICAgICAgcm1jc3BvcnRiZm10dl9jb20gOiB7IC8vIHdlYnJhZGlvCiAgICAgICAgaG9zdCA6IFsncm1jc3BvcnQuYmZtdHYuY29tJ10sCiAgICAgICAgb25JZGxlIDogZnVuY3Rpb24gKCkgewoKICAgICAgICAgIHZhciBmbGFzaHZhcnMgPSB7CiAgICAgICAgICAgIHVybFJhZGlvIDogImh0dHA6Ly9tcDNsZzQudGRmLWNkbi5jb20vMTAxNjAvcm1jLm1wMyIsCiAgICAgICAgICAgIG5vbSA6ICJsaXZlIiwKICAgICAgICAgICAgY2F0ZWdvcmllIDogImxpdmUiLAogICAgICAgICAgICB1cmxTbWFydCA6ICIiIC8vIHNldCBlbXB0eSB0byByZW1vdmUgYXVkaW8gYWQKICAgICAgICAgIH07CiAgICAgICAgICB2YXIgcGFyYW1zID0gewogICAgICAgICAgICB3bW9kZSA6ICJ0cmFuc3BhcmVudCIKICAgICAgICAgIH07CgogICAgICAgICAgQWFrLnV3LnN3Zm9iamVjdC5lbWJlZFNXRigiL3N3Zi9STUNMSVZFLnN3ZiIsICJsaXZlcGxheWVyIiwgIjcwIiwgIjkwIiwgIjEwLjAuMCIsICIiLCBmbGFzaHZhcnMsIHBhcmFtcyk7CiAgICAgICAgfQogICAgICB9LAogICAgICBlY2x5cHNpYV9jb20gOiB7CiAgICAgICAgaG9zdCA6IFsnZWNseXBzaWEuY29tJ10sCiAgICAgICAgb25BbHdheXMgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAvLyBTb2x1dGlvbiAxCiAgICAgICAgICAvLyBhYnAgcnVsZXMKCiAgICAgICAgICAvLyBTb2x1dGlvbiAyCiAgICAgICAgICBBYWsudXcuaXNBQkFjdGl2YXRlZCA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAgfTsgLy8gS2lsbCBhbnRpYWRibG9jawogICAgICAgICAgQWFrLnV3LnJlZnJlc2hfaWZyYW1lID0gZnVuY3Rpb24gKCkge307IC8vIFN0b3AgYWRzIHRvIGJlIGxvYWRlZAogICAgICAgIH0sCiAgICAgICAgb25FbmQgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAvLyBTb2x1dGlvbiAzCiAgICAgICAgICB2YXIgZWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2RpdltpZF49IndlYnR2X2lmcmFtZV8iXScpOwogICAgICAgICAgaWYgKGVsZW1lbnQgIT09IG51bGwpIHsKICAgICAgICAgICAgdmFyIHZpZGVvSWQgPSBlbGVtZW50LmlkLnNwbGl0KCdfJylbMl07CiAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgIGVsZW1lbnQuaW5uZXJIVE1MID0gJzxpZnJhbWUgZnJhbWVib3JkZXI9IjAiIHdpZHRoPSI4MTIiIGhlaWdodD0iNTAwIiBzcmM9Imh0dHA6Ly93d3cuZGFpbHltb3Rpb24uY29tL2VtYmVkL3ZpZGVvLycgKyB2aWRlb0lkICsgJz9sb2dvPTAmYXV0b1BsYXk9MSZhdXRvTXV0ZT0wIj48L2lmcmFtZT4nOwogICAgICAgICAgICB9LCAxMDAwKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0sCiAgICAgIG02d2ViX2ZyIDogewogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcy80NjEKICAgICAgICAvLyB0ZXN0OiBodHRwOi8vdGlueXVybC5jb20vcHRuMnZybAogICAgICAgIGhvc3QgOiBbJ202d2ViLmZyJ10sCiAgICAgICAgb25FbmQgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICB2YXIgcGxheWVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcignb2JqZWN0W2lkJD0iX2ZsYXNoX2FwaSJdJyk7CiAgICAgICAgICB2YXIgc2NyaXB0ID0gQWFrLmhhc1NjcmlwdCgnTTYuUGxheWVyLmNvbmZpZycpOwoKICAgICAgICAgIGlmIChwbGF5ZXIgIT09IG51bGwgJiYgc2NyaXB0ICE9PSBudWxsKSB7CiAgICAgICAgICAgIHZhciBmb3VuZCA9IHNjcmlwdC5pbm5lckhUTUwubWF0Y2goL002LlBsYXllci5jb25maWcgPSAoXHsuK1x9KTsvKTsKICAgICAgICAgICAgdmFyIGNvbmZpZyA9IEpTT04ucGFyc2UoZm91bmQucG9wKCkpOwogICAgICAgICAgICAKICAgICAgICAgICAgLy8gUmVwbGFjZSBwbGF5ZXIKICAgICAgICAgICAgdmFyIFBsYXllciA9IG5ldyBBYWsucGxheWVyKCk7CiAgICAgICAgICAgIFBsYXllci52aWRlb2pzKHBsYXllci5wYXJlbnROb2RlLCB7CiAgICAgICAgICAgICAgc291cmNlIDogY29uZmlnLnNvdXJjZXNbMV0uc3JjLAogICAgICAgICAgICAgIHR5cGUgOiAnbXA0JywKICAgICAgICAgICAgICBhdXRvcGxheSA6IGZhbHNlCiAgICAgICAgICAgIH0pOwoKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0sCiAgICAgIGdhbWluZ3Jvb21fdHYgOiB7CiAgICAgICAgaG9zdCA6IFsnZ2FtaW5ncm9vbS50diddLAogICAgICAgIG9uQWx3YXlzIDogZnVuY3Rpb24gKCkgewogICAgICAgICAgQWFrLnV3LmFkYmxvY2tfZGV0ZWN0ID0gZnVuY3Rpb24gKCkge307CiAgICAgICAgICBBYWsudXcuR1JfYWRibG9ja19oaWRlX3ZpZGVvID0gZnVuY3Rpb24gKCkge307CiAgICAgICAgICBBYWsudXcuYWRibG9ja192aWRlb19tc2dfc3RhcnQgPSBmdW5jdGlvbiAoKSB7fTsKICAgICAgICAgIEFhay51dy5hZGJsb2NrX3ZpZGVvX21zZ19zdG9wID0gZnVuY3Rpb24gKCkge307CiAgICAgICAgICBBYWsudXcuZGlzYWJsZV9jaGF0ID0gZnVuY3Rpb24gKCkge307CiAgICAgICAgfQogICAgICB9LAogICAgICAvLyBHZXJtYW55CiAgICAgIG5vd19kb21haW5zIDogewogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcy8zMzYKICAgICAgICAvLyB0ZXN0OiBodHRwOi8vdGlueXVybC5jb20vcGVlb2JvdQogICAgICAgIC8vIHRlc3Q6IGh0dHA6Ly9qc2Jpbi5jb20vdnVjb2Jlam9mbwogICAgICAgIGhvc3QgOiBbJ3ZveG5vdy5kZScsICdydGwtbm93LnJ0bC5kZScsICdydGwybm93LnJ0bDIuZGUnLCAnbi10dm5vdy5kZScsICdzdXBlcnJ0bG5vdy5kZScsICdydGxuaXRyb25vdy5kZScsICdub3d0di5kZSddLAogICAgICAgIG9uSWRsZSA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIC8qCiAgICAgICAgICB2YXIgUGxheWVyID0gbmV3IEFhay5wbGF5ZXIoKTsKICAgICAgICAgIFBsYXllci5lZGl0aW5nKCcjdmlkZW9wbGF5ZXInLCB7CiAgICAgICAgICB1bnNldEZsYXNodmFycyA6ICdhYmNoZWNrX2VuYWJsZWQsYWRjYWxsLGFkY2xhc3NlcyxhZGNvbmZpZyxhZG1ldGEsYWRzbG9nLGFnb2YsYW1hLGFuZ2Vib3QsYXMsYXNwYXJ0cyxicmVha2FkLGNvbm5lY3Rpb25jaGVjayxjc2xvZyxkZXYsZGltbWVyLGVycm9ybG9nLGZlZWRiYWNrLGZtc2lkZW50LGd0dixoaWdobGlnaHRzLGl2dyxpdndfcGxheSxqcyxqc19ldmVudF9mdW5jdGlvbixsb2dvLGxvZ29fYmFzZXdpZHRoLGxvZ29wb3MsbmllbHNlbixvcmQsb3NtZixzdm0sdGlsZSx2aWRlb3BsYXphLHZpZGVvcGxhemFfYmFzZV91cmwsdmlkZW9wbGF6YV9zaGFyZSx2aWRlb3BsYXphX3RhZyx2cEVudmlyb25tZW50VVJMLHhsJwogICAgICAgICAgfSk7CiAgICAgICAgICAgKi8KICAgICAgICB9CiAgICAgIH0sCiAgICAgIHJ0bF9kZSA6IHsKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXMvMTU0MQogICAgICAgIC8vIHRlc3Q6IGh0dHA6Ly90aW55dXJsLmNvbS9oN2NjdnFxCiAgICAgICAgaG9zdCA6IFsncnRsLmRlJ10sCiAgICAgICAgb25JZGxlIDogZnVuY3Rpb24gKCkgewogICAgICAgICAgQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnZGl2W2RhdGEtd2lkZ2V0PSJ2aWRlbyJdJykpLm1hcChmdW5jdGlvbiAodmlkZW8pIHsKICAgICAgICAgICAgdmFyIGNmZyA9IEFhay5pbnRvT2JqZWN0KHZpZGVvLmRhdGFzZXQucGxheWVyTGF5ZXJDZmcpOwogICAgICAgICAgICB2YXIgZmlsZSA9IGNmZy52aWRlb2luZm8ubXA0dXJsOwogICAgICAgICAgICBBYWsubG9nKHZpZGVvLCBjZmcsIGZpbGUpOwoKICAgICAgICAgICAgLy8gUmVwbGFjZSBwbGF5ZXIKICAgICAgICAgICAgdmFyIFBsYXllciA9IG5ldyBBYWsucGxheWVyKCk7CiAgICAgICAgICAgIFBsYXllci52aWRlb2pzKHZpZGVvLCB7CiAgICAgICAgICAgICAgc291cmNlIDogZmlsZSwKICAgICAgICAgICAgICB0eXBlIDogJ21wNCcsCiAgICAgICAgICAgICAgYXV0b3BsYXkgOiBmYWxzZQogICAgICAgICAgICB9KTsKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfSwKICAgICAgbXlzcGFzc19kZSA6IHsKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXMvNzYKICAgICAgICAvLyB0ZXN0OiBodHRwOi8vdGlueXVybC5jb20vbHRvOXB5ZAogICAgICAgIGhvc3QgOiBbJ215c3Bhc3MuZGUnXSwKICAgICAgICBvbklkbGUgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICB2YXIgdmlkZW9pZCA9IGxvY2F0aW9uLnBhdGhuYW1lLm1hdGNoKC9cLyhcZCspXC8kLyk7CgogICAgICAgICAgaWYgKHZpZGVvaWQgIT09IG51bGwpIHsKICAgICAgICAgICAgQWFrLnJlcXVlc3QoewogICAgICAgICAgICAgIHVybCA6ICdodHRwOi8vd3d3Lm15c3Bhc3MuZGUvbXlzcGFzcy9pbmNsdWRlcy9hcHBzL3ZpZGVvL2dldHZpZGVvbWV0YWRhdGF4bWwucGhwP2lkPScgKyB2aWRlb2lkWzFdLAogICAgICAgICAgICAgIG9ubG9hZCA6IGZ1bmN0aW9uIChyZXN1bHQpIHsKICAgICAgICAgICAgICAgIHZhciByZXMgPSByZXN1bHQucmVzcG9uc2VUZXh0OwogICAgICAgICAgICAgICAgQWFrLmxvZyhyZXMpOwoKICAgICAgICAgICAgICAgIC8vIEdldCB2aWRlbwogICAgICAgICAgICAgICAgdmFyIHBhcnNlciA9IG5ldyB3aW5kb3cuRE9NUGFyc2VyKCk7CiAgICAgICAgICAgICAgICB2YXIgZG9tID0gcGFyc2VyLnBhcnNlRnJvbVN0cmluZyhyZXMsICJhcHBsaWNhdGlvbi94bWwiKTsKICAgICAgICAgICAgICAgIHZhciBmaWxlID0gZG9tLmdldEVsZW1lbnRzQnlUYWdOYW1lKCJ1cmxfZmx2IikuaXRlbSgwKS50ZXh0Q29udGVudDsKCiAgICAgICAgICAgICAgICAvLyBSZW1vdmUgZWxlbWVudHMKICAgICAgICAgICAgICAgIEFhay5yZW1vdmVFbGVtZW50KCdkaXYubG9hZGluZ0dpZicpOwoKICAgICAgICAgICAgICAgIC8vIFJlcGxhY2UgcGxheWVyCiAgICAgICAgICAgICAgICB2YXIgUGxheWVyID0gbmV3IEFhay5wbGF5ZXIoKTsKICAgICAgICAgICAgICAgIFBsYXllci52aWRlb2pzKCcjcGxheWVyJywgewogICAgICAgICAgICAgICAgICBzb3VyY2UgOiBmaWxlLAogICAgICAgICAgICAgICAgICB0eXBlIDogJ21wNCcsCiAgICAgICAgICAgICAgICAgIGF1dG9wbGF5IDogZmFsc2UKICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSwKICAgICAgLy8gTmVkZXJsYW5kCiAgICAgIHJ0bHhsX25sIDogewogICAgICAgIC8vIHRlc3Q6IGh0dHA6Ly90aW55dXJsLmNvbS9sMnprdjNkCiAgICAgICAgaG9zdCA6IFsncnRseGwubmwnLCAncnRsbmlldXdzLm5sJ10sCiAgICAgICAgb25FbmQgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICB2YXIgUGxheWVyID0gbmV3IEFhay5wbGF5ZXIoKTsKICAgICAgICAgIFBsYXllci5lZGl0aW5nKCcjX3J0bG9zbWYwJywgewogICAgICAgICAgICBzZXRGbGFzaHZhcnMgOiB7CiAgICAgICAgICAgICAgYWRibG9jayA6IGZhbHNlCiAgICAgICAgICAgIH0KICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfSwKICAgICAgLy8gTm9yd2F5CiAgICAgIHZndHZfbmV0d29yayA6IHsKICAgICAgICAvLyBub3RlOiBza2lwIHZpZGVvIGFkcyArIGFudGktYWRibG9jawogICAgICAgIC8vIGp3cGxheWVyOiBodHRwOi8vdGlueXVybC5jb20venl2NzloZwogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcy8xNDAyCiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzLzM2NwogICAgICAgIC8vIHRlc3Q6IGh0dHA6Ly90aW55dXJsLmNvbS9ud3A4NXQsIGh0dHA6Ly90aW55dXJsLmNvbS9ud3A4NXQKICAgICAgICBob3N0IDogWyd2Z3R2Lm5vJywgJ3ZnLm5vJ10sCiAgICAgICAgb25FbmQgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICB2YXIgb2xkSGFzaCA9IG51bGw7CiAgICAgICAgICB2YXIgdmlkZW9JZCA9IG51bGw7CiAgICAgICAgICB2YXIgdmlkZW9JZFJlZ2V4ID0gLyNcIVwvdmlkZW9cLyhcZCspXC8vOwoKICAgICAgICAgIC8vIGNoZWNrIGlmIHRoZSBsb2NhdGlvbiBoYXNoIGNoYW5nZXMKICAgICAgICAgIHNldEludGVydmFsKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgdmFyIHBsYXllciA9IEFhay5nZXRFbGVtZW50KCcudmlkZW8tcGxheWVyJyk7CgogICAgICAgICAgICBpZiAocGxheWVyICYmIGxvY2F0aW9uLmhhc2ggIT0gb2xkSGFzaCAmJiB2aWRlb0lkUmVnZXgudGVzdChsb2NhdGlvbi5oYXNoKSkgewogICAgICAgICAgICAgIG9sZEhhc2ggPSBsb2NhdGlvbi5oYXNoOwogICAgICAgICAgICAgIHZpZGVvSWQgPSBvbGRIYXNoLm1hdGNoKHZpZGVvSWRSZWdleClbMV07Ci8qCiAgICAgICAgICAgICAgdmFyIGhsc3VybCA9ICdodHRwczovL3N2cHNlY3VyZWhkdm9kLXZoLmFrYW1haWhkLm5ldC9pLzIwMTYvMDMvMjAxNjAzMTJfNTZlNDIxZjg2YWY0NV92ZzAxLywxMjgwXzcyMF8zNTAwLDk2MF81NDBfMTUwMCw2NDBfMzYwXzgwMCw0ODBfMjcwXzUwMCwubXA0LmNzbWlsL21hc3Rlci5tM3U4JzsKICAgICAgICAgICAgICBjb25zb2xlLmxvZyhwbGF5ZXIpCgogICAgICAgICAgICAgIC8vIGRvbid0IHdvcmsgd2l0aCBjaHJvbWUKICAgICAgICAgICAgICAvLyBwbGF5ZXIuaW5uZXJIVE1MID0gJzxkaXYgaWQ9Im5vQWRQbGF5ZXIiPlRoaXMgdGV4dCB3aWxsIGJlIHJlcGxhY2VkIHdpdGggYSBwbGF5ZXIuPC9kaXY+JzsKCgogICAgICAgICAgICAgIC8vIGNhbid0IGxvYWQgbTN1OCA0MDMyIHN0YXR1cyBjb2RlCiAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyh1bnNhZmVXaW5kb3cuandwbGF5ZXIpCgogICAgICAgICAgICAgIEFhay5yZXF1ZXN0KHsKICAgICAgICAgICAgICAgIHVybCA6ICdodHRwOi8vc3ZwLnZnLm5vL3N2cC9hcGkvdjEvdmd0di9hc3NldHMvJyArIHZpZGVvSWQgKyAnP2FkZGl0aW9uYWw9c2V0dGluZ3N8Y2hhcHRlcnN8Y3VlUG9pbnRzfGV4dGVybmFsSWR8YmFycmVsc3xleHRlcm5hbENhdGVnb3J5SWR8bmV4dEFzc2V0JmFwcE5hbWU9dmd0di13ZWJzaXRlJywKICAgICAgICAgICAgICAgIG9ubG9hZCA6IGZ1bmN0aW9uIChyZXN1bHQpIHsKICAgICAgICAgICAgICAgICAgdmFyIHJlcyA9IHJlc3VsdC5yZXNwb25zZVRleHQ7CiAgICAgICAgICAgICAgICAgIHZhciBvYmogPSBKU09OLnBhcnNlKHJlcyk7CiAgICAgICAgICAgICAgICAgIEFhay5sb2cob2JqKTsKCiAgICAgICAgICAgICAgICAgIC8vIHJlcGxhY2UgcGxheWVyCiAgICAgICAgICAgICAgICAgIHZhciBQbGF5ZXIgPSBuZXcgQWFrLnBsYXllcigpOwogICAgICAgICAgICAgICAgICBQbGF5ZXIudmxjKHBsYXllciwgewogICAgICAgICAgICAgICAgICAgIHNvdXJjZSA6IG9iai5zdHJlYW1VcmxzLmhscywgLy8gbTN1OAogICAgICAgICAgICAgICAgICAgIHR5cGUgOiAnaGxzJywKICAgICAgICAgICAgICAgICAgICBhdXRvcGxheSA6IGZhbHNlCiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0sIHt9LCB7CiAgICAgICAgICAgICAgICBpbnNlcnQgOiAnaW5uZXInCiAgICAgICAgICAgICAgfSk7CiovCiAgICAgICAgICAgIH0KICAgICAgICAgIH0sIDFlMyk7CiAgICAgICAgfQogICAgICB9LAogICAgICBtdGdfcmFkaW8gOiB7CiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzLzE0OTUKICAgICAgICBob3N0IDogWydwbGF5LnJhZGlvMS5zZScsICdwbGF5LmJhbmRpdC5zZScsICdwbGF5Lmx1Z25hZmF2b3JpdGVyLmNvbScsICdwbGF5LnJpeGZtLnNlJ10sCiAgICAgICAgb25FbmQgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBBYWsuYWRkU2NyaXB0KGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgd2luZG93LnBsYXllcl9sb2FkX2xpdmUod2luZG93LnN0cmVhbV9pZCk7CiAgICAgICAgICAgIH0sIDEwMDApOwogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9LAogICAgICBkcGxheV9uZXR3b3JrIDogewogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcy8xNDYzCiAgICAgICAgaG9zdCA6IFsnZHBsYXkuY29tJywgJ2RwbGF5LmRrJywgJ2RwbGF5LnNlJ10sCiAgICAgICAgb25TdGFydCA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHZhciBkYXRlID0gbmV3IERhdGUoKTsKICAgICAgICAgIGRhdGUuc2V0RGF0ZShkYXRlLmdldERhdGUoKSArIDM2NSk7CiAgICAgICAgICB2YXIgdGltZXN0YW1wID0gZGF0ZS5nZXRUaW1lKCkudG9TdHJpbmcoKTsKICAgICAgICAgIHZhciB2YWx1ZSA9IEpTT04uc3RyaW5naWZ5KHsKICAgICAgICAgICAgICAibm90aWZpY2F0aW9uU3VibWlzc2lvbiIgOiAic3VibWl0dGVkIiwKICAgICAgICAgICAgICAicmVwb3J0aW5nRXhwaXJ5IiA6IHRpbWVzdGFtcCwKICAgICAgICAgICAgICAibm90aWZpY2F0aW9uRXhwaXJ5IiA6IHRpbWVzdGFtcAogICAgICAgICAgICB9KTsKICAgICAgICAgIEFhay5zZXRDb29raWUoJ2RzYy1hZGJsb2NrJywgdmFsdWUpOwogICAgICAgIH0KICAgICAgfSwKICAgICAgdmlhc2F0X3R2IDogewogICAgICAgIC8vIG5vdGU6IHNraXAgdmlkZW8gYWRzICsgYW50aS1hZGJsb2NrCiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzP3E9dHYzcGxheQogICAgICAgIC8qIHRlc3Q6IGh0dHA6Ly93d3cudHYzcGxheS5uby9wcm9ncmFtbWVyL3JlZG5pbmdzc2tveXRhIGhkcy9obHMKICAgICAgICAgICAgICAgICAgIGh0dHA6Ly93d3cudHYzcGxheS5kay9wcm9ncmFtbWVyL2xpbnNlLW9nLWRpZGRlLWVrc3RyYSBoZHMvaGxzCiAgICAgICAgICAgICAgICAgICBodHRwOi8vd3d3LnR2M3BsYXkuc2UvcHJvZ3JhbS9nbGFtb3VyYW1hIGhkcy9obHMKICAgICAgICAgICAgICAgICAgIGh0dHA6Ly93d3cudHY2cGxheS5zZS9wcm9ncmFtLzk5LXNha2VyLW1hbi1tYXN0ZS1nb3JhLWlubmFuLW1hbi1kb3IgaGRzL2hscwogICAgICAgICAgICAgICAgICAgaHR0cDovL3d3dy50djhwbGF5LnNlL3Byb2dyYW0vZWZ0ZXJseXN0LS0xIGhkcy9obHMKICAgICAgICAgICAgICAgICAgIGh0dHA6Ly93d3cudHYxMHBsYXkuc2UvcHJvZ3JhbS9nYXJwZW5zLWV1cm9wYSBoZHMvaGxzCiAgICAgICAgICAgICAgICAgICBodHRwOi8vdHZwbGF5LnNrYXRpZXMubHYvcGFycmFpZGVzL3R2My16aW5hcyBoZHMvaGxzCiAgICAgICAgICAgICAgICAgICBodHRwOi8vcGxheS50djMubHQvcHJvZ3JhbW9zL2JlYXRvcy12aXJ0dXZlIHJ0bXAvaGxzCiAgICAgICAgICAgICAgICAgICBodHRwOi8vdHYzcGxheS50djMuZWUvc2lzdS9wdWhhcGFldi1zZXBvZ2EgcnRtcC9obHMgKi8KICAgICAgICBob3N0IDogWyd0djNwbGF5Lm5vJywgJ3R2M3BsYXkuZGsnLCAndHYzcGxheS5zZScsICd0djZwbGF5LnNlJywgJ3R2OHBsYXkuc2UnLCAndHYxMHBsYXkuc2UnLCAndHZwbGF5LnNrYXRpZXMubHYnLCAncGxheS50djMubHQnLCAndHYzcGxheS50djMuZWUnXSwKICAgICAgICBvbklkbGUgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBBYWsuaGFzRWxlbWVudCgnI3ZpZGVvLXBsYXllcicsIGZ1bmN0aW9uICh0aGlzRWxlbWVudCkgewogICAgICAgICAgICB0aGlzRWxlbWVudC5pZCA9ICcnOwogICAgICAgICAgICAvL3ZhciB2aWRlb0lkID0gbG9jYXRpb24ucGF0aG5hbWUuc3BsaXQoJy8nKS5wb3AoKTsKICAgICAgICAgICAgdmFyIHZpZGVvSWQgPSB0aGlzRWxlbWVudC5nZXRBdHRyaWJ1dGUoJ2RhdGEtdmlkZW8taWQnKTsKICAgICAgICAgICAgQWFrLmxvZyh0aGlzRWxlbWVudCwgdmlkZW9JZCk7CgogICAgICAgICAgICAvLyBnZXQgdmlkZW8gc291cmNlcwogICAgICAgICAgICBBYWsucmVxdWVzdCh7CiAgICAgICAgICAgICAgdXJsIDogJ2h0dHA6Ly9wbGF5YXBpLm10Z3gudHYvdjMvdmlkZW9zL3N0cmVhbS8nICsgdmlkZW9JZCwKICAgICAgICAgICAgICBvbmxvYWQgOiBmdW5jdGlvbiAocmVzdWx0KSB7CiAgICAgICAgICAgICAgICB2YXIgcmVzID0gcmVzdWx0LnJlc3BvbnNlVGV4dDsKICAgICAgICAgICAgICAgIHZhciBvYmogPSBKU09OLnBhcnNlKHJlcyk7CiAgICAgICAgICAgICAgICBBYWsubG9nKG9iaik7CgogICAgICAgICAgICAgICAgLyogSW5uaG9sZGV0IGR1IHByw7h2ZXIgw6Ugc2UgZXIga3VuIHRpbGdqZW5nZWxpZyBmb3IgYnJ1a2VyZSBpIE5vcmdlCiAgICAgICAgICAgICAgICBQcm9ncmFtbWV0IGVyIGJsb2tlcmV0IGZvciB2aXNuaW5nIGZyYSBkZW5uZSBnZW9ncmFmaXNrZSBwb3NpdGlvbi4KICAgICAgICAgICAgICAgIFByb2dyYW3EhSBnYWxpdGUgbWF0eXRpIHRpayBqdW5nZGFtaWVzaSBpxaEgTGlldHV2b3MgaW50ZXJuZXRvIHRpZWvEl2rFsyB0aW5rbMWzICovCiAgICAgICAgICAgICAgICBpZiAob2JqLm1zZykgewogICAgICAgICAgICAgICAgICByZXR1cm4gdGhpc0VsZW1lbnQuaW5uZXJIVE1MID0gb2JqLm1zZzsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBpZiAobG9jYXRpb24uaG9zdCA9PT0gJ3R2M3BsYXkudHYzLmVlJykgewogICAgICAgICAgICAgICAgICB2YXIgUGxheWVyID0gbmV3IEFhay5wbGF5ZXIoKTsKICAgICAgICAgICAgICAgICAgUGxheWVyLmdyaW5kcGxheWVyKHRoaXNFbGVtZW50LCB7CiAgICAgICAgICAgICAgICAgICAgc291cmNlIDogb2JqLnN0cmVhbXMubWVkaXVtLAogICAgICAgICAgICAgICAgICAgIHR5cGUgOiAncnRtcC9tcDQnLAogICAgICAgICAgICAgICAgICAgIGF1dG9wbGF5IDogdHJ1ZQogICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgIC8vIGNyZWF0ZSB2aWRlbyB0YWcgZm9yIG5ldyBwbGF5ZXIKICAgICAgICAgICAgICAgICAgQWFrLmNyZWF0ZUVsZW1lbnQoewogICAgICAgICAgICAgICAgICAgIHRhZyA6ICd2aWRlbycsCiAgICAgICAgICAgICAgICAgICAgaWQgOiAnbm9BZFBsYXllcicsCiAgICAgICAgICAgICAgICAgICAgY2xhc3NpZCA6ICd2aWRlby1qcyB2anMtZGVmYXVsdC1za2luJywKICAgICAgICAgICAgICAgICAgICB3aWR0aCA6IHRoaXNFbGVtZW50LmNsaWVudFdpZHRoIHx8IDczMCwKICAgICAgICAgICAgICAgICAgICBoZWlnaHQgOiB0aGlzRWxlbWVudC5jbGllbnRIZWlnaHQgfHwgNDEwLAogICAgICAgICAgICAgICAgICAgIHByZWxvYWQgOiAnYXV0bycsCiAgICAgICAgICAgICAgICAgICAgY29udHJvbHMgOiB0cnVlLAogICAgICAgICAgICAgICAgICAgIGF1dG9wbGF5IDogdHJ1ZSwKICAgICAgICAgICAgICAgICAgICByZXBsYWNlIDogdGhpc0VsZW1lbnQKICAgICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgICAgICAvLyBwYXJzZSBzb3VyY2VzCiAgICAgICAgICAgICAgICAgIHZhciBzcmNBcnJheSA9IFtdOwogICAgICAgICAgICAgICAgICBpZiAob2JqLnN0cmVhbXMuaGlnaCAmJiBvYmouc3RyZWFtcy5oaWdoICE9PSAnJykgewogICAgICAgICAgICAgICAgICAgIHNyY0FycmF5LnB1c2goewogICAgICAgICAgICAgICAgICAgICAgdHlwZSA6ICJ2aWRlby9tcDQiLCAvLyBtcDQKICAgICAgICAgICAgICAgICAgICAgIHNyYyA6IG9iai5zdHJlYW1zLmhpZ2gKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgfSAgaWYgKG9iai5zdHJlYW1zLmhscyAmJiBvYmouc3RyZWFtcy5obHMgIT09ICcnKSB7CiAgICAgICAgICAgICAgICAgICAgc3JjQXJyYXkucHVzaCh7CiAgICAgICAgICAgICAgICAgICAgICB0eXBlIDogImFwcGxpY2F0aW9uL3gtbXBlZ1VSTCIsIC8vIG0zdTgKICAgICAgICAgICAgICAgICAgICAgIHNyYyA6IG9iai5zdHJlYW1zLmhscwogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICB9ICBpZiAob2JqLnN0cmVhbXMubWVkaXVtICYmIG9iai5zdHJlYW1zLm1lZGl1bSAhPT0gJycpIHsKICAgICAgICAgICAgICAgICAgICB2YXIgdHlwZSA9IG9iai5zdHJlYW1zLm1lZGl1bS5pbmRleE9mKCdydG1wJykgPT09IDAgPyAncnRtcC9tcDQnIDogJ2FwcGxpY2F0aW9uL2Y0bSt4bWwnOwogICAgICAgICAgICAgICAgICAgIHNyY0FycmF5LnB1c2goewogICAgICAgICAgICAgICAgICAgICAgdHlwZSA6IHR5cGUsCiAgICAgICAgICAgICAgICAgICAgICBzcmMgOiBvYmouc3RyZWFtcy5tZWRpdW0KICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICBBYWsubG9nKHNyY0FycmF5LCBKU09OLnN0cmluZ2lmeShzcmNBcnJheSkpOwogICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgLy8gaW5pdGlhbGl6ZSBuZXcgcGxheWVyCiAgICAgICAgICAgICAgICAgIEFhay5hZGRTY3JpcHQoQWFrLmludG9TdHJpbmcoZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAgICAgKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gb25WanNSZWFkeSgpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHdpbmRvdy52aWRlb2pzICE9PSAnZnVuY3Rpb24nKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvblZqc1JlYWR5KCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy52aWRlb2pzKCJub0FkUGxheWVyIikuc3JjKC9fU09VUkNFU18vKTsKICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgb25WanNSZWFkeSgpOwogICAgICAgICAgICAgICAgICAgICAgfSkoKTsKICAgICAgICAgICAgICAgICAgICB9KS5yZXBsYWNlKCIvX1NPVVJDRVNfLyIsIEpTT04uc3RyaW5naWZ5KHNyY0FycmF5KSkpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIC8vIFJ1c3NpYQogICAgICBydXR1YmVfcnUgOiB7IC8vIHJlc2VhcmNoIHNvbHV0aW9uCiAgICAgICAgLyogdGVzdDogaHR0cDovL3J1dHViZS5ydS92aWRlby9iZDVmNjA0NzY1N2YwYmRjYmZiYjBlZGFkMmJiN2M2MS8gKi8KICAgICAgICBob3N0IDogWydydXR1YmUucnUnXSwKICAgICAgICBvbkVuZCA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEFhay5oYXNFbGVtZW50KCcjcnV0dWJlUGxheWVySG9sZGVyJywgZnVuY3Rpb24gKCkgeyAgICAgICAgICAgIC8vZG1GeUlHOXdkSE1nUFNCQllXc3VaMlYwUld4bGJXVnVkQ2dpSTI5d2RHbHZibk1pS1RzTkNpQWdJQ0FnSUNBZ0lDQWdJSFpoY2lCdklEMGdRV0ZyTG1sdWRHOVBZbXBsWTNRb2IzQjBjeTVrWVhSaGMyVjBMblpoYkhWbEtUc05DaUFnSUNBZ0lDQWdJQ0FnSUhaaGNpQnRNM1U0VlhKc0lEMGdieTUyYVdSbGIxOWlZV3hoYm1ObGNpNXRNM1U0T3cwS0lDQWdJQ0FnSUNBZ0lDQWdZMjl1YzI5c1pTNXNiMmNvYlROMU9GVnliQ2s3RFFvTkNpQWdJQ0FnSUNBZ0lDQWdJSFpoY2lCUWJHRjVaWElnUFNCdVpYY2dRV0ZyTG5Cc1lYbGxjaWdwT3cwS0lDQWdJQ0FnSUNBZ0lDQWdVR3hoZVdWeUxuWnBaR1Z2YW5Nb0p5TnlkWFIxWW1WUWJHRjVaWEpJYjJ4a1pYSW5MQ0I3RFFvZ0lDQWdJQ0FnSUNBZ0lDQWdJQ0FnYzI5MWNtTmxJRG9nYlROMU9GVnliQ3dOQ2lBZ0lDQWdJQ0FnSUNBZ0lDQWdJQ0IwZVhCbElEb2dKMmhzY3ljc0RRb2dJQ0FnSUNBZ0lDQWdJQ0FnSUNBZ0x5OXdjbTk0ZVRvZ2RISjFaU3dOQ2lBZ0lDQWdJQ0FnSUNBZ0lDQWdJQ0JoZFhSdmNHeGhlU0E2SUhSeWRXVU5DaUFnSUNBZ0lDQWdJQ0FnSUNBZ2ZUc2dLVHM9CiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIC8vIEl0YWx5CiAgICAgIHJhaV90diA6IHsgLy8gcmVzZWFyY2ggc29sdXRpb24KICAgICAgICBob3N0IDogWydyYWkudHYnXSwKICAgICAgICBvblN0YXJ0IDogZnVuY3Rpb24gKCkge30sCiAgICAgICAgb25JZGxlIDogZnVuY3Rpb24gKCkge30KICAgICAgfSwKICAgICAgLy8gVFYgU3RyZWFtCiAgICAgIGJsb2NrX3N0cmVhbXNfdHYgOiB7CiAgICAgICAgLy8gbm90ZTogcmVkaXJlY3QgdG8gaHR0cDovL2Jsb2NrLnN0cmVhbXMudHYvCiAgICAgICAgaG9zdCA6IFsnZmlyc3Ryb3cuY28nLCAnZmlyc3Ryb3dzLnJ1JywgJ2ZpcnN0cm93cy50dicsICdmaXJzdHJvd3Mub3JnJywgJ2ZpcnN0cm93cy5jbycsICdmaXJzdHJvd3MuYml6JywgJ2ZpcnN0cm93dXMuZXUnLCAnZmlyc3Ryb3cxdXMuZXUnLCAnZmlyc3Rzcm93c3BvcnRzLmV1JywgJ2ZpcnN0cm93c3BvcnRlcy50dicsICdmaXJzdHJvd3Nwb3J0ZXMuY29tJywgJ2p1c3RmaXJzdHJvd3Nwb3J0cy5jb20nLCAnaGFoYXNwb3J0Lm1lJywgJ3dpeml3aWcucnUnLCAnd2l6aXdpZy5zeCcsICd3aXppd2lnLnRvJywgJ3dpeml3aWcudHYnLCAnbXlwMnAuYml6JywgJ215cDJwLnR2JywgJ215cDJwLmxhJywgJ215cDJwLmVjJywgJ215cDJwLmV1JywgJ215cDJwLnN4JywgJ215cDJwLndzJywgJ215cDJwLmNvbScsICdhdGRoZS5ydScsICdhdGRoZS5zZScsICdhdGRoZS5ieicsICdhdGRoZS50b3AnLCAnYXRkaGUudG8nLCAnYXRkaGUubWUnLCAnYXRkaGUubXgnLCAnIGF0ZGhlLmxpJywgJ2F0ZGhlLmFsJ10sCiAgICAgICAgb25BbHdheXMgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBBYWsuc2V0Q29va2llKCJhZGIiLCAxKTsgLy8gcHJldmVudCBhbnRpLWFkYmxvY2sKICAgICAgICAgIEFhay51dy5vcGVuID0gZnVuY3Rpb24gKCkge307IC8vIHByZXZlbnQgcG9wdXAKICAgICAgICAgIEFhay5hZGRTdHlsZSgiI2Jhbm5lckluQ2VudGVyLCAjaGlkZGVuQmFubmVyQ2FudmFzIHsgZGlzcGxheTogbm9uZTsgfSIpOyAvLyBoaWRlIGFkcwogICAgICAgIH0KICAgICAgfSwKICAgICAgYnV6aW5hX3h5eiA6IHsKICAgICAgICAvLyBub3RlOiBkaXNhYmxlIHJlZmNvbnRyb2wsIHVzZWQgYnkgZmlyc3Ryb3dzcG9ydHMKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXMvMTI2OAogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcy8xMjQzCiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzLzg4OQogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dyZWFzeWZvcmsub3JnL2ZvcnVtL2Rpc2N1c3Npb24vODk3NQogICAgICAgIC8vIHNvdXJjZTogaHR0cDovL3Bhc3RlYmluLmNvbS84VlRya3ZTOQogICAgICAgIGhvc3QgOiBbJ2J1emluYS54eXonLCAnZmFybWV0LmluZm8nLCAncmltbGFkaS5jb20nLCAna2l0b3JlbG8uY29tJywgJ29tbmlwb2xhLmNvbScsICdwb3Jvc2luLmNvLnVrJywgJ3JpbWxlbm8uY29tJywgJ3NpbXBsZTRhbGxzLmNvbScsICdhcnNvcG8uY29tJ10sCiAgICAgICAgb25TdGFydCA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEFhay5hZGRTdHlsZSgiI2Fkc2ZyYW1lIHsgaGVpZ2h0OiAxNTFweDsgfSIpOwogICAgICAgIH0sCiAgICAgICAgb25JZGxlIDogZnVuY3Rpb24gKCkgewogICAgICAgICAgaWYgKC9idXppbmEueHl6Ly50ZXN0KGxvY2F0aW9uLmhvc3QpKSB7IC8vIGtlZXBzIHNhbWUgaG9zdCBzdHJlYW0KICAgICAgICAgICAgQWFrLmhhc0VsZW1lbnQoJ2lmcmFtZVtzcmMqPSIucGhwP2hhc2g9Il0nLCBmdW5jdGlvbiAodGhpc0VsZW1lbnQpIHsKICAgICAgICAgICAgICAvLyBodHRwOi8vYXJzb3BvLmNvbS93Mi5waHA/aGFzaD1wYW5kYTU4CiAgICAgICAgICAgICAgLy8gaHR0cDovL3d3dy5idXppbmEueHl6L25hbmExdjEucGhwP29udGhldG9wCiAgICAgICAgICAgICAgdmFyIHBhcnRzID0gdGhpc0VsZW1lbnQuc3JjLnNwbGl0KCcvJyk7CiAgICAgICAgICAgICAgcGFydHNbMl0gPSBBYWsucnVsZXMuYnV6aW5hX3h5ei5ob3N0LnBvcCgpOwogICAgICAgICAgICAgIEFhay5sb2codGhpc0VsZW1lbnQsIHBhcnRzKTsKICAgICAgICAgICAgICB0aGlzRWxlbWVudC5zcmMgPSBwYXJ0cy5qb2luKCcvJyk7CgogICAgICAgICAgICAgICAgLyoJZG1GeUlHOGdQU0I3Q2drSkNTQWdJQ0FpY0d4aGVXeHBjM1FpSURvZ1czc0tDUWtKSUNBZ0lDQWdJQ0FpY0hKdmRtbGtaWElpSURvZ0luSjBiWEFpTEFvSkNRa2dJQ0FnSUNBZ0lDSjFjbXdpSURvZ0luQmhibVJoTVQ5bEpUTkVNVFEyTlRBM01ETXlOaVV5Tm5OMEpUTkVVSEowU0ZsNWRrSjZaRGxhWkRkb1JGOW1Va2hVWnpFeE1URXpNQ0lLQ1FrSklDQWdJQ0FnZlFvSkNRa2dJQ0FnWFN3S0NRa0pJQ0FnSUNKd2JIVm5hVzV6SWlBNklIc0tDUWtKSUNBZ0lDQWdJbkowYlhBaUlEb2dld29KQ1FrZ0lDQWdJQ0FnSUNKMWNtd2lJRG9nSW1ac2IzZHdiR0Y1WlhJdWNuUnRjQzB6TGpJdU1URXVjM2RtSWl3Z0Nna0pDUWtKTHk4aWRYSnNJam9nSW1oMGRIQTZMeTl5Wld4bFlYTmxjeTVtYkc5M2NHeGhlV1Z5TG05eVp5OXpkMll2Wm14dmQzQnNZWGxsY2k1eWRHMXdMVE11TWk0eE1TNXpkMllpTEFvSkNRa2dJQ0FnSUNBZ0lDSnVaWFJEYjI1dVpXTjBhVzl1VlhKc0lpQTZJQ0p5ZEcxd09pOHZNVGcxTGpneUxqSXhOUzQwTlRvek5UYzVMM1p2WkM4aUNna0pDU0FnSUNBZ0lIMHNDZ2tKQ1NBZ0lDQWdJQ0pqYjI1MGNtOXNjeUlnT2lCN0Nna0pDUWtnSUNBZ0luVnliQ0k2SUNKb2RIUndPaTh2Y21Wc1pXRnpaWE11Wm14dmQzQnNZWGxsY2k1dmNtY3ZjM2RtTDJac2IzZHdiR0Y1WlhJdVkyOXVkSEp2YkhNdE15NHlMakUyTG5OM1ppSXNJQzh2SUdGa1pHVmtJR0psWTJGMWMyVWdiV2x6YzJsdVp3b0pDUWtnSUNBZ0lDQWdJQ0p3YkdGNUlpQTZJR1poYkhObExBb0pDUWtnSUNBZ0lDQWdJQ0p6WTNKMVltSmxjaUlnT2lCbVlXeHpaUW9KQ1FrZ0lDQWdJQ0I5Q2drSkNTQWdJQ0I5TEFvSkNRa2dJQ0FnSW5Cc1lYbGxja2xrSWlBNklDSndiR0Y1WlhJaUxBb0pDUWtnSUNBZ0ltTnNhWEFpSURvZ2V3b0pDUWtnSUNBZ0lDQWlkWEpzSWlBNklDSndZVzVrWVRFL1pTVXpSREUwTmpVd056QXpNallsTWpaemRDVXpSRkJ5ZEVoWmVYWkNlbVE1V21RM2FFUmZabEpJVkdjeE1URXhNekFpQ2drSkNTQWdJQ0I5Q2drSkNTQWdmUW9LQ1FrSklDQjJZWElnYm1WM1ZYSnNJRDBnY0dGeWRITXVjMnhwWTJVb01Dd2dNeWt1YW05cGJpZ25MeWNwSUNzZ0p5OW1iRzkzY0d4aGVXVnlMVE11TWk0eE5pNXpkMlkvWTI5dVptbG5QU2NnS3lCbGMyTmhjR1VvU2xOUFRpNXpkSEpwYm1kcFpua29ieWtwT3dvSkNRa2dJQzh2ZG1GeUlHNWxkMVZ5YkNBOUlDZG9kSFJ3T2k4dmNtVnNaV0Z6WlhNdVpteHZkM0JzWVhsbGNpNXZjbWN2YzNkbUwyWnNiM2R3YkdGNVpYSXRNeTR5TGpFMkxuTjNaajlqYjI1bWFXYzlKeUFySUdWelkyRndaU2hLVTA5T0xuTjBjbWx1WjJsbWVTaHZLU2s3Q2drSkNTQWdZMjl1YzI5c1pTNXNiMmNvYm1WM1ZYSnNLVHNLQ1FrSklDQjBhR2x6Uld4bGJXVnVkQzV6Y21NZ1BTQnVaWGRWY213NwogICAgICAgICAgICAgICAgKi8KICAgICAgICAgICAgICAKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9IGVsc2UgeyAvLyBza2lwIGFudGktYWRibG9jawogICAgICAgICAgICBBYWsucmVtb3ZlRWxlbWVudCgnI2Fkc2ZyYW1lJyk7CiAgICAgICAgICAgIEFhay5nZXRFbGVtZW50KCcjcmVtb3ZlLW92ZXInKS5jbGljaygpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSwKICAgICAgYWxsbXl2aWRlb3NfbmV0IDogewogICAgICAgIC8vIG5vdGU6IG9iZnVzY2F0ZWQKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXMvMjc0CiAgICAgICAgaG9zdCA6IFsnYWxsbXl2aWRlb3MubmV0JywgJ2FtdnR2Lm5ldCddLAogICAgICAgIG9uU3RhcnQgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAvLyBza2lwIGZha2UgcGxheSBidXR0b24KICAgICAgICAgIEFhay5zZXRDb29raWUoJ19mYXZidDMzJywgMSk7CiAgICAgICAgfQogICAgICB9LAogICAgICBpbGl2ZV9kb21haW5zIDogewogICAgICAgIGhvc3QgOiBbJ2lsaXZlLnRvJywgJ3N0cmVhbWxpdmUudG8nXSwKICAgICAgICBvbkVuZCA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIGlmICgvXlwvZW1iZWRwbGF5ZXIucGhwL2kudGVzdChsb2NhdGlvbi5wYXRobmFtZSkpIHsKICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgLy8gU2tpcCB0aW1lcgogICAgICAgICAgICAgIEFhay51dy5yZW1vdmVPdmVybGF5SFRNTCgpOwogICAgICAgICAgICB9LCAxMDAwKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0sCiAgICAgIG1pY2FzdF90diA6IHsKICAgICAgICBob3N0IDogWydtaWNhc3QudHYnXSwKICAgICAgICBvblN0YXJ0IDogZnVuY3Rpb24gKCkgewogICAgICAgICAgLy8gcHJldmVudCBwb3B1bmRlcgogICAgICAgICAgQWFrLnNldENvb2tpZSgndmlkX21haW4nLCB0cnVlKTsKICAgICAgICAgIEFhay5zZXRDb29raWUoJ3ZpZF9zdWInLCB0cnVlKTsKICAgICAgICAgIC8vIHJlbW92ZSBvdmVybGF5CiAgICAgICAgICBBYWsuYWRkU2NyaXB0KGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgd2luZG93Lm9ubG9hZCA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICBpZiAod2luZG93LnJlbW92ZU92ZXJsYXlIVE1MKQogICAgICAgICAgICAgICAgd2luZG93LnJlbW92ZU92ZXJsYXlIVE1MKCk7CiAgICAgICAgICAgIH07CiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIHB4c3RyZWFtX3R2IDogewogICAgICAgIGhvc3QgOiBbJ3B4c3RyZWFtLnR2J10sCiAgICAgICAgb25FbmQgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBpZiAoL15cL2VtYmVkcm91dGVyLnBocC8udGVzdChsb2NhdGlvbi5wYXRobmFtZSkpIHsKICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgLy8gU2tpcCB0aW1lciBhbmQgY2xvc2UgYWRzCiAgICAgICAgICAgICAgQWFrLnV3LmNsb3NlQWQoKTsKICAgICAgICAgICAgfSwgMTAwMCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9LAogICAgICBzYXdsaXZlX3R2IDogewogICAgICAgIGhvc3QgOiBbJ3Nhd2xpdmUudHYnXSwKICAgICAgICBvbklkbGUgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBpZiAoL15cL2VtYmVkXC93YXRjaFwvL2kudGVzdChsb2NhdGlvbi5wYXRobmFtZSkpIHsKICAgICAgICAgICAgLy8gU2tpcCB0aW1lciBhbmQgY2xvc2UgYWRzCiAgICAgICAgICAgIEFhay51dy5kaXNwbGF5ID0gZmFsc2U7CiAgICAgICAgICAgIEFhay51dy5jbG9zZU15QWQoKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0sCiAgICAgIGdvb2RjYXN0X2NvIDogewogICAgICAgIGhvc3QgOiBbJ2dvb2RjYXN0LmNvJ10sCiAgICAgICAgb25JZGxlIDogZnVuY3Rpb24gKCkgewogICAgICAgICAgaWYgKC9eXC9zdHJlYW0ucGhwLy50ZXN0KGxvY2F0aW9uLnBhdGhuYW1lKSkgewogICAgICAgICAgICAvLyByZW1vdmUgYWRzIGFsbG93ZWQgYnkgZWFzeWxpc3QKICAgICAgICAgICAgQWFrLnV3LiQoIi5hZHZlcnRpc2VtZW50IikuaGlkZSgpOwogICAgICAgICAgICBBYWsudXcuJCgnLmFkc2t5IGlmcmFtZScpLmF0dHIoInNyYyIsICJhYm91dDpibGFuayIpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSwKICAgICAgc2hvd3Nwb3J0X3R2X2NvbSA6IHsKICAgICAgICBob3N0IDogWydzaG93c3BvcnQtdHYuY29tJ10sCiAgICAgICAgb25JZGxlIDogZnVuY3Rpb24gKCkgewogICAgICAgICAgaWYgKC9eXC9jaC5waHAvLnRlc3QobG9jYXRpb24ucGF0aG5hbWUpKSB7CiAgICAgICAgICAgIC8vIHJlbW92ZSBhZHMgYWxsb3dlZCBieSBlYXN5bGlzdAogICAgICAgICAgICBBYWsucmVtb3ZlRWxlbWVudCgnI2FkdmVydGlzZW1lbnQsIC5hZHZlcnRpc2VtZW50Jyk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9LAogICAgICBzaGFyZWNhc3RfdG8gOiB7CiAgICAgICAgaG9zdCA6IFsnc2hhcmVjYXN0LnRvJ10sCiAgICAgICAgb25JZGxlIDogZnVuY3Rpb24gKCkgewogICAgICAgICAgaWYgKC9eXC9lbWJlZC5waHAvLnRlc3QobG9jYXRpb24ucGF0aG5hbWUpKSB7CgogICAgICAgICAgICAvLyBEaXNhYmxlIHBvcHVuZGVycwogICAgICAgICAgICB2YXIgaW50ZXJ2YWwgPSBzZXRJbnRlcnZhbChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICBBYWsuc2V0Q29va2llKCd2aWRfbWFpbicsIHRydWUpOwogICAgICAgICAgICAgICAgQWFrLnNldENvb2tpZSgndmlkX3N1YicsIDIpOwogICAgICAgICAgICAgICAgQWFrLnNldENvb2tpZSgndmlkX2RlbGF5JywgdHJ1ZSk7CiAgICAgICAgICAgICAgfSwgMTAwKTsKCiAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgIGNsZWFySW50ZXJ2YWwoaW50ZXJ2YWwpOwogICAgICAgICAgICB9LCA1MDAwKTsKCiAgICAgICAgICAgIC8vIFJlbW92ZSB0cmFuc3BhcmVudCBvdmVybGF5CiAgICAgICAgICAgIEFhay5yZW1vdmVFbGVtZW50KCcjdGFibGUxJyk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9LAogICAgICB2aWRlb21lZ2FfdHYgOiB7CiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzP3E9dmlkZW9tZWdhCiAgICAgICAgaG9zdCA6IFsndmlkZW9tZWdhLnR2J10sCiAgICAgICAgb25TdGFydCA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIGlmICgvXlwvdmlldy5waHAvLnRlc3QobG9jYXRpb24ucGF0aG5hbWUpKSB7CiAgICAgICAgICAgIC8vIHByZXZlbnQgcG9wdW5kZXIKICAgICAgICAgICAgQWFrLnNldENvb2tpZSgndmlkX21haW5wdScsIHRydWUpOwogICAgICAgICAgICBBYWsuc2V0Q29va2llKCd2aWRfc3VicHUnLCB0cnVlKTsKICAgICAgICAgICAgQWFrLnNldENvb2tpZSgndmlkX2RlbGF5JywgdHJ1ZSk7CiAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgICBvbkVuZCA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIC8vIGtpbGwgYWJjCiAgICAgICAgICAvLyBmaXggYnVnIG9uIGZpcmVmb3g6IFRoZSB2aWRlbyBjb3VsZCBub3QgYmUgbG9hZGVkLCBlaXRoZXIgYmVjYXVzZSB0aGUgc2VydmVyIG9yIG5ldHdvcmsgZmFpbGVkIG9yIGJlY2F1c2UgdGhlIGZvcm1hdCBpcyBub3Qgc3VwcG9ydGVkLgogICAgICAgICAgdmFyIHNjcmlwdCA9IEFhay5oYXNTY3JpcHQoJ1BsZWFzZSBkaXNhYmxlIEFkQmxvY2sgUGx1Z2luIHRvIHdhdGNoIHRoZSB2aWRlbycpOwogICAgICAgICAgaWYgKHNjcmlwdCkgewogICAgICAgICAgICB2YXIgc291cmNlID0gc2NyaXB0LmlubmVySFRNTDsKICAgICAgICAgICAgdmFyIHN1YnN0cmluZyA9IHNvdXJjZS5zdWJzdHJpbmcoc291cmNlLmxhc3RJbmRleE9mKCdldmFsKCcpLCBzb3VyY2UubGFzdEluZGV4T2YoJyknKSArIDEpOwogICAgICAgICAgICB2YXIgZGVvYmZ1c2NhdGVkID0gQWFrLnVucGFja1NjcmlwdChzdWJzdHJpbmcpOwogICAgICAgICAgICB2YXIgbmV3U2NyaXB0ID0gJ2lmKCcrZGVvYmZ1c2NhdGVkLnN1YnN0cmluZyhkZW9iZnVzY2F0ZWQuaW5kZXhPZigndHJ1ZScpKTsKICAgICAgICAgICAgQWFrLmFkZFNjcmlwdChuZXdTY3JpcHQpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSwKICAgICAgZmxvd3BsYXllcl9hbnRpYWRibG9jayA6IHsKICAgICAgICBob3N0IDogWyd2aWRlb2Z1bi5tZScsICd2aWRlb2J1Zy5uZXQnLCAndmlkZW80NC5uZXQnLCAncGxheTQ0Lm5ldCcsICdieXpvby5vcmcnLCAncGxheWJiLm1lJywgJ3ZpZGVvd2luZy5tZScsICd2aWRlb3pvby5tZScsICdlYXN5dmlkZW8ubWUnLCAncGxheXBhbmRhLm5ldCddLAogICAgICAgIG9uRW5kIDogZnVuY3Rpb24gKCkgewogICAgICAgIAogICAgICAgICAgLyoKICAgICAgICAgIGh0dHA6Ly93d3cuYW5pbWV0b29uLnR2L2JsYWNrLWxhZ29vbi1lcGlzb2RlLTEKICAgICAgICAgIGh0dHA6Ly92aWRlb3dpbmcubWUvZW1iZWQ/dz03MTgmaD00MzgmdmlkZW89b25nb2luZy95dS1naS1vaF9hcmMtdl8tXzUzLm1wNAogICAgICAgICAgaHR0cDovL3BsYXliYi5tZS9lbWJlZC5waHA/dz03MTgmaD00MzgmdmlkPWF0L253L3l1LWdpLW9oX2FyYy12Xy1fNTMubXA0CiAgICAgICAgICBodHRwOi8vdmlkZW96b28ubWUvZW1iZWQucGhwP3c9NzE4Jmg9NDM4JnZpZD1hdC9udy95dS1naS1vaF9hcmMtdl8tXzUzLm1wNAogICAgICAgICAgaHR0cDovL3d3dy5lYXN5dmlkZW8ubWUvZ29nby8/dz03MTgmaD00MzgmZmlsZT15dS1naS1vaF9hcmMtdl8tXzUzLm1wNCZzdj0xCiAgICAgICAgICBodHRwOi8vcGxheXBhbmRhLm5ldC9lbWJlZC5waHA/dz03MTgmaD00MzgmdmlkPWF0L253L3l1LWdpLW9oX2FyYy12Xy1fNTMubXA0CiAgICAgICAgICAgKi8KCiAgICAgICAgICAvLyBhbGxvdyBmdWxsc2NyZWVuIHdoZW4gYWJwIGlzIGVuYWJsZWQgYW5kIHJlbW92ZSBhZCBsYXllcgogICAgICAgICAgLy8gYWRzIGJsb2NrZWQgYnkgYWJwIHJ1bGUKICAgICAgICAgIGlmICgvXlwvKGVtYmVkfGdvZ298Z3BsdXMpLy50ZXN0KGxvY2F0aW9uLnBhdGhuYW1lKSkgewogICAgICAgICAgICB2YXIgUGxheWVyID0gbmV3IEFhay5wbGF5ZXIoKTsKICAgICAgICAgICAgUGxheWVyLmVkaXRpbmcoJyNmbG93cGxheWVyX2FwaScsIHsKICAgICAgICAgICAgICBzZXRBdHRyaWJ1dGVzIDogewogICAgICAgICAgICAgICAgYWxsb3dmdWxsc2NyZWVuIDogdHJ1ZQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9LAogICAgICByM3ogOiB7CiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzP3E9bGFiZWw6UjNaCiAgICAgICAgLy8gc291cmNlOiBodHRwOi8vcGFzdGViaW4uY29tL0MxNTlrZXZuCiAgICAgICAgaG9zdCA6IFsnY2l0eWFtLmNvbScsICdjb21wdXRlcndvcmxkdWsuY29tJywgJ3RlY2h3b3JsZC5jb20nLCAndjMuY28udWsnXSwKICAgICAgICBvblN0YXJ0IDogZnVuY3Rpb24gKCkgewogICAgICAgICAgLyogZG9uJ3Qgd29yayB3aXRoIGNocm9tZQogICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEFhay51dywgJ19yM3onLCB7CiAgICAgICAgICAgIGVudW1lcmFibGUgOiB0cnVlLAogICAgICAgICAgICB3cml0YWJsZSA6IGZhbHNlLAogICAgICAgICAgICB2YWx1ZSA6IHt9CiAgICAgICAgICB9KTsKICAgICAgICAgICovCiAgICAgICAgfSwKICAgICAgICBvbklkbGUgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBBYWsudXcuJCgiI3Izei13YWl0IikucmVtb3ZlKCk7CiAgICAgICAgICBBYWsudXcuJCgiLnIzei1oaWRlIikucmVtb3ZlQ2xhc3MoInIzei1oaWRlIik7CiAgICAgICAgICBBYWsudXcuX3IzeiA9IG51bGw7CiAgICAgICAgfQogICAgICB9LAogICAgICBnb29nbGVfam9icnVubmVyIDogewogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dyZWFzeWZvcmsub3JnL2VuL2ZvcnVtL21lc3NhZ2VzLzQwNQogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcy8xMzQzCiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzLzEzNDIKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXMvODMxCiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzLzEyNzQKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXMvMTI2MgogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcy81NjEKICAgICAgICBob3N0IDogWyduZXh0LWVwaXNvZGUubmV0JywgJ2tpbmdtYWtlci5uZXdzJywgJ2dhbWVzcG93ZXJpdGEuY29tJywgJ3RvZGF5aWRvbC5jb20nLCAncmVjZWl2ZS1hLXNtcy5jb20nLCAnd2FrZXVwY2FsbG1lLmNvbScsICdyaW5nbXljZWxscGhvbmUuY29tJywgJ2ZhcW1vemlsbGEub3JnJywgJ3RoZW1lbXlwYy5jb20nXSwKICAgICAgICBvbkFsd2F5cyA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEFhay51dy5nb29nbGVfam9icnVubmVyID0ge307CiAgICAgICAgfQogICAgICB9LAogICAgICAvLyBmdWNrYWRib2NrIGN1c3RvbWl6ZWQKICAgICAgZmFiX2Rhd25fY29tIDogewogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcy8xNzQ3CiAgICAgICAgaG9zdCA6IFsnZGF3bi5jb20nXSwKICAgICAgICBvblN0YXJ0IDogZnVuY3Rpb24gKCkgewogICAgICAgICAgQWFrLmZha2VGdWNrQWRCbG9jaygnZGV0ZWN0QWRCbG9jaycsICdEZXRlY3RBZEJsb2NrJyk7CiAgICAgICAgfQogICAgICB9LAogICAgICBmYWJfc3BvcnRzX2ZyIDogewogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcy8xMjE3CiAgICAgICAgLy8gc291cmNlOiBodHRwOi8vcGFzdGViaW4uY29tL1NwRU41ZHVTCiAgICAgICAgaG9zdCA6IFsnc3BvcnRzLmZyJ10sCiAgICAgICAgb25TdGFydCA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEFhay5mYWtlRnVja0FkQmxvY2soJ2ZhYkluc3RhbmNlJywgJ0ZhYkluc3RhbmNlJyk7CiAgICAgICAgfQogICAgICB9LAogICAgICBmYWJfZXVyb3BlMV9mciA6IHsKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXMvMTE4OAogICAgICAgIC8vIHNvdXJjZTogaHR0cDovL3Bhc3RlYmluLmNvbS9VTGUxdnpRUgogICAgICAgIGhvc3QgOiBbJ2V1cm9wZTEuZnInXSwKICAgICAgICBvblN0YXJ0IDogZnVuY3Rpb24gKCkgewogICAgICAgICAgQWFrLmZha2VGdWNrQWRCbG9jaygnZmFiSW5zdGFuY2UnLCAnRmFiSW5zdGFuY2UnKTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGZhYl9uZXd5b3JrZXJfY29tIDogewogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcy8xMTc3CiAgICAgICAgaG9zdCA6IFsnbmV3eW9ya2VyLmNvbSddLAogICAgICAgIG9uU3RhcnQgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBBYWsuZmFrZUZ1Y2tBZEJsb2NrKCdzbmlmZkFkQmxvY2snLCAnU25pZmZBZEJsb2NrJyk7CiAgICAgICAgfQogICAgICB9LAogICAgICBmYWJfd2lyZWRfY29tIDogewogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcy8xMDYxCiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ3JlYXN5Zm9yay5vcmcvZnIvZm9ydW0vZGlzY3Vzc2lvbi84MjM1CiAgICAgICAgLy8gc291cmNlOiBodHRwOi8vcGFzdGViaW4uY29tL1BxMTR2NEZDCiAgICAgICAgaG9zdCA6IFsnd2lyZWQuY29tJ10sCiAgICAgICAgb25TdGFydCA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEFhay5mYWtlRnVja0FkQmxvY2soJ3NuaWZmQWRCbG9jaycsICdTbmlmZkFkQmxvY2snKTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGZhYl9tYW5nYXNwcm9qZWN0X2RvbWFpbnMgOiB7CiAgICAgICAgLy8gbm90ZTogZnVja2FkYmxvY2sgd2l0aCBjdXN0b20gaW5zdGFuY2UgbmFtZQogICAgICAgIC8vIG5vdGU6IGFsc28gYWRkZWQgYWJwIHJ1bGUKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXMvMTEyNwogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dyZWFzeWZvcmsub3JnL2ZyL2ZvcnVtL2Rpc2N1c3Npb24vNDEzMgogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcy84NTgKICAgICAgICAvLyBzb3VyY2U6IGh0dHBzOi8vbWFuZ2FzLnpseC5jb20uYnIvbWFuZ2F6b3JkX2xpYi9qcy9saWIvY29udHJvbGxlcnMvTGVpdG9yL0xlaXRvci5taW4uanMKICAgICAgICBob3N0IDogWydtYW5nYXNwcm9qZWN0LmNvbS5icicsICdtYW5nYXNwcm9qZWN0Lm5ldC5icicsICdtYW5nYXMuemx4LmNvbS5iciddLAogICAgICAgIG9uU3RhcnQgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBBYWsuZmFrZUZ1Y2tBZEJsb2NrKCdtYW5nYXNMZWl0b3JTbGlkZXInLCBBYWsuZ2VuZXJhdGVJRCgpKTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGZhYl9xbmltYXRlX2NvbSA6IHsKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXMvNzM5CiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzLzcwNQogICAgICAgIC8vIG5vdGU6IGZ1Y2thZGJsb2NrIGN1c3RvbWl6ZWQKICAgICAgICBob3N0IDogWydxbmltYXRlLmNvbSddLAogICAgICAgIG9uQWx3YXlzIDogZnVuY3Rpb24gKCkgewogICAgICAgICAgQWFrLnV3LmFkQmxvY2tEZXRlY3RlZCA9IGZ1bmN0aW9uICgpIHt9OwogICAgICAgIH0KICAgICAgfSwKICAgICAgZmFiX2V1cm90cmFuc3BvcnRfZGUgOiB7CiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzLzg1OAogICAgICAgIC8vIG5vdGU6IGZ1Y2thZGJsb2NrIHdpdGggY3VzdG9tIGluc3RhbmNlIG5hbWUKICAgICAgICBob3N0IDogWydldXJvdHJhbnNwb3J0LmRlJ10sCiAgICAgICAgb25TdGFydCA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEFhay5mYWtlRnVja0FkQmxvY2soJ2FudGlBZEJsb2NrJywgQWFrLmdlbmVyYXRlSUQoKSk7CiAgICAgICAgfQogICAgICB9LAogICAgICBmYWJfY2FkZXRlY3QgOiB7CiAgICAgICAgLy8gYnk6IFNrcjR0Y2hHcjNhenlNb25raUJhbGxsbGxsWnp6egogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcy83ODQKICAgICAgICAvLyBub3RlOiBmdWNrYWRibG9jayB3aXRoIGN1c3RvbSBpbnN0YW5jZSBuYW1lCiAgICAgICAgaG9zdCA6IFsndHpldHplLml0JywgJ2JlcHBlZ3JpbGxvLml0JywgJ2xhLWNvc2EuaXQnXSwKICAgICAgICBvblN0YXJ0IDogZnVuY3Rpb24gKCkgewogICAgICAgICAgQWFrLmZha2VGdWNrQWRCbG9jaygnY2FkZXRlY3QnLCAnQ0FEZXRlY3QnKTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGZhYl9hZ2FyX2dhbWUgOiB7CiAgICAgICAgLy8gbm90ZTogZnVja2FkYmxvY2sgd2l0aCBjdXN0b20gaW5zdGFuY2UgbmFtZQogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcy8xMjU3CiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzLzExMzUKICAgICAgICBob3N0IDogWydhZ2FyaW8uc3gnLCAnYWdhcmFiaS5jb20nXSwKICAgICAgICBvblN0YXJ0IDogZnVuY3Rpb24gKCkgewogICAgICAgICAgQWFrLmZha2VGdWNrQWRCbG9jaygnYWdhcmlvX1NYX2FkcycsIEFhay5nZW5lcmF0ZUlEKCkpOwogICAgICAgIH0KICAgICAgfSwKICAgICAgZmFiX2ZpbGVzcGFjZV9jb20gOiB7CiAgICAgICAgLy8gbm90ZTogZnVja2FkYmxvY2sgd2l0aCBjdXN0b20gaW5zdGFuY2UgbmFtZQogICAgICAgIC8vIHNvdXJjZTogaHR0cDovL3Bhc3RlYmluLmNvbS9ZQVMwQXM4NwogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcy8xMDM3CiAgICAgICAgaG9zdCA6IFsnZmlsZXNwYWNlLmNvbSddLAogICAgICAgIG9uU3RhcnQgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBBYWsuZmFrZUZ1Y2tBZEJsb2NrKCdmQUInLCBBYWsuZ2VuZXJhdGVJRCgpKTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGZhYl90b3BzZXJpYWx5X3NrIDogewogICAgICAgIC8vIG5vdGU6IGZ1Y2thZGJsb2NrIHdpdGggY3VzdG9tIGluc3RhbmNlIG5hbWUKICAgICAgICAvLyBzb3VyY2U6IGh0dHA6Ly9wYXN0ZWJpbi5jb20vNDJ0VVE5YVYKICAgICAgICBob3N0IDogWyd0b3BzZXJpYWx5LnNrJ10sCiAgICAgICAgb25TdGFydCA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEFhay5mYWtlRnVja0FkQmxvY2soJ3NyYXROYVZhcycsIEFhay5nZW5lcmF0ZUlEKCkpOwogICAgICAgIH0KICAgICAgfSwKICAgICAgZmFiX2N1c3RvbWl6ZWQgOiB7CiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzLzE0NTUKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXMvMTY1NwogICAgICAgIC8vIHNvdXJjZTogaHR0cDovL3Bhc3RlYmluLmNvbS9ONDJhNUJqRQogICAgICAgIGhvc3QgOiBbJ2VwaWN1cmlvdXMuY29tJywgJ2Rlc2t0b3Bzb2x1dGlvbi5vcmcnLCAnaW5kaWF0aW1lcy5jb20nLCAnaGluZHVzdGFudGltZXMuY29tJywgJ2hhcHB5dHJpcHMuY29tJ10sCiAgICAgICAgb25TdGFydCA6IGZ1bmN0aW9uKCkgewogICAgICAgICAgICBBYWsuYWRkU2NyaXB0KGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICB2YXIgX3NldEF0dHJpYnV0ZSA9IHdpbmRvdy5FbGVtZW50LnByb3RvdHlwZS5zZXRBdHRyaWJ1dGU7CiAgICAgICAgICAgICAgd2luZG93LkVsZW1lbnQucHJvdG90eXBlLnNldEF0dHJpYnV0ZSA9IGZ1bmN0aW9uIChuYW1lLCB2YWx1ZSkgewogICAgICAgICAgICAgICAgaWYgKG5hbWUgPT0gJ2NsYXNzJyAmJiB2YWx1ZS5pbmRleE9mKCd0ZXh0X2FkcycpICE9IC0xKSB7CiAgICAgICAgICAgICAgICAgIHZhbHVlID0gJyc7CiAgICAgICAgICAgICAgICAgIGNvbnNvbGUuaW5mbyh0aGlzLCAnZmFiIGludGVyY2VwdGVkIDotKScpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgX3NldEF0dHJpYnV0ZS5jYWxsKHRoaXMsIG5hbWUsIHZhbHVlKTsKICAgICAgICAgICAgICB9OwogICAgICAgICAgICB9KSgpOwogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9LAogICAgICBkM3h0M2VyX2FudGlhZGJsb2NrIDogewogICAgICAgIC8vIHNpdGU6IGh0dHA6Ly9kM3h0M3IuY29tL2FudGktYWRibG9jawogICAgICAgIC8vIGNhc2U6IGh0dHA6Ly9zcG9ydC1zaG93LmZyL2pzL2FkdmVydGlzZW1lbnQtQWRCbG9jay5qcwogICAgICAgIC8vIGNhc2U6IGh0dHA6Ly93d3cuMnNpdGUubWUvYWR2ZXJ0aXNlbWVudC1BZEJsb2NrLmpzCiAgICAgICAgaG9zdCA6IFsnc3BvcnQtc2hvdy5mcicsICd2aXBmbGFzaC5uZXQnLCAnMnNpdGUubWUnXSwKICAgICAgICBvblN0YXJ0IDogZnVuY3Rpb24gKCkgewogICAgICAgICAgQWFrLmFkZFN0eWxlKCIjYmxvY2tibG9ja0Ege3Zpc2liaWxpdHk6aW52aXNpYmxlO2Rpc3BsYXk6bm9uZTt9ICNibG9ja2Jsb2NrQSB0ZCB7dmlzaWJpbGl0eTppbnZpc2libGU7ZGlzcGxheTpub25lO30gI2Jsb2NrYmxvY2tBIHRkIHAge3Zpc2liaWxpdHk6aW52aXNpYmxlO2Rpc3BsYXk6bm9uZTt9ICNibG9ja2Jsb2NrQiB7dmlzaWJpbGl0eTp2aXNpYmxlO2Rpc3BsYXk6YmxvY2s7fSIpOwogICAgICAgIH0KICAgICAgfSwKICAgICAgYWRibG9ja19ub3RpZnkgOiB7CiAgICAgICAgLy8gYnk6IFNrcjR0Y2hHcjNhenlNb25raUJhbGxsbGxsWnp6egogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcy8xNzY2CiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzLzEzOTIKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXMvMTAzOQogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcy81OTIKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXMvODEzCiAgICAgICAgaG9zdCA6IFsnZ2FtZXRyYW5zZmVycy5jb20nLCAnd2luYW5kbWFjLmNvbScsICdmcmVlLXN0ZWFtLWdpdmVhd2F5cy5jb20nLCAnY2FuYWx3cC5jb20nLCAnYWxwaGFoaXN0b3J5LmNvbScsICdub3JkcHJlc3NlLmJlJywgJ3Nvc3BjLm5hbWUnLCAnYmFib28uY29tLmJyJ10sCiAgICAgICAgb25BbHdheXMgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBBYWsuc2V0Q29va2llKCdhbkNvb2tpZScsIHRydWUpOwogICAgICAgICAgQWFrLnV3LmFuT3B0aW9ucyA9IHt9OwogICAgICAgIH0KICAgICAgfSwKICAgICAgbHV0dGVfYWRibG9jayA6IHsKICAgICAgICAvLyBzaXRlOiBodHRwOi8vbHV0dGVhZGJsb2NrLmJsb2dzcG90LmNvbS8yMDE0LzExL2xlLXNjcmlwdC5odG1sCiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzLzkzOAogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcy81ODAKICAgICAgICBob3N0IDogWydsZXdlYnR2Ym91cXVldGZyYW5jb3Bob25lLm92ZXJibG9nLmNvbScsICd3ZWJ0di5ibG9ndWV6LmNvbScsICdsYXRlbGVncmF0dWl0ZS5ibG9nc3BvdC5jb20nLCAndG90YWxkZWJyaWQub3JnJywgJzM3LjE4Ny4xNzMuMjA1JywgJ3R2Z3JhdHVpdGUuYmxvZ3Nwb3QuY29tJ10sCiAgICAgICAgb25TdGFydCA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEFhay5hZGRCYWl0RWxlbWVudCgnZGl2I215X2FkX2RpdicpOwogICAgICAgICAgQWFrLnV3LmphYmJhaHVkID0gZnVuY3Rpb24gKCkge307CiAgICAgICAgfQogICAgICB9LAogICAgICBhbnRpYmxvY2sgOiB7CiAgICAgICAgLy8gc2l0ZTogYW50aWJsb2NrLm9yZwogICAgICAgIC8vIG5vdGU6IGN1c3RvbWl6ZWQKICAgICAgICAvLyBpc3N1ZTogCiAgICAgICAgaG9zdCA6IFsnbXliYW5rLnBsJywgJ3JhcGlkZ3JhYi5wbCddLAogICAgICAgIG9uU3RhcnQgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBBYWsuYWRkU2NyaXB0KGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICB2YXIgX2FkZEV2ZW50TGlzdGVuZXIgPSB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcjsKICAgICAgICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lciA9IGZ1bmN0aW9uICh0eXBlLCBsaXN0ZW5lciwgb3B0aW9ucykgewogICAgICAgICAgICAgICAgaWYgKGxpc3RlbmVyLnRvU3RyaW5nKCkuaW5kZXhPZignLm5leHRGdW5jdGlvbigpfScpID4gLTEpIHsKICAgICAgICAgICAgICAgICAgbGlzdGVuZXIgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5pbmZvKFsnQW50aUFkYktpbGxlcicsIGxvY2F0aW9uLmhvc3QsICdBbnRpQmxvY2t7Y3VzdG9taXplZH0nXSk7CiAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBfYWRkRXZlbnRMaXN0ZW5lci5jYWxsKHRoaXMsIHR5cGUsIGxpc3RlbmVyLCBvcHRpb25zKTsKICAgICAgICAgICAgICB9OwogICAgICAgICAgICB9KSgpOwogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9LAogICAgICBibG9ja2FkYmxvY2sgOiB7CiAgICAgICAgLy8gc2l0ZTogYmxvY2thZGJsb2NrLmNvbQogICAgICAgIC8vIG5vdGU6IHJhbmRvbSBpbnN0YW5jZSBuYW1lCiAgICAgICAgLy8gc291cmNlOiBodHRwczovL2dpc3QuZ2l0aHViLmNvbS9XYXRpbGluL2FmNzVlMGEyZTgyYTJlZmIzODRiZGU5YzdiNDFkZWM4CiAgICAgICAgLy8gaXNzdWVzOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcz9xPWxhYmVsOkJsb2NrQWRCbG9jawogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dyZWFzeWZvcmsub3JnL2ZvcnVtL2Rpc2N1c3Npb24vODI3MwogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dyZWFzeWZvcmsub3JnL2ZvcnVtL2Rpc2N1c3Npb24vNzYyNQogICAgICAgIGhvc3QgOiBbJ2Jsb2NrYWRibG9jay5jb20nLCAnbGlua2Ryb3AubmV0JywgJ3JldmNsb3Vkcy5jb20nLCAnbGVwb3Juby5vcmcnLCAndXBsb2Fkc2h1Yi5jb20nLCAnZGFzb2xvLm9yZycsICdmdWxsc3R1ZmYubmV0JywgJ3pldXNuZXdzLml0JywgJ2NoZW1pbm90cy5uZXQnLCAnbG9sc3kudHYnLCAnYW5pbWVzLW1hbmdhcy1kZGwuY29tJywgJ25vdGljaWFzYXV0b21vdGl2YXMuY29tLmJyJywgJ2RhcmtzdGFycy5vcmcnLCAnY29yZXBhY2tzLmNvbScsICduYXR1cmFsYmQuY29tJywgJ2Nvb2xzb2Z0LmFsdGVydmlzdGEub3JnJywgJ29wZW5sb2FkLnVzJywgJ2NkYS1vbmxpbmUucGwnLCAndXJiYW5wbGFuZXQub3JnJywgJ21hbWFoZC5jb20nLCAnc2FkZWVtcGMuY29tJywgJ2F2bW9vLmNvbScsICd0aGFpbGFuZGUtZnIuY29tJywgJ2J0YWlhLmNvbScsICd0dXNvZnQub3JnJywgJ2hpc3NlLm5ldCcsICdldXJvcGV1cC5jb20nLCAnbnJqLmZyJywgJ3NybmsuY28nLCAnYW5pbW1leC5jbycsICdzb2NrZXRsb29wLmNvbScsICdjcmFja2hleC5jb20nLCAncmV2ZWFsZWR0cmlja3M0dS5jb20nLCAncGl6emFtYWtpbmcuY29tJywgJ2NvbXB1dGVyd29ybS5uZXQnLCAneW91cmxpZmV1cGRhdGVkLm5ldCddLAogICAgICAgIG9uU3RhcnQgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBBYWsuYWRkU2NyaXB0KGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgLy8gdmFyaWFudCAxCiAgICAgICAgICAgIChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgdmFyIF9zZXRUaW1lb3V0ID0gd2luZG93LnNldFRpbWVvdXQ7CiAgICAgICAgICAgICAgd2luZG93LnNldFRpbWVvdXQgPSBmdW5jdGlvbiAoZm4sIGRlbGF5KSB7CiAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhmbi50b1N0cmluZygpKQogICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBmbiA9PT0gJ3N0cmluZycgJiYgZm4uaW5kZXhPZignYmFiX2VsZW1lbnRpZCcpID4gLTEpIHsKICAgICAgICAgICAgICAgICAgZm4gPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5pbmZvKFsnQW50aUFkYktpbGxlcicsIGxvY2F0aW9uLmhvc3QsICdCbG9ja0FkQmxvY2snXSk7CiAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBfc2V0VGltZW91dC5jYWxsKHRoaXMsIGZuLCBkZWxheSk7CiAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgfSkoKTsKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfSwKICAgICAgZ3B0X3NwIDogewogICAgICAgIC8vIGJ5OiBSZWVrLCBHaXdheXVtZQogICAgICAgIC8vIG5vdGU6IHdoZW4gYWRibG9jayBkZXRlY3RlZCBpbmplY3QgbmV3IGFkcywgcmVkaXJlY3QgdG8gaHR0cDovL3Rpbnl1cmwuY29tL3pxMno1bzYKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXMvMTYzNgogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcy8xNTk2CiAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzLzEyOTcKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXMvMTE0NAogICAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcy8xNTQyCiAgICAgICAgLy8gc291cmNlOiBodHRwOi8vcGFzdGViaW4uY29tLzhBaml0ZmIyCiAgICAgICAgaG9zdCA6IFsnbWFya2V0d2F0Y2guY29tJywgJ2RlYWRsaW5lLmNvbScsICd0d2Vha3Rvd24uY29tJywgJ255cG9zdC5jb20nLCAncmVhbGdtLmNvbScsICduYXNkYXEuY29tJ10sCiAgICAgICAgb25TdGFydCA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIEFhay5hZGRTdHlsZSgiLmNvbnRhaW5lci0tYmFubmVyQWQsIC5jb2wtLWFkIHsgZGlzcGxheTogbm9uZTsgfSIpOwogICAgICAgICAgQWFrLmFkZFNjcmlwdChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgLy8gR2l3YXl1bWUgCiAgICAgICAgICAgICAgd2luZG93Ll9zcF8gPSB3aW5kb3cuX3NwXyB8fCB7fTsKICAgICAgICAgICAgICB3aW5kb3cuX3NwXy5jb25maWcgPSB3aW5kb3cuX3NwXy5jb25maWcgfHwge307CiAgICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHdpbmRvdy5fc3BfLmNvbmZpZywgImNvbnRlbnRfY29udHJvbF9jYWxsYmFjayIsIHsKICAgICAgICAgICAgICAgIHZhbHVlIDogZnVuY3Rpb24gKCkge30sCiAgICAgICAgICAgICAgICB3cml0YWJsZSA6IGZhbHNlLAogICAgICAgICAgICAgICAgY29uZmlndXJhYmxlIDogZmFsc2UKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAvLyBSZWVrCiAgICAgICAgICAgICAgdmFyIF9hZGRFdmVudExpc3RlbmVyID0gd2luZG93LkV2ZW50VGFyZ2V0LnByb3RvdHlwZS5hZGRFdmVudExpc3RlbmVyOwogICAgICAgICAgICAgIHdpbmRvdy5FdmVudFRhcmdldC5wcm90b3R5cGUuYWRkRXZlbnRMaXN0ZW5lciA9IGZ1bmN0aW9uICh0eXBlLCBsaXN0ZW5lciwgb3B0aW9ucykgewogICAgICAgICAgICAgICAgaWYgKHR5cGUgPT0gJ3NwLmJsb2NraW5nJykgewogICAgICAgICAgICAgICAgICBsaXN0ZW5lciA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmluZm8oWydBbnRpQWRiS2lsbGVyJywgbG9jYXRpb24uaG9zdCwgJ0dQVHtzcC1ibG9ja2luZ30nXSk7CiAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBfYWRkRXZlbnRMaXN0ZW5lci5jYWxsKHRoaXMsIHR5cGUsIGxpc3RlbmVyLCBvcHRpb25zKTsKICAgICAgICAgICAgICB9OwogICAgICAgICAgICB9KSgpOwogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9LAogICAgICBrcnV4X2FzbCA6IHsKICAgICAgICAvLyBub3RlOiB3aGVuIGFkYmxvY2sgZGV0ZWN0ZWQgaW5qZWN0IG5ldyBhZHMKICAgICAgICAvLyBzb3VyY2U6IGh0dHA6Ly9wYXN0ZWJpbi5jb20vMEhEN044NGkKICAgICAgICBob3N0IDogWydjb21tZW50Y2FtYXJjaGUubmV0JywgJ2pvdXJuYWxkZXNmZW1tZXMuY29tJywgJ2xpbnRlcm5hdXRlLmNvbSddLAogICAgICAgIG9uQmVmb3JlU2NyaXB0IDogZnVuY3Rpb24gKCkgewogICAgICAgICAgcmV0dXJuIFt7CiAgICAgICAgICAgICAgZGV0ZWN0ZWQgOiAnS3J1eHthc2x9JywKICAgICAgICAgICAgICBjb250YWlucyA6ICdBc2wucHJvdG90eXBlLmluamVjdCcsCiAgICAgICAgICAgICAgZXh0ZXJuYWwgOiBmYWxzZSwKICAgICAgICAgICAgICByZW1vdmUgOiB0cnVlCiAgICAgICAgICAgIH0KICAgICAgICAgIF07CiAgICAgICAgfQogICAgICB9LAogICAgICBrcnV4X2FkcCA6IHsKICAgICAgICAvLyBub3RlOiB3aGVuIGFkYmxvY2sgZGV0ZWN0ZWQgaW5qZWN0IG5ldyBhZHMKICAgICAgICAvLyBzb3VyY2U6IAogICAgICAgIGhvc3QgOiBbJ2ZvdXJjaGV0dGUtZXQtYmlraW5pLmZyJywgJ21ldGVvY2l0eS5jb20nXSwKICAgICAgICBvblN0YXJ0IDogZnVuY3Rpb24gKCkgewogICAgICAgICAgQWFrLnV3LmFkUHJvdGVjdCA9IDE7CiAgICAgICAgfQogICAgICB9LAkgCiAgICAgIHBob2VuaXhfZ295YXZlbGFiIDogewogICAgICAgIC8vIG5vdGU6IHdoZW4gYWRibG9jayBkZXRlY3RlZCBpbmplY3QgbmV3IGFkcwogICAgICAgIC8vIG5vdGU6IHNjcmlwdCBhbnRpLWFkYmxvY2sgb2JmdXNjYXRlZCwKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXMvCiAgICAgICAgLy8gZG9jOiBodHRwOi8vdGlueXVybC5jb20vZ2wzZ2hxMgogICAgICAgIC8vIHNvdXJjZTogaHR0cDovL3Bhc3RlYmluLmNvbS9oc0FtZFN1ZgogICAgICAgIGhvc3QgOiBbJ2RlbW8tcGhvZW5peC5jb20nLCAnZHBzdHJlYW0ubmV0JywgJ2d1bS1ndW0tc3RyZWFtaW5nLmNvbScsICdqZXUuaW5mbycsICdzb2Zvb3QuY29tJywgJ2dhYXJhLWZyLmNvbScsICdnYXl0dWJlLmNvbScsICd0dXhib2FyZC5jb20nLCAneHN0b3J5LWZyLmNvbScsICdoZW50YWlmci5uZXQnLCAnZmlsbXN0cmVhbWluZy1oZC5jb20nLCAnZmlsbXZmLm5ldCcsICdoZW50YWloYXZlbi5vcmcnLCAnbmFydXRvc2hpcHB1ZGVudmYuY29tJywgJ3RoZWJhZGJ1enouY29tJywgJ21hbmdhLW5ld3MuY29tJywgJ2pldS52aWRlbycsICdtYW5nYXMtZnIuY29tJ10sCiAgICAgICAgb25BbHdheXMgOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAvL0Fhay51dy5fXyRkYyA9IGZ1bmN0aW9uICgpIHt9OwogICAgICAgICAgQWFrLmFkZFN0eWxlKCdib2R5IHt2aXNpYmlsaXR5OiB2aXNpYmxlO30nKTsKICAgICAgICB9LAogICAgICAgIG9uQmVmb3JlU2NyaXB0IDogZnVuY3Rpb24gKCkgewogICAgICAgICAgcmV0dXJuIFt7IAogICAgICAgICAgICAgIGRldGVjdGVkIDogJ1Bob2VuaXhHb3lhdmVsYWInLAogICAgICAgICAgICAgIGNvbnRhaW5zIDogJ1BIRU5WJywKICAgICAgICAgICAgICBleHRlcm5hbCA6IGZhbHNlLAogICAgICAgICAgICAgIHJlbW92ZTogdHJ1ZQogICAgICAgICAgICB9CiAgICAgICAgICBdOwogICAgICAgIH0KICAgICAgfSwKICAgICAgYWRfZGVmZW5kX3VhYnAgOiB7CiAgICAgICAgLy8gbm90ZTogd2hlbiBhZGJsb2NrIGRldGVjdGVkIGluamVjdCBuZXcgYWRzCiAgICAgICAgLy8gc291cmNlOiBodHRwOi8vcGFzdGViaW4uY29tL2NGUUNwODBXCiAgICAgICAgaG9zdCA6IFsndHZzcGllbGZpbG0uZGUnLCAnZmluYW56ZW4uY2gnXSwKICAgICAgICBvbkJlZm9yZVNjcmlwdCA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHJldHVybiBbewogICAgICAgICAgICAgIGRldGVjdGVkIDogJ0FkRGVmZW5ke1VBQlBJbmplY3R9JywKICAgICAgICAgICAgICBjb250YWlucyA6ICdVQUJQSW5qZWN0JywKICAgICAgICAgICAgICBleHRlcm5hbCA6IGZhbHNlLAogICAgICAgICAgICAgIHJlbW92ZSA6IHRydWUKICAgICAgICAgICAgfQogICAgICAgICAgXTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIGFkX2RlZmVuZF91YWIgOiB7CiAgICAgICAgLy8gbm90ZTogd2hlbiBhZGJsb2NrIGRldGVjdGVkIGluamVjdCBuZXcgYWRzCiAgICAgICAgLy8gdXNlcnNjcmlwdDogaHR0cHM6Ly9vcGVudXNlcmpzLm9yZy9zY3JpcHRzL3NjaHdhcnp0ZWUvQWREZWZlbmRfS2xhdHNjaGUKICAgICAgICAvLyB1c2Vyc2NyaXB0OiBodHRwczovL2dpc3QuZ2l0aHViLmNvbS9hbm9ueW1vdXMvYTliOTk1NmJhZjFkNTlhMTA3YzUKICAgICAgICAvLyBzb3VyY2U6IGh0dHA6Ly9wYXN0ZWJpbi5jb20vMVZ5VzB1OW0sIGh0dHA6Ly9wYXN0ZWJpbi5jb20vQVpxaFJ4V1UKICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXM/cT1sYWJlbDpBZERlZmVuZAogICAgICAgIC8vIHB1bGw6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvcHVsbC80NjcKICAgICAgICBob3N0IDogWyd3YXRjaGdlbmVyYXRpb24uZnInLCAndHVyYm8uZnInLCAnMjRtYXRpbnMuZnInLCAnZm9vdDAxLmNvbScsICdjbHViaWMuY29tJywgJ21hY2cuY28nLCAnYmVnZWVrLmZyJywgJ2lnZW4uZnInLCAnZ2FtZXN0YXIuZGUnLCAnZm9jdXMuZGUnLCAnc3Rlcm4uZGUnLCAnc2F0MS4nLCAncHJvc2llYmVuLicsICdrYWJlbGVpbnMuJywgJ3NhdDFnb2xkLicsICdzaXh4LicsICdwcm9zaWViZW5tYXh4LicsICdmZW0uY29tJywgJ3RoZS12b2ljZS1vZi1nZXJtYW55LicsICd3ZXR0ZXIuY29tJywgJ3dldHRlcm9ubGluZS5kZScsICdwY3dlbHQuZGUnLCAnYm9lcnNlLW9ubGluZS5kZScsICdzcG9ydGF1dG8uZGUnLCAnYXV0by1tb3Rvci11bmQtc3BvcnQuZGUnLCAnbW90b3Ita2xhc3Npay5kZScsICc0d2hlZWxmdW4uZGUnLCAnYXV0b3N0cmFzc2VudmVya2Voci5kZScsICdsdXN0aWNoLmRlJywgJ3Nwb3guY29tJywgJ3Noei5kZScsICd0cmFuc2Zlcm1hcmt0LmRlJywgJ3JwLW9ubGluZS5kZScsICdtb3RvcnJhZG9ubGluZS5kZScsICcyMG1pbi5jaCcsICdtYWluLXNwaXR6ZS5kZScsICd3b3Jtc2VyLXplaXR1bmcuZGUnLCAnbGFtcGVydGhlaW1lci16ZWl0dW5nLmRlJywgJ3dpZXNiZGVuZXItdGFnYmxhdHQuZGUnLCAnYnVlcnN0YWVkdGVyLXplaXR1bmcuZGUnLCAnd2llc2JkZW5lci1rdXJpZXIuZGUnLCAncmhlaW4tbWFpbi1wcmVzc2UuZGUnLCAnYWxsZ2VtZWluZS16ZWl0dW5nLmRlJywgJ2FyaXZhLmRlJywgJ3NwaWVnZWwuZGUnLCAnYnJpZ2l0dGUuZGUnLCAnZHNoaW5pLm5ldCcsICdnYWxhLmRlJywgJ2dhbWVwcm8uZGUnLCAnZ2Ftb25hLmRlJywgJ3Bubi5kZScsICdwcm9tb2JpbC5kZScsICdzcG9ydGFsLmRlJywgJ3dlYmZhaWwuY29tJywgJ2NvbXB1dGVyYmlsZC5kZScsICdmaW5hbnplbi5uZXQnLCAnY29tdW5pby5kZScsICdtZWRpc2l0ZS5mciddLAogICAgICAgIG9uQmVmb3JlU2NyaXB0IDogZnVuY3Rpb24gKCkgewogICAgICAgICAgcmV0dXJuIFt7CiAgICAgICAgICAgICAgZGV0ZWN0ZWQgOiAnQWREZWZlbmR7dWFiSW5qZWN0fScsCiAgICAgICAgICAgICAgY29udGFpbnMgOiAndWFiSW5qZWN0JywKICAgICAgICAgICAgICBleHRlcm5hbCA6IGZhbHNlLAogICAgICAgICAgICAgIHJlbW92ZSA6IHRydWUKICAgICAgICAgICAgfQogICAgICAgICAgXTsKICAgICAgICB9CiAgICAgIH0sCiAgICAgIC8qIHNvbHZlZCBieSBBYWtMSXN0CiAgICAgIHRpc29vbWlfaW5kaXJla3QgOiB7CiAgICAgIC8vIGlubGluZTogaHR0cDovL3Bhc3RlYmluLmNvbS9ucG1YVFVIdwogICAgICAvLyBleHRlcm5hbDogaHR0cDovL3Bhc3RlYmluLmNvbS9odlduQ3VEdwogICAgICBob3N0IDogWydlbmVyZ3kuZGUnLCAnZ2V0dmlkcy5kZScsICdnZXdpbmRlLW5vcm1lbi5kZScsICdwb2RjYXN0LmRlJywgJ3NwaWVsZXNwaWVsZW4yNC5kZScsICdkaWFsby5kZSddLAogICAgICBvbkJlZm9yZVNjcmlwdCA6IGZ1bmN0aW9uIChlKSB7CiAgICAgIHZhciB0YXJnZXQgPSBlLnRhcmdldCB8fCBlLnNyY0VsZW1lbnQ7CiAgICAgIHZhciB0ZXh0ID0gdGFyZ2V0LnRleHQ7CiAgICAgIGlmIChBYWsuY29udGFpbnModGV4dCwgJ249ImFiY2RlZmdoaWprbG0iLHI9Im5vcHFyc3R1dnd4eXoiLGk9IjAxMjM0NTY3ODkiO3ZhciBzPXQ9PTA/aTp0PT0xP24nKSkgewogICAgICBBYWsuc3RvcFNjcmlwdChlKTsKICAgICAgQWFrLmxvZygnVGlzb29taSBJbmRpcmVrdCcpOwogICAgICB9CiAgICAgIH0KICAgICAgfSwKICAgICAgICovCiAgICAgIC8qIHNvbHZlZCBieSBBYWtMSXN0CiAgICAgIHRpc29vbWlfZGlyZWt0IDogewogICAgICAvLyBpbmxpbmU6IGh0dHA6Ly9wYXN0ZWJpbi5jb20vMnZxMzhKWFkKICAgICAgaG9zdCA6IFsnYXV0b3plaXR1bmcuZGUnLCAnZm9ybWVsMS5kZScsICdmcmVtZHdvcnQuZGUnLCAnaW5zaWRlLWhhbmR5LmRlJywgJ21vdG9yc3BvcnQtdG90YWwuY29tJywgJ2F1c3NlbndpcnRzY2hhZnRzbHVwZS5kZScsICdkb25uZXJ3ZXR0ZXIuZGUnLCAnd2ludG90YWwuZGUnXSwKICAgICAgb25CZWZvcmVTY3JpcHQgOiBmdW5jdGlvbiAoZSkgewogICAgICB2YXIgdGFyZ2V0ID0gZS50YXJnZXQgfHwgZS5zcmNFbGVtZW50OwogICAgICB2YXIgdGV4dCA9IHRhcmdldC50ZXh0OwogICAgICBpZiAoQWFrLmNvbnRhaW5zKHRleHQsICdmdW5jdGlvbiBkZXRlY3QoKScpKSB7CiAgICAgIEFhay5zdG9wU2NyaXB0KGUpOwogICAgICBBYWsubG9nKCdUaXNvb21pIERpcmVrdCcpOwogICAgICB9CiAgICAgIH0KICAgICAgfSwKICAgICAgICovCiAgICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgICAgIC8vIEdlbmVyaWMKICAgICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAgICAgZ2VuZXJpYyA6IHsKICAgICAgICBob3N0IDogWycuKj8nXSwKICAgICAgICBvblJlbW92ZSA6IGZ1bmN0aW9uIChyZW1vdmVkTm9kZSkgewogICAgICAgICAgaWYgKEFhay5vcHRzLnJlbW92ZWQpIHsKICAgICAgICAgICAgaWYgKHJlbW92ZWROb2RlLnNyYyB8fAogICAgICAgICAgICAgIHJlbW92ZWROb2RlLmlkIHx8CiAgICAgICAgICAgICAgcmVtb3ZlZE5vZGUuY2xhc3NOYW1lICYmCiAgICAgICAgICAgICAgIS9eZmlyZWJ1Zy8udGVzdChyZW1vdmVkTm9kZS5jbGFzc05hbWUpKSB7CiAgICAgICAgICAgICAgLy8gTm9kZSByZW1vdmVkCiAgICAgICAgICAgICAgQWFrLmxvZyhyZW1vdmVkTm9kZSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LAogICAgICAgIG9uU3RhcnQgOiBmdW5jdGlvbiAoKSB7CgogICAgICAgICAgLy8gRnVja0FkQmxvY2sgJiBCbG9ja0FkQmxvY2sgdjMgYW5kIHY0CiAgICAgICAgICAvLyBzaXRlOiBodHRwOi8vd3d3LnNpdGV4dy5mci9mdWNrYWRibG9jay8KICAgICAgICAgIC8vIHJlcG86IGh0dHBzOi8vZ2l0aHViLmNvbS9zaXRleHcvRnVja0FkQmxvY2sKICAgICAgICAgIC8vIHJlcG86IGh0dHBzOi8vZ2l0aHViLmNvbS9zaXRleHcvQmxvY2tBZEJsb2NrCiAgICAgICAgICAvLyBub3RlOiB3aGVuIGZ1Y2thZGJsb2NrLmpzIG9yIGJsb2NrYWRibG9jay5qcyBpcyBibG9ja2VkCiAgICAgICAgICAvLyBkZW1vIHYzOiBodHRwOi8vc2guc3Qvdm92SEUKICAgICAgICAgIC8vIGRlbW8gdjQ6IGh0dHA6Ly9hbC5seS9xQmJYSAogICAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzLzg4OAogICAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzLzgyNAogICAgICAgICAgQWFrLmZha2VGdWNrQWRCbG9jaygnZnVja0FkQmxvY2snLCAnRnVja0FkQmxvY2snKTsKICAgICAgICAgIEFhay5mYWtlRnVja0FkQmxvY2soJ2Jsb2NrQWRCbG9jaycsICdCbG9ja0FkQmxvY2snKTsKCiAgICAgICAgICAvLyBjYW5SdW5BZHMKICAgICAgICAgIC8vIHJlcG86IGh0dHBzOi8vZ2l0aHViLmNvbS9NYXR0aGV3R3Jvc3MvQ2FuUnVuQWRzCiAgICAgICAgICAvLyBub3RlOiB1c2UgZXh0ZXJuYWxsIHNjcmlwdCAiL2pzL2Fkcy5qcyIgLT4gdmFyIGNhblJ1bkFkcyA9IHRydWU7CiAgICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoQWFrLnV3LCAnY2FuUnVuQWRzJywgewogICAgICAgICAgICBlbnVtZXJhYmxlIDogdHJ1ZSwKICAgICAgICAgICAgd3JpdGFibGUgOiBmYWxzZSwKICAgICAgICAgICAgdmFsdWUgOiB0cnVlCiAgICAgICAgICB9KTsKCiAgICAgICAgICAvLyBjYW5TaG93QWRzCiAgICAgICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXMvMTE5NwogICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEFhay51dywgJ2NhblNob3dBZHMnLCB7CiAgICAgICAgICAgIGVudW1lcmFibGUgOiB0cnVlLAogICAgICAgICAgICB3cml0YWJsZSA6IGZhbHNlLAogICAgICAgICAgICB2YWx1ZSA6IHRydWUKICAgICAgICAgIH0pOwoKICAgICAgICAgIC8vIEFkYmxvY2tlciBEZXRlY3RpbmcgU2NyaXB0czogTWV0aG9kIDIKICAgICAgICAgIC8vIGdpc3Q6IGh0dHBzOi8vZ2lzdC5naXRodWIuY29tL2lyYXphc3llZC8zZDI0N2QzZDEyMWU3ODFhMzg3MgogICAgICAgICAgLy8gbm90ZTogdXNlIGV4dGVybmFsbCBzY3JpcHQgIi9qcy9hZHMuanMiIC0+IGlzQWRCbG9ja0FjdGl2ZSA9IGZhbHNlOwogICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEFhay51dywgJ2lzQWRCbG9ja0FjdGl2ZScsIHsKICAgICAgICAgICAgZW51bWVyYWJsZSA6IHRydWUsCiAgICAgICAgICAgIHdyaXRhYmxlIDogZmFsc2UsCiAgICAgICAgICAgIHZhbHVlIDogZmFsc2UKICAgICAgICAgIH0pOwoKICAgICAgICAgIC8qCiAgICAgICAgICB3aW5kb3cuaUhhdmVMb2FkZWRBZHMgPSB0cnVlOwogICAgICAgICAgdmFyIG5pY2VBZHNDaGVjaz10cnVlOwogICAgICAgICAgYWRibG9jayA9IGZhbHNlCiAgICAgICAgICBpc19ibG9ja2VyID0gZmFsc2U7CiAgICAgICAgICAgKi8KICAgICAgICB9LAogICAgICAgIG9uSWRsZSA6IGZ1bmN0aW9uICgpIHsKCiAgICAgICAgICAvLyBBZEJsb2NrIERldGVjdG9yIChYZW5Gb3JvIFJlbGxlY3QpCiAgICAgICAgICAvLyBzaXRlOiBodHRwOi8vdGlueXVybC5jb20vcGEyOHhkbgogICAgICAgICAgLy8gY2xvbmVJbnRvOiBodHRwOi8vdGlueXVybC5jb20vazZxcGhtZQogICAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzLzgwNQogICAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzLzgwNAogICAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzLzU5MQogICAgICAgICAgaWYgKEFhay51dy5YZW5Gb3JvICYmIHR5cGVvZiBBYWsudXcuWGVuRm9yby5yZWxsZWN0ID09ICdvYmplY3QnKSB7CiAgICAgICAgICAgIEFhay51dy5YZW5Gb3JvLnJlbGxlY3QgPSB7CiAgICAgICAgICAgICAgQWRCbG9ja0RldGVjdG9yIDogewogICAgICAgICAgICAgICAgc3RhcnQgOiBmdW5jdGlvbiAoKSB7fQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfTsKICAgICAgICAgICAgQWFrLmRldGVjdGVkKCdBZEJsb2NrIERldGVjdG9yIChYZW5Gb3JvIFJlbGxlY3QpJyk7CiAgICAgICAgICB9CgogICAgICAgICAgLyoKICAgICAgICAgIC8vIEFkdW5ibG9jayAtIGh0dHA6Ly9hZHVuYmxvY2suY29tLwogICAgICAgICAgaWYgKEFhay5nZXRDb29raWUoJ2FkYmxvY2snKSA9PSAxKSB7CiAgICAgICAgICBBYWsuc2V0Q29va2llKCdhZGJsb2NrJywgMCk7CiAgICAgICAgICBBYWsuc2V0Q29va2llKCdiYXJfY2xvc2VkJywgMSk7CiAgICAgICAgICB9CiAgICAgICAgICAgKi8KCiAgICAgICAgICAvLyBBZGJsb2NrIEJsb2NrZXIKICAgICAgICAgIC8vIGh0dHBzOi8vd29yZHByZXNzLm9yZy9wbHVnaW5zL2FkZGJsb2NrYmxvY2tlci8KICAgICAgICAgIC8vIGh0dHA6Ly90aW55dXJsLmNvbS9uc3duNmZ6CiAgICAgICAgICAvLyBodHRwOi8vcGFzdGViaW4uY29tL2Q2NXpyMzdtCiAgICAgICAgICAvKiBjYW4gY2F1c2UgYSBidWcKICAgICAgICAgIHZhciBhZHMgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdhZnNfYWRzJyk7CiAgICAgICAgICB2YXIgYWQgPSBhZHMubGVuZ3RoICYmIGFkc1thZHMubGVuZ3RoIC0gMV07CiAgICAgICAgICBpZiAoYWQgJiYgYWQuaW5uZXJIVE1MLmxlbmd0aCA9PT0gMCB8fCBhZC5jbGllbnRIZWlnaHQgPT09IDApIHsKICAgICAgICAgIEFhay5hZGRTY3JpcHQoZnVuY3Rpb24gKCkgewogICAgICAgICAgZ2V0RWxlbWVudHNCeUNsYXNzTmFtZU5hdGl2ZSA9IEhUTUxEb2N1bWVudC5wcm90b3R5cGUuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZTsKICAgICAgICAgIEhUTUxEb2N1bWVudC5wcm90b3R5cGUuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSA9IGZ1bmN0aW9uIChjbGFzc05hbWUpIHsKICAgICAgICAgIGlmIChjbGFzc05hbWUgPT0gJ2Fmc19hZHMnKSB7CiAgICAgICAgICBjb25zb2xlLmluZm8oWydBbnRpQWRiS2lsbGVyJywgbG9jYXRpb24uaG9zdCwgJ0FkYmxvY2tCbG9ja2VyJywgY2xhc3NOYW1lXSk7CiAgICAgICAgICB2YXIgdW5pcWlkID0gRGF0ZS5ub3coKTsKICAgICAgICAgIHZhciBiYWl0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2Iik7CiAgICAgICAgICBiYWl0LmlubmVySFRNTCA9ICc8YnI+JzsKICAgICAgICAgIGJhaXQuY2xhc3NOYW1lID0gdW5pcWlkOwogICAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChiYWl0KTsKICAgICAgICAgIHJldHVybiBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKHVuaXFpZCk7CiAgICAgICAgICB9CiAgICAgICAgICByZXR1cm4gZ2V0RWxlbWVudHNCeUNsYXNzTmFtZU5hdGl2ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICAgICAgfTsKICAgICAgICAgIH0pOwogICAgICAgICAgfQogICAgICAgICAgICovCgogICAgICAgICAgLy8gQWRidWRkeQogICAgICAgICAgaWYgKHR5cGVvZiBBYWsudXcuY2xvc2VBZGJ1ZGR5ID09PSAnZnVuY3Rpb24nKSB7CiAgICAgICAgICAgIEFhay51dy5jbG9zZUFkYnVkZHkoKTsKICAgICAgICAgICAgQWFrLmRldGVjdGVkKCdBZGJ1ZGR5Jyk7CiAgICAgICAgICB9CgogICAgICAgICAgLy8gQWRCbG9jayBBbGVydGVyIChXUCkKICAgICAgICAgIC8vIGh0dHBzOi8vZ2l0aHViLmNvbS93cC1wbHVnaW5zL2FkYmxvY2stYWxlcnRlcgogICAgICAgICAgLy8KICAgICAgICAgIGlmIChBYWsuZ2V0RWxlbWVudCgnZGl2LmFkYl9vdmVybGF5ID4gZGl2LmFkYl9tb2RhbF9pbWcnKSkgewogICAgICAgICAgICAvLyBSZW1vdmUgQWxlcnQgKyBBbGxvdyBTY3JvbGwKICAgICAgICAgICAgQWFrLnJlbW92ZUVsZW1lbnQoJ2Rpdi5hZGJfb3ZlcmxheScpOwogICAgICAgICAgICBBYWsuYWRkU3R5bGUoJ2h0bWwsYm9keSB7aGVpZ2h0OmF1dG87IG92ZXJmbG93OiBhdXRvO30nKTsKICAgICAgICAgICAgQWFrLmRldGVjdGVkKCdBZEJsb2NrQWxlcnRlcicpOwogICAgICAgICAgfQoKICAgICAgICAgIC8vIFVua25vdyBBbnRpIEFkQmxvY2sgc3lzdGVtCiAgICAgICAgICBpZiAoQWFrLmdldEVsZW1lbnQoJyNibG9ja2RpdicpICYmIEFhay5jb250YWlucyhBYWsuZ2V0RWxlbWVudCgnI2Jsb2NrZGl2JykuaW5uZXJIVE1MLCAnZGlzYWJsZSBhZCBibG9ja2luZyBvciB1c2UgYW5vdGhlciBicm93c2VyIHdpdGhvdXQgYW55IGFkYmxvY2tlciB3aGVuIHlvdSB2aXNpdCcpKSB7CiAgICAgICAgICAgIEFhay5yZW1vdmVFbGVtZW50KCcjYmxvY2tkaXYnKTsKICAgICAgICAgIH0KCiAgICAgICAgICAvLyBBbnRpYmxvY2sub3JnIHYyCiAgICAgICAgICAvLyBub3RlOiBkZXRlY3QgYW5kIHN0b3JlIGJsb2NrIGlkCiAgICAgICAgICAvLyBkZW1vOiBodHRwOi8vdGlueXVybC5jb20vbmh5aHB6awogICAgICAgICAgdmFyIHN0eWxlcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ3N0eWxlJyk7CiAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHN0eWxlcy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICB2YXIgc3R5bGUgPSBzdHlsZXNbaV07CiAgICAgICAgICAgIHZhciBjc3NSdWxlcyA9IHN0eWxlLnNoZWV0LmNzc1J1bGVzOwogICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IGNzc1J1bGVzLmxlbmd0aDsgaisrKSB7CiAgICAgICAgICAgICAgdmFyIGNzc1J1bGUgPSBjc3NSdWxlc1tqXTsKICAgICAgICAgICAgICB2YXIgY3NzVGV4dCA9IGNzc1J1bGUuY3NzVGV4dDsKICAgICAgICAgICAgICB2YXIgcGF0dGVybiA9IC9eIyhbYS16MC05XXs0LDEwfSkgfiBcKiBceyBkaXNwbGF5OiBub25lOyBcfS87CiAgICAgICAgICAgICAgaWYgKHBhdHRlcm4udGVzdChjc3NUZXh0KSkgewogICAgICAgICAgICAgICAgdmFyIGlkID0gcGF0dGVybi5leGVjKGNzc1RleHQpWzFdOwogICAgICAgICAgICAgICAgaWYgKEFhay5oYXNTY3JpcHQoIncuYWRkRXZlbnRMaXN0ZW5lcignbG9hZCcsIiArIGlkICsgIixmYWxzZSkiKSkgewogICAgICAgICAgICAgICAgICBBYWsuYWFicy5hYm8yID0gaWQ7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgfQoKICAgICAgICAgIHZhciB3aW4gPSBBYWsudXc7CiAgICAgICAgICBmb3IgKHZhciBwcm9wIGluIHdpbikgewogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgIGlmICghL153ZWJraXQvLnRlc3QocHJvcCkgJiYgL15bYS16MC05XXs0LDEyfSQvaS50ZXN0KHByb3ApICYmIHByb3AgIT09ICdkb2N1bWVudCcgJiYgKHdpbltwcm9wXWluc3RhbmNlb2YgSFRNTERvY3VtZW50KSA9PT0gZmFsc2UgJiYgd2luLmhhc093blByb3BlcnR5KHByb3ApICYmIHR5cGVvZiB3aW5bcHJvcF0gPT09ICdvYmplY3QnKSB7CiAgICAgICAgICAgICAgICB2YXIgbWV0aG9kID0gd2luW3Byb3BdOwoKICAgICAgICAgICAgICAgIC8vIEFudGlibG9jay5vcmcgdjMgJiBCZXR0ZXJTdG9wQWRibG9jawogICAgICAgICAgICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzLzgzMwogICAgICAgICAgICAgICAgaWYgKG1ldGhvZC5kZWZlckV4ZWN1dGlvbiAmJgogICAgICAgICAgICAgICAgICBtZXRob2QuZGlzcGxheU1lc3NhZ2UgJiYKICAgICAgICAgICAgICAgICAgbWV0aG9kLmdldEVsZW1lbnRCeSAmJgogICAgICAgICAgICAgICAgICBtZXRob2QuZ2V0U3R5bGUgJiYKICAgICAgICAgICAgICAgICAgbWV0aG9kLmluc2VydCAmJgogICAgICAgICAgICAgICAgICBtZXRob2QubmV4dEZ1bmN0aW9uKSB7CiAgICAgICAgICAgICAgICAgIGlmIChtZXRob2QudG9nZ2xlKSB7CiAgICAgICAgICAgICAgICAgICAgQWFrLmFhYnMuYnNhID0gcHJvcDsKICAgICAgICAgICAgICAgICAgICBBYWsuZGV0ZWN0ZWQoJ0JldHRlclN0b3BBZGJsb2Nre2RvbX0nKTsKICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICBBYWsuYWFicy5hYm8zID0gcHJvcDsKICAgICAgICAgICAgICAgICAgICBBYWsuZGV0ZWN0ZWQoJ0FudGlibG9jazN7ZG9tfScpOwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgIHdpbltwcm9wXSA9IG51bGw7IC8vIGtpbGwgaW5zdGFuY2UKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAvLyBCbG9ja0FkQmxvY2sKICAgICAgICAgICAgICAgIC8vIHNpdGU6IGJsb2NrYWRibG9jay5jb20KICAgICAgICAgICAgICAgIC8vIG5vdGU6IHJhbmRvbSBpbnN0YW5jZSBuYW1lCiAgICAgICAgICAgICAgICAvLyBzb3VyY2U6IGh0dHBzOi8vZ2lzdC5naXRodWIuY29tL1dhdGlsaW4vYWY3NWUwYTJlODJhMmVmYjM4NGJkZTljN2I0MWRlYzgKICAgICAgICAgICAgICAgIC8vIGlzc3VlczogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXM/cT1sYWJlbCUzQUJsb2NrQWRCbG9jawogICAgICAgICAgICAgICAgaWYgKG1ldGhvZC5iYWIpIHsgLy8gdmFyaWFudCAxCiAgICAgICAgICAgICAgICAgIEFhay5kZXRlY3RlZCgnQmxvY2tBZEJsb2Nre2RvbTp2YXJpYW50MX0nKTsKICAgICAgICAgICAgICAgICAgd2luW3Byb3BdID0gbnVsbDsKICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoT2JqZWN0LmtleXMobWV0aG9kKS5sZW5ndGggPT09IDMgJiYgT2JqZWN0LmtleXMobWV0aG9kKS5tYXAoZnVuY3Rpb24gKHZhbHVlLCBpbmRleCkgewogICAgICAgICAgICAgICAgICAgIHJldHVybiB2YWx1ZTsKICAgICAgICAgICAgICAgICAgfSkuam9pbigpLmxlbmd0aCA9PT0gMzIpIHsgLy8gdmFyaWFudCAyCiAgICAgICAgICAgICAgICAgIEFhay5kZXRlY3RlZCgnQmxvY2tBZEJsb2Nre2RvbTp2YXJpYW50Mn0nKTsKICAgICAgICAgICAgICAgICAgd2luW3Byb3BdID0gbnVsbDsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKCdlcnJvcicsIHByb3ApCiAgICAgICAgICAgIH0KICAgICAgICAgIH0KCiAgICAgICAgICAvLyBBbnRpLUFkYmxvY2tlcnMKICAgICAgICAgIHZhciBhYWJzID0gewogICAgICAgICAgICAvLyBQbHVnaW5zIFdvcmRQcmVzcwogICAgICAgICAgICBOb0FkQmxvY2sgOiAnKC9wbHVnaW5zL25vLWFkYmxvY2svfC9ibG9ja0Jsb2NrL2Jsb2NrQmxvY2suanF1ZXJ5LmpzKScsCiAgICAgICAgICAgIEJldHRlclN0b3BBZGJsb2NrIDogJygvcGx1Z2lucy9iZXR0ZXItc3RvcC1hZGJsb2NrL3xic2Etc2NyaXB0LWRvY3R5cGUuanN8YnNhLXNjcmlwdC1uby1kb2N0eXBlLmpzKScsCiAgICAgICAgICAgIEFkQmxvY2tCbG9ja2VyIDogJy9wbHVnaW5zL3dvcmRwcmVzcy1hZGJsb2NrLWJsb2NrZXIvJywKICAgICAgICAgICAgQW50aUJsb2NrQnVrc3NhQXltYW4gOiAnL3BsdWdpbnMvYW50aS1ibG9jay8nLAogICAgICAgICAgICBCbG9ja0FseXplciA6ICcvcGx1Z2lucy9ibG9ja2FseXplci1hZGJsb2NrLWNvdW50ZXIvJywKICAgICAgICAgICAgQWRCbG9ja2luZ0RldGVjdG9yIDogJy9wbHVnaW5zL2FkLWJsb2NraW5nLWRldGVjdG9yLycsCiAgICAgICAgICAgIC8vIFBsdWdpbnMgV2Vic2l0ZQogICAgICAgICAgICBBZHdvcmttZWRpYSA6ICcoYWR3b3JrbWVkaWF8bG94dGt8Y29udGVudGxvY2tpbmduZXR3b3JrcykuY29tL2dMb2FkZXIucGhwJywKICAgICAgICAgICAgQWRzY2VuZG1lZGlhIDogJ2Fkc2NlbmRtZWRpYS5jb20vZ3dqcy5waHAnLAogICAgICAgICAgICBGdWNrQWRCbG9jayA6ICcoL2Z1Y2thZGJsb2NrLmpzfC9ibG9ja2FkYmxvY2suanMpJywKICAgICAgICAgICAgalF1ZXJ5QWRCbG9jayA6ICcvanF1ZXJ5LmFkYmxvY2suanMnLAogICAgICAgICAgICBqUXVlcnlBZGJsb2NrRGV0ZWN0b3IgOiAnL2pxdWVyeS5hZGJsb2NrLWRldGVjdG9yLmpzJywKICAgICAgICAgICAgQWRCbG9ja0FkdmVydGlzZW1lbnQgOiAnL2FkdmVydGlzZW1lbnQuanMnLAogICAgICAgICAgICBBZEJsb2NrQWR2ZXJ0IDogJy9hZHZlcnQuanMnLAogICAgICAgICAgICBBZEJsb2NrQWR2Q3VzdG9tIDogJy9hZHZlcnRpc2VtZW50KC4rKS5qcycsCiAgICAgICAgICAgIEFkQmxvY2tBZGZyYW1lIDogJy9hZGZyYW1lLmpzJywKICAgICAgICAgICAgQW50aUFkQnVzdGVyIDogJy9hbnRpLWFkLWJ1c3Rlci5qcycsCiAgICAgICAgICAgIFJUS0FudGlBZGJsb2NrIDogJy9ibG9ja2Nha2UuanMnLAogICAgICAgICAgICBBZGJsb2NrRGV0ZWN0b3IgOiAnL0FkYmxvY2tEZXRlY3Rvci9oYW5kbGVyLm1pbi5qcycsCiAgICAgICAgICAgIGpRdWVyeUFudGlBZHNCbG9jayA6ICcvanF1ZXJ5LmFudGlhZHNibG9jay5qcycsCiAgICAgICAgICAgIEFkYnVkZHkgOiAnL2pzL2FkYnVkZHkubWluLmpzJywKICAgICAgICAgICAgQW50aUFEc0Jsb2NrZXIgOiAnL2FhZGIvc2NyaXB0LmpzJwogICAgICAgICAgfTsKCiAgICAgICAgICB2YXIgc2NyaXB0cyA9IGRvY3VtZW50LnNjcmlwdHM7CiAgICAgICAgICBmb3IgKHZhciB5ID0gMDsgeSA8IHNjcmlwdHMubGVuZ3RoOyB5KyspIHsKICAgICAgICAgICAgdmFyIHNjcmlwdCA9IHNjcmlwdHNbeV07CiAgICAgICAgICAgIGlmIChzY3JpcHQuc3JjKSB7CiAgICAgICAgICAgICAgZm9yICh2YXIga2V5IGluIGFhYnMpIHsKICAgICAgICAgICAgICAgIGlmIChuZXcgUmVnRXhwKGFhYnNba2V5XSwgJ2knKS50ZXN0KHNjcmlwdC5zcmMpKSB7CiAgICAgICAgICAgICAgICAgIEFhay5kZXRlY3RlZChba2V5LCBzY3JpcHQuc3JjXSk7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgfQoKICAgICAgICB9LAogICAgICAgIG9uSW5zZXJ0IDogZnVuY3Rpb24gKGluc2VydGVkTm9kZSkgewoKICAgICAgICAgIC8vIEFsbCBOb2RlcwogICAgICAgICAgaWYgKEFhay5vcHRzLmluc2VydGVkKSB7CiAgICAgICAgICAgIGlmIChpbnNlcnRlZE5vZGUuc3JjIHx8CiAgICAgICAgICAgICAgaW5zZXJ0ZWROb2RlLmlkIHx8CiAgICAgICAgICAgICAgaW5zZXJ0ZWROb2RlLmNsYXNzTmFtZSAmJgogICAgICAgICAgICAgICEvZmlyZWJ1Zy8udGVzdChpbnNlcnRlZE5vZGUuaW5uZXJIVE1MKSkgewogICAgICAgICAgICAgIC8vIE5vZGUgaW5zZXJ0ZWQKICAgICAgICAgICAgICBBYWsubG9nKGluc2VydGVkTm9kZSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KCiAgICAgICAgICAvLyBOby1BZGJsb2NrIC0gaHR0cDovL3d3dy5uby1hZGJsb2NrLmNvbS8KICAgICAgICAgIGlmIChpbnNlcnRlZE5vZGUuaWQgJiYKICAgICAgICAgICAgaW5zZXJ0ZWROb2RlLmlkLmxlbmd0aCA9PSA0ICYmCiAgICAgICAgICAgIC9eW2EtejAtOV17NH0kLy50ZXN0KGluc2VydGVkTm9kZS5pZCkgJiYKICAgICAgICAgICAgaW5zZXJ0ZWROb2RlLm5vZGVOYW1lID09ICdESVYnICYmCiAgICAgICAgICAgIGluc2VydGVkTm9kZS5maXJzdENoaWxkICYmCiAgICAgICAgICAgIGluc2VydGVkTm9kZS5maXJzdENoaWxkLmlkICYmCiAgICAgICAgICAgIGluc2VydGVkTm9kZS5maXJzdENoaWxkLmlkID09IGluc2VydGVkTm9kZS5pZCAmJgogICAgICAgICAgICBBYWsuY29udGFpbnMoaW5zZXJ0ZWROb2RlLmlubmVySFRNTCwgJ25vLWFkYmxvY2suY29tJykpIHsKICAgICAgICAgICAgLy8gUmVtb3ZlCiAgICAgICAgICAgIEFhay5kZXRlY3RlZCgnTm8tQWRibG9jaycsIGZhbHNlLCBsb2NhdGlvbi5ocmVmKTsKICAgICAgICAgICAgQWFrLnJlbW92ZUVsZW1lbnQoaW5zZXJ0ZWROb2RlKTsKICAgICAgICAgICAgLy9BYWsubG9nKGluc2VydGVkTm9kZSk7CiAgICAgICAgICB9CgogICAgICAgICAgLy8gU3RvcEFkYmxvY2sgLSBodHRwOi8vc3RvcGFkYmxvY2sub3JnL2Rvd25sb2Fkcy8KICAgICAgICAgIGlmIChpbnNlcnRlZE5vZGUuaWQgJiYKICAgICAgICAgICAgaW5zZXJ0ZWROb2RlLmlkLmxlbmd0aCA9PSA3ICYmCiAgICAgICAgICAgIC9eYVthLXowLTldezZ9JC8udGVzdChpbnNlcnRlZE5vZGUuaWQpICYmCiAgICAgICAgICAgIGluc2VydGVkTm9kZS5ub2RlTmFtZSA9PSAnRElWJyAmJgogICAgICAgICAgICBpbnNlcnRlZE5vZGUucGFyZW50Tm9kZSAmJgogICAgICAgICAgICBpbnNlcnRlZE5vZGUucGFyZW50Tm9kZS5pZCAmJgogICAgICAgICAgICBpbnNlcnRlZE5vZGUucGFyZW50Tm9kZS5pZCA9PSBpbnNlcnRlZE5vZGUuaWQgKyAnMicgJiYKICAgICAgICAgICAgQWFrLmNvbnRhaW5zKGluc2VydGVkTm9kZS5pbm5lckhUTUwsICdzdG9wYWRibG9jay5vcmcnKSkgewogICAgICAgICAgICAvLyBSZW1vdmUKICAgICAgICAgICAgQWFrLmRldGVjdGVkKCdTdG9wQWRCbG9jaycsIGZhbHNlLCBsb2NhdGlvbi5ocmVmKTsKICAgICAgICAgICAgQWFrLnJlbW92ZUVsZW1lbnQoaW5zZXJ0ZWROb2RlKTsKICAgICAgICAgICAgLy9BYWsubG9nKGluc2VydGVkTm9kZSk7CiAgICAgICAgICB9CgogICAgICAgICAgLy8gQW50aUFkYmxvY2sgKFBhY2tlcikKICAgICAgICAgIHZhciByZUlmcmFtZUlkID0gL14oemR8d2QpJC87CiAgICAgICAgICB2YXIgcmVJbWdJZCA9IC9eKHhkfGdkKSQvOwogICAgICAgICAgdmFyIHJlSW1nU3JjID0gL1wvYWRzXC9iYW5uZXIuanBnLzsKICAgICAgICAgIHZhciByZUlmcmFtZVNyYyA9IC8oXC9hZGhhbmRsZXJcL3xcL2FkaW1hZ2VzXC98YWQuaHRtbCkvOwoKICAgICAgICAgIC8vIENvbW11bnMKICAgICAgICAgIGlmIChpbnNlcnRlZE5vZGUuaWQgJiYKICAgICAgICAgICAgcmVJbWdJZC50ZXN0KGluc2VydGVkTm9kZS5pZCkgJiYKICAgICAgICAgICAgaW5zZXJ0ZWROb2RlLm5vZGVOYW1lID09ICdJTUcnICYmCiAgICAgICAgICAgIHJlSW1nU3JjLnRlc3QoaW5zZXJ0ZWROb2RlLnNyYykgfHwKICAgICAgICAgICAgaW5zZXJ0ZWROb2RlLmlkICYmCiAgICAgICAgICAgIHJlSWZyYW1lSWQudGVzdChpbnNlcnRlZE5vZGUuaWQpICYmCiAgICAgICAgICAgIGluc2VydGVkTm9kZS5ub2RlTmFtZSA9PSAnSUZSQU1FJyAmJgogICAgICAgICAgICByZUlmcmFtZVNyYy50ZXN0KGluc2VydGVkTm9kZS5zcmMpKSB7CgogICAgICAgICAgICAvLyBWYXJpYW50IDEKICAgICAgICAgICAgaWYgKGluc2VydGVkTm9kZS5pZCA9PSAneGQnKSB7CiAgICAgICAgICAgICAgQWFrLmRldGVjdGVkKCdBbnRpQWRibG9ja1BhY2tlclpkeGQnLCBmYWxzZSwgbG9jYXRpb24uaHJlZik7CiAgICAgICAgICAgIH0gLy8gVmFyaWFudCAyCiAgICAgICAgICAgIGVsc2UgaWYgKGluc2VydGVkTm9kZS5pZCA9PSAnZ2QnKSB7CiAgICAgICAgICAgICAgQWFrLmRldGVjdGVkKCdBbnRpQWRibG9ja1BhY2tlcldkZ2QnLCBmYWxzZSwgbG9jYXRpb24uaHJlZik7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgLy8gUmVtb3ZlCiAgICAgICAgICAgIC8vQWFrLmxvZyhpbnNlcnRlZE5vZGUpOwogICAgICAgICAgICBBYWsucmVtb3ZlRWxlbWVudChpbnNlcnRlZE5vZGUpOwogICAgICAgICAgfQoKICAgICAgICAgIC8vIEFkdW5ibG9jayAtIGh0dHA6Ly9hZHVuYmxvY2suY29tLwogICAgICAgICAgdmFyIHJlSWQgPSAvXlthLXpdezh9JC87CiAgICAgICAgICB2YXIgcmVDbGFzcyA9IC9eW2Etel17OH0gW2Etel17OH0vOwogICAgICAgICAgdmFyIHJlQmcgPSAvXlthLXpdezh9LWJnJC87CiAgICAgICAgICB2YXIgcmVNZXNzYWdlID0gL0lsIHNlbWJsZXJhaXQgcXVlIHZvdXMgdXRpbGlzaWV6IHVuIGJsb3F1ZXVyIGRlIHB1YmxpY2l0w6kgIS87CgogICAgICAgICAgLy8gQ29tbXVucwogICAgICAgICAgaWYgKHR5cGVvZiBBYWsudXcudnRmYWIgIT0gJ3VuZGVmaW5lZCcgJiYKICAgICAgICAgICAgdHlwZW9mIEFhay51dy5hZGJsb2NrX2FudGliICE9ICd1bmRlZmluZWQnICYmCiAgICAgICAgICAgIGluc2VydGVkTm9kZS5wYXJlbnROb2RlICYmCiAgICAgICAgICAgIGluc2VydGVkTm9kZS5wYXJlbnROb2RlLm5vZGVOYW1lID09ICdCT0RZJyAmJgogICAgICAgICAgICBpbnNlcnRlZE5vZGUuaWQgJiYKICAgICAgICAgICAgcmVJZC50ZXN0KGluc2VydGVkTm9kZS5pZCkgJiYKICAgICAgICAgICAgaW5zZXJ0ZWROb2RlLm5vZGVOYW1lID09ICdESVYnICYmCiAgICAgICAgICAgIGluc2VydGVkTm9kZS5uZXh0U2libGluZyAmJgogICAgICAgICAgICBpbnNlcnRlZE5vZGUubmV4dFNpYmxpbmcuY2xhc3NOYW1lICYmCiAgICAgICAgICAgIGluc2VydGVkTm9kZS5uZXh0U2libGluZy5ub2RlTmFtZSA9PSAnRElWJykgewoKICAgICAgICAgICAgLy8gRnVsbCBTY3JlZW4gTWVzc2FnZSAoUHJlbWl1bSkKICAgICAgICAgICAgLy8gPGRpdiBpZD0ibGZ5aHN2ZHEiIGNsYXNzPSJ0dndub3FkZiBzdm9uZXhyayIgc3R5bGU9InRvcDogMTAwcHg7IG9wYWNpdHk6IDE7IHZpc2liaWxpdHk6IHZpc2libGU7Ij4KICAgICAgICAgICAgLy8gPGRpdiBjbGFzcz0idHZ3bm9xZGYtYmciIHN0eWxlPSJkaXNwbGF5OiBibG9jazsiPjwvZGl2PgogICAgICAgICAgICBpZiAoaW5zZXJ0ZWROb2RlLmNsYXNzTmFtZSAmJgogICAgICAgICAgICAgIHJlQ2xhc3MudGVzdChpbnNlcnRlZE5vZGUuY2xhc3NOYW1lKSAmJgogICAgICAgICAgICAgIHJlQmcudGVzdChpbnNlcnRlZE5vZGUubmV4dFNpYmxpbmcuY2xhc3NOYW1lKSAmJgogICAgICAgICAgICAgIGluc2VydGVkTm9kZS5uZXh0U2libGluZy5zdHlsZSAmJgogICAgICAgICAgICAgIGluc2VydGVkTm9kZS5uZXh0U2libGluZy5zdHlsZS5kaXNwbGF5ICE9ICdub25lJykgewoKICAgICAgICAgICAgICAvLyBSZW1vdmUgTWVzc2FnZQogICAgICAgICAgICAgIEFhay5kZXRlY3RlZCgiQWRVbkJsb2NrUHJlbWl1bSIpOwogICAgICAgICAgICAgIEFhay5yZW1vdmVFbGVtZW50KGluc2VydGVkTm9kZS5uZXh0U2libGluZyk7IC8vIG92ZXJsYXkKICAgICAgICAgICAgICBBYWsucmVtb3ZlRWxlbWVudChpbnNlcnRlZE5vZGUpOyAvLyBib3gKICAgICAgICAgICAgfQogICAgICAgICAgICAvLyBUb3AgYmFyIE1lc3NhZ2UgKEZyZWUpCiAgICAgICAgICAgIC8vIDxkaXYgaWQ9InZpeG1ncmx5Ij4KICAgICAgICAgICAgLy8gPGRpdiBpZD0ibWZuaGFpeXgiIGNsYXNzPSJsa3JudmJ5dCI+CiAgICAgICAgICAgIGVsc2UgaWYgKGluc2VydGVkTm9kZS5uZXh0U2libGluZy5pZCAmJgogICAgICAgICAgICAgIHJlSWQudGVzdChpbnNlcnRlZE5vZGUubmV4dFNpYmxpbmcuaWQpICYmCiAgICAgICAgICAgICAgcmVNZXNzYWdlLnRlc3QoaW5zZXJ0ZWROb2RlLmlubmVySFRNTCkpIHsKCiAgICAgICAgICAgICAgLy8gUmVtb3ZlIE1lc3NhZ2UKICAgICAgICAgICAgICBBYWsuZGV0ZWN0ZWQoIkFkVW5CbG9ja0ZyZWUiKTsKICAgICAgICAgICAgICBBYWsucmVtb3ZlRWxlbWVudChpbnNlcnRlZE5vZGUpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CgogICAgICAgICAgLy8gQW50aWJsb2NrIC0gaHR0cDovL2FudGlibG9jay5vcmcvCiAgICAgICAgICB2YXIgcmVNc2dJZCA9IC9eW2EtejAtOV17NCwxMH0kL2k7CiAgICAgICAgICB2YXIgcmVUYWcxID0gL14oZGl2fHNwYW58YnxpfGZvbnR8c3Ryb25nfGNlbnRlcikkL2k7CiAgICAgICAgICB2YXIgcmVUYWcyID0gL14oYXxifGl8c3x1fHF8cHxzdHJvbmd8Y2VudGVyKSQvaTsKICAgICAgICAgIHZhciByZVdvcmRzMSA9IC9hZCBibG9ja2VyfGFkIGJsb2NrfGFkLWJsb2NrfGFkYmxvY2tlcnxhZC1ibG9ja2VyfGFkYmxvY2t8YmxvcXVldXJ8YmxvcXVlYWRvcnxXZXJiZWJsb2NrZXJ8YWRibG9ja2VydHwmIzE1NzA7JiMxNTgzOyYjMTU3NjsmIzE2MDQ7JiMxNjA4OyYjMTYwMzsgJiMxNTc2OyYjMTYwNDsmIzE1ODc7fNCx0LvQvtC60LjRgNC+0LLRidC40LrQvtC8L2k7CiAgICAgICAgICB2YXIgcmVXb3JkczIgPSAva2FwYXR8ZGlzYWJsZXxkw6lzYWN0aXZlenxkw6lzYWN0aXZlcnxkZXNhY3RpdmV6fGRlc2FjdGl2ZXJ8ZGVzYXRpdmV8ZGVzYWN0aXZhcnxkZXNhY3RpdmV8ZGVzYWN0aXZhfGRlYWt0aXZpZXJlfGRpc2FiaWxpdGFyZXwmIzk0NTsmIzk2MDsmIzk0OTsmIzk1NzsmIzk0OTsmIzk2MTsmIzk0NzsmIzk1OTsmIzk2MDsmIzk1OTsmIzk0MzsmIzk1MTsmIzk2MzsmIzk1MTt8JiMxMDc5OyYjMTA3MjsmIzEwODc7JiMxMDg4OyYjMTA3NzsmIzEwOTc7JiMxMDcyOyYjMTA5MDsmIzExMDA7fMOhbGzDrXRzZCBsZXxwdWJsaWNpdMOpc3zRgNC10LrQu9Cw0LzQtXx2ZXJoaW5kZXJ0fGFkdmVydHxrYXBhdMSxbsSxei9pOwoKICAgICAgICAgIC8vIEFudGlibG9jay5vcmcgKGFsbCB2ZXJzaW9uKQogICAgICAgICAgaWYgKGluc2VydGVkTm9kZS5wYXJlbnROb2RlICYmCiAgICAgICAgICAgIGluc2VydGVkTm9kZS5pZCAmJgogICAgICAgICAgICBpbnNlcnRlZE5vZGUuc3R5bGUgJiYKICAgICAgICAgICAgaW5zZXJ0ZWROb2RlLmNoaWxkTm9kZXMubGVuZ3RoICYmCiAgICAgICAgICAgIGluc2VydGVkTm9kZS5maXJzdENoaWxkICYmCiAgICAgICAgICAgICFpbnNlcnRlZE5vZGUuZmlyc3RDaGlsZC5pZCAmJgogICAgICAgICAgICAhaW5zZXJ0ZWROb2RlLmZpcnN0Q2hpbGQuY2xhc3NOYW1lICYmCiAgICAgICAgICAgIHJlTXNnSWQudGVzdChpbnNlcnRlZE5vZGUuaWQpICYmCiAgICAgICAgICAgIHJlVGFnMS50ZXN0KGluc2VydGVkTm9kZS5ub2RlTmFtZSkgJiYKICAgICAgICAgICAgcmVUYWcyLnRlc3QoaW5zZXJ0ZWROb2RlLmZpcnN0Q2hpbGQubm9kZU5hbWUpKSB7CiAgICAgICAgICAgIC8vQWFrLmxvZyhpbnNlcnRlZE5vZGUpOwoKICAgICAgICAgICAgLy8gS2lsbCBhdWRpbyBtZXNzYWdlCiAgICAgICAgICAgIHZhciBhdWRpbyA9IGluc2VydGVkTm9kZS5xdWVyeVNlbGVjdG9yKCJhdWRpb1tsb29wXSIpOwogICAgICAgICAgICBpZiAoYXVkaW8pIHsKICAgICAgICAgICAgICBhdWRpby5wYXVzZSgpOwogICAgICAgICAgICAgIEFhay5kZXRlY3RlZCgnQW50aWJsb2Nre2F1ZGlvfScpOwogICAgICAgICAgICAgIEFhay5yZW1vdmVFbGVtZW50KGF1ZGlvKTsKICAgICAgICAgICAgfQogICAgICAgICAgICAvLyBBbnRpYmxvY2sub3JnIHYyCiAgICAgICAgICAgIC8vIGRlbW86IGh0dHA6Ly90aW55dXJsLmNvbS9oM213dGE0CiAgICAgICAgICAgIGVsc2UgaWYgKChBYWsuYWFicy5hYm8yICYmIGluc2VydGVkTm9kZS5pZCA9PSBBYWsuYWFicy5hYm8yKSB8fAogICAgICAgICAgICAgIChpbnNlcnRlZE5vZGUuZmlyc3RDaGlsZC5oYXNDaGlsZE5vZGVzKCkgJiYgcmVXb3JkczEudGVzdChpbnNlcnRlZE5vZGUuZmlyc3RDaGlsZC5pbm5lckhUTUwpICYmIHJlV29yZHMyLnRlc3QoaW5zZXJ0ZWROb2RlLmZpcnN0Q2hpbGQuaW5uZXJIVE1MKSkpIHsKICAgICAgICAgICAgICBBYWsuZGV0ZWN0ZWQoJ0FudGlibG9jazJ7aW5zZXJ0fScpOwogICAgICAgICAgICAgIEFhay5yZW1vdmVFbGVtZW50KGluc2VydGVkTm9kZSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgLy8gQW50aWJsb2NrLm9yZyB2MwogICAgICAgICAgICAvLyBkZW1vOiBodHRwOi8vdGlueXVybC5jb20vcWVjZmE3dwogICAgICAgICAgICAvLyBjYXNlOiBodHRwOi8vdGlueXVybC5jb20vemJybHIzYSAvKiBmb3JrICovCiAgICAgICAgICAgIGVsc2UgaWYgKChBYWsuYWFicy5hYm8zICYmIGluc2VydGVkTm9kZS5pZCA9PSBBYWsuYWFicy5hYm8zKSB8fAogICAgICAgICAgICAgIChpbnNlcnRlZE5vZGUuZmlyc3RDaGlsZC5oYXNDaGlsZE5vZGVzKCkgJiYgaW5zZXJ0ZWROb2RlLmZpcnN0Q2hpbGQuZmlyc3RDaGlsZC5ub2RlTmFtZSA9PSAnSU1HJyAmJiAvXmRhdGE6aW1hZ2VcL3BuZztiYXNlNjQvLnRlc3QoaW5zZXJ0ZWROb2RlLmZpcnN0Q2hpbGQuZmlyc3RDaGlsZC5zcmMpKSkgewogICAgICAgICAgICAgIEFhay51d1tBYWsuYWFicy5hYm8zXSA9IG51bGw7CiAgICAgICAgICAgICAgQWFrLmRldGVjdGVkKCdBbnRpYmxvY2sze2luc2VydH0nKTsKICAgICAgICAgICAgICBBYWsucmVtb3ZlRWxlbWVudChpbnNlcnRlZE5vZGUpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIC8vIEJldHRlclN0b3BBZGJsb2NrCiAgICAgICAgICAgIC8vIGRlbW86IGh0dHA6Ly90aW55dXJsLmNvbS9qczl6YXQ0CiAgICAgICAgICAgIC8vIHNvdXJjZTogaHR0cDovL3Bhc3RlYmluLmNvbS9ZaW1rcnRLQgogICAgICAgICAgICAvLyBpc3N1ZTogaHR0cDovL3Rpbnl1cmwuY29tL3pldGdidHgKICAgICAgICAgICAgZWxzZSBpZiAoQWFrLmFhYnMuYnNhICYmIGluc2VydGVkTm9kZS5pZCA9PSBBYWsuYWFicy5ic2EpIHsKICAgICAgICAgICAgICBBYWsudXdbQWFrLmFhYnMuYnNhXSA9IG51bGw7CiAgICAgICAgICAgICAgQWFrLmRldGVjdGVkKCdCZXR0ZXJTdG9wQWRibG9ja3tpbnNlcnR9Jyk7CiAgICAgICAgICAgICAgQWFrLnJlbW92ZUVsZW1lbnQoaW5zZXJ0ZWROb2RlKTsKICAgICAgICAgICAgfQogICAgICAgICAgICAvLyAgTWFueSBmYWxzZSBwb3NpdGl2ZQogICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAvL0Fhay5yZW1vdmVFbGVtZW50KGluc2VydGVkTm9kZSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICBibG9ja0RldGVjdCA6IGZ1bmN0aW9uICgpIHsKCiAgICAgIC8vIEV4Y2x1ZGUgZG9tYWlucwogICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXMvMTQ2NgogICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXMvMTI2MwogICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9ncmVhc3lmb3JrLm9yZy9lbi9mb3J1bS9kaXNjdXNzaW9uLzg0MjIvCiAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcy85ODYKICAgICAgLy8gaXNzdWU6IGh0dHBzOi8vZ2l0aHViLmNvbS9yZWVrL2FudGktYWRibG9jay1raWxsZXIvaXNzdWVzLzg1NwogICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXMvNjE3CiAgICAgIC8vIGlzc3VlOiBodHRwczovL2dyZWFzeWZvcmsub3JnL2ZyL2ZvcnVtL2Rpc2N1c3Npb24vNTQyNgogICAgICAvLyBpc3N1ZTogaHR0cHM6Ly9naXRodWIuY29tL3JlZWsvYW50aS1hZGJsb2NrLWtpbGxlci9pc3N1ZXMvNDE5CiAgICAgIC8vIGlzc3VlOiBodHRwczovL2dpdGh1Yi5jb20vcmVlay9hbnRpLWFkYmxvY2sta2lsbGVyL2lzc3Vlcy8zNzcKICAgICAgdmFyIGV4Y2x1ZGVzID0gWyIzNjAuY24iLCAiYW1hem9uLiIsICJhcHBsZS5jb20iLCAiYXNrLmNvbSIsICJiYWlkdS5jb20iLCAiYmluZy5jb20iLCAiYnVmZmVyYXBwLmNvbSIsICJjaGF0YW5nby5jb20iLCAiY2hyb21lYWN0aW9ucy5jb20iLCAiZWFzeWlucGxheS5uZXQiLCAiZWJheS5jb20iLCAiZmFjZWJvb2suY29tIiwgImZsYXR0ci5jb20iLCAiZmxpY2tyLmNvbSIsICJnaGFja3MubmV0IiwgImdvb2dsZS4iLCAiaW1kYi5jb20iLCAiaW1nYm94LmNvbSIsICJpbWd1ci5jb20iLCAiaW5zdGFncmFtLmNvbSIsICJqc2Jpbi5jb20iLCAianNmaWRkbGUubmV0IiwgImxpbmtlZGluLmNvbSIsICJsaXZlLmNvbSIsICJtYWlsLnJ1IiwgIm1pY3Jvc29mdC5jb20iLCAibXNuLmNvbSIsICJwYXlwYWwuY29tIiwgInBpbnRlcmVzdC5jb20iLCAicHJlbG9hZGVycy5uZXQiLCAicXEuY29tIiwgInJlZGRpdC5jb20iLCAic3RhY2tvdmVyZmxvdy5jb20iLCAidGFtcGVybW9ua2V5Lm5ldCIsICJ0d2l0dGVyLmNvbSIsICJ2aW1lby5jb20iLCAid2lraXBlZGlhLm9yZyIsICJ3M3NjaG9vbHMuY29tIiwgInlhaG9vLiIsICJ5YW5kZXgucnUiLCAieW91dHUuYmUiLCAieW91dHViZS5jb20iLCAieGVtdnR2Lm5ldCIsICJ2b2QucGwiLCAiYWdhci5pbyIsICJwYW5kb29uLmluZm8iLCAiZnNmLm9yZyIsICJhZGJsb2NrcGx1cy5vcmciLCAicGxua3IuY28iLCAiZXhhY3R0YXJnZXQuY29tIiwgImRvbGxkaXZpbmUuY29tIiwgInBvcG1lY2gucnUiLCAiY2FsbS5jb20iXTsKICAgICAgdmFyIGhvc3QgPSBsb2NhdGlvbi5ob3N0OwogICAgICB2YXIgZXhjbHVkZWQgPSBmYWxzZTsKICAgICAgZXhjbHVkZXMuZm9yRWFjaChmdW5jdGlvbiAoZXhjbHVkZSkgewogICAgICAgIGlmIChuZXcgUmVnRXhwKGV4Y2x1ZGUpLnRlc3QoaG9zdCkpIHsKICAgICAgICAgIGV4Y2x1ZGVkID0gdHJ1ZTsKICAgICAgICAgIGlmIChBYWsub3B0cy5sb2dFeGNsdWRlZCkgewogICAgICAgICAgICBBYWsud2FybignRXhjbHVkZWQnKTsKICAgICAgICAgIH0KICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9CiAgICAgIH0pOwoKICAgICAgLy8gSW5jbHVkZSBkb21haW5zCiAgICAgIC8vIElzRXZlbnR1cHBvcnRlZDogaHR0cDovL3Rpbnl1cmwuY29tL29lZXo4YzcKICAgICAgaWYgKCFleGNsdWRlZCkgewoKICAgICAgICB2YXIgaGFuZGxlckV2ZW50cyA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHZhciBydWxlID0gQWFrLnJ1bGVzW25hbWVdOwoKICAgICAgICAgIHJ1bGUuaG9zdC5mb3JFYWNoKGZ1bmN0aW9uIChob3N0KSB7CiAgICAgICAgICAgIC8vIENoZWNrIGhvc3QKICAgICAgICAgICAgaWYgKG5ldyBSZWdFeHAoaG9zdCkudGVzdChsb2NhdGlvbi5ob3N0KSkgewoKICAgICAgICAgICAgICAvLyBOYXRpdmUgbW9kZQogICAgICAgICAgICAgIGlmICghQWFrLnVzZUdNICYmIEFhay5pc1RvcGZyYW1lKSB7CiAgICAgICAgICAgICAgICBBYWsud2FybignUnVuIG5hdGl2ZWx5LicpOwogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgLy8gTG9nIHJ1bGUgdXNlZAogICAgICAgICAgICAgIGlmIChydWxlLmhvc3RbMF0gIT0gJy4qPycpIHsKICAgICAgICAgICAgICAgIEFhay5kZXRlY3RlZCgncnVsZScsIHJ1bGUpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAKICAgICAgICAgICAgICAvLyBCZWZvcmUgRE9NIGxvYWQKICAgICAgICAgICAgICBpZiAocnVsZS5vblN0YXJ0KSB7CiAgICAgICAgICAgICAgICBydWxlLm9uU3RhcnQoKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgLy8gT24gYWxsIHN0YXRlbWVudHMKICAgICAgICAgICAgICBpZiAocnVsZS5vbkFsd2F5cykgewogICAgICAgICAgICAgICAgcnVsZS5vbkFsd2F5cygpOyAvLyBzdGFydAogICAgICAgICAgICAgICAgQWFrLm9uRXZlbnQod2luZG93LCAnRE9NQ29udGVudExvYWRlZCcsIHJ1bGUub25BbHdheXMpOyAvLyBpZGxlCiAgICAgICAgICAgICAgICBBYWsub25FdmVudCh3aW5kb3csICdsb2FkJywgcnVsZS5vbkFsd2F5cyk7IC8vIGVuZAogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAvLyBCZWZvcmUgU2NyaXB0IEV4ZWN1dGVkCiAgICAgICAgICAgICAgaWYgKHJ1bGUub25CZWZvcmVTY3JpcHQpIHsKCiAgICAgICAgICAgICAgICAvLyBvcHRpb25zOiBjb250YWlucywgc2VhcmNoLCByZXBsYWNlLCBvdmVycmlkZSwgcmVtb3ZlLCBleHRlcm5hbAogICAgICAgICAgICAgICAgdmFyIG9wdGlvbnNCZWZvcmVTY3JpcHQgPSBydWxlLm9uQmVmb3JlU2NyaXB0KCk7CiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIG9wdGlvbnNCZWZvcmVTY3JpcHQgPT0gIm9iamVjdCIpIHsKCiAgICAgICAgICAgICAgICAgIHZhciBoYW5kbGVyQmVmb3JlU2NyaXB0ID0gZnVuY3Rpb24gKGUsIG9wdGlvbnMpIHsKICAgICAgICAgICAgICAgICAgICB2YXIgaXNFdmVudCA9IGUgaW5zdGFuY2VvZiB3aW5kb3cuRXZlbnQ7CiAgICAgICAgICAgICAgICAgICAgdmFyIHRoaXNTY3JpcHQgPSAoZS50YXJnZXQgfHwgZS5zcmNFbGVtZW50KSB8fCBlOwoKICAgICAgICAgICAgICAgICAgICBvcHRpb25zLmZvckVhY2goZnVuY3Rpb24gKG8pIHsgLy8gaGFzQXR0cmlidXRlCiAgICAgICAgICAgICAgICAgICAgICB2YXIgc3JjID0gby5leHRlcm5hbCA/ICdzcmMnIDogJ2lubmVySFRNTCc7CiAgICAgICAgICAgICAgICAgICAgICB2YXIgc2VhcmNoID0gbmV3IFJlZ0V4cChvLmNvbnRhaW5zLCBvLmZsYWdzIHx8ICcnKTsKCiAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpc1NjcmlwdFtzcmNdICYmIHRoaXNTY3JpcHRbc3JjXS5sZW5ndGggJiYgc2VhcmNoLnRlc3QodGhpc1NjcmlwdFtzcmNdKSkgewoKICAgICAgICAgICAgICAgICAgICAgICAgLy8gU3RvcCBzY3JpcHQgZXhlY3V0aW9uCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpc0V2ZW50KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOwogICAgICAgICAgICAgICAgICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIENyZWF0ZSBuZXcgc2NyaXB0CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwYXJlbnQgPSB0aGlzU2NyaXB0LnBhcmVudE5vZGU7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBuZXdTY3JpcHQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzY3JpcHQnKTsKCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFJlcGxhY2UgYSBwYXJ0IG9mIHRoZSBzY3JpcHQKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG8ucmVwbGFjZSkgewogICAgICAgICAgICAgICAgICAgICAgICAgIG5ld1NjcmlwdFtzcmNdID0gdGhpc1NjcmlwdFtzcmNdLnJlcGxhY2Uoc2VhcmNoLCBvLnJlcGxhY2UpOwogICAgICAgICAgICAgICAgICAgICAgICAgIHBhcmVudC5yZXBsYWNlQ2hpbGQobmV3U2NyaXB0LCB0aGlzU2NyaXB0KTsKICAgICAgICAgICAgICAgICAgICAgICAgfSAvLyBPdmVycmlkZSBzY3JpcHQKICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAoby5vdmVycmlkZSkgewogICAgICAgICAgICAgICAgICAgICAgICAgIG5ld1NjcmlwdFtzcmNdID0gby5vdmVycmlkZTsKICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJlbnQucmVwbGFjZUNoaWxkKG5ld1NjcmlwdCwgdGhpc1NjcmlwdCk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0gLy8gUmVtb3ZlIHNjcmlwdAogICAgICAgICAgICAgICAgICAgICAgICBlbHNlIGlmIChvLnJlbW92ZSkgewogICAgICAgICAgICAgICAgICAgICAgICAgIHBhcmVudC5yZW1vdmVDaGlsZCh0aGlzU2NyaXB0KTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG8uZGV0ZWN0ZWQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICBBYWsuZGV0ZWN0ZWQoby5kZXRlY3RlZCk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0JCQkJCQkKCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChBYWsub3B0cy5sb2dJbnRlcmNlcHRlZFNjcmlwdHMpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICBBYWsubG9nKHNyYywgbywgdGhpc1NjcmlwdCwgbmV3U2NyaXB0KTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICB9OwoKICAgICAgICAgICAgICAgICAgLy8gQnJvd3NlciBzdXBwb3J0aW5nIGV2ZW50IGJlZm9yZXNjcmlwdGV4ZWN1dGUKICAgICAgICAgICAgICAgICAgaWYgKCdvbmJlZm9yZXNjcmlwdGV4ZWN1dGUnIGluIGRvY3VtZW50KSB7CiAgICAgICAgICAgICAgICAgICAgQWFrLm9uRXZlbnQod2luZG93LCAnYmVmb3Jlc2NyaXB0ZXhlY3V0ZScsIGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICAgICAgICAgICAgICBoYW5kbGVyQmVmb3JlU2NyaXB0KGUsIG9wdGlvbnNCZWZvcmVTY3JpcHQpOwogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICB9IGVsc2UgeyAvLyBCcm93c2VyIG5vdCBzdXBwb3RpbmcgYmVmb3Jlc2NyaXB0ZXhlY3V0ZQoKICAgICAgICAgICAgICAgICAgICB2YXIgbG9hZERvY3VtZW50ID0gZnVuY3Rpb24gKG9wdGlvbnNCZWZvcmVTY3JpcHQpIHsKICAgICAgICAgICAgICAgICAgICAgIC8vaWYgKGRvY3VtZW50LnJlZmVycmVyID09PSAnJykKICAgICAgICAgICAgICAgICAgICAgIC8vcmV0dXJuOwoKICAgICAgICAgICAgICAgICAgICAgIEFhay53YXJuKCdvbmJlZm9yZXNjcmlwdC1jb21wYXRpYmxlJyk7CgogICAgICAgICAgICAgICAgICAgICAgLy8gU3RvcCBsb2FkaW5nCiAgICAgICAgICAgICAgICAgICAgICBBYWsuYWRkU2NyaXB0KCd3aW5kb3cuc3RvcCgpOycpOyAvLyBjaHJvbWUvb3BlcmEKICAgICAgICAgICAgICAgICAgICAgIC8vQWFrLmFkZFNjcmlwdCgnZG9jdW1lbnQub3BlbigpOycpOyAvLyBmaXJlZm94CgogICAgICAgICAgICAgICAgICAgICAgLy8gR2V0IGNvbnRlbnQKICAgICAgICAgICAgICAgICAgICAgIEFhay5yZXF1ZXN0KHsKICAgICAgICAgICAgICAgICAgICAgICAgdXJsIDogbG9jYXRpb24uaHJlZiwKICAgICAgICAgICAgICAgICAgICAgICAgaGVhZGVycyA6IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAiUmVmZXJlciIgOiBkb2N1bWVudC5yZWZlcnJlcgogICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICBvbmxvYWQgOiBmdW5jdGlvbiAocmVzdWx0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGh0bWwgPSByZXN1bHQucmVzcG9uc2VUZXh0OwogICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwYXJzZXIgPSBuZXcgd2luZG93LkRPTVBhcnNlcigpOwogICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkb2MgPSBwYXJzZXIucGFyc2VGcm9tU3RyaW5nKGh0bWwsICJ0ZXh0L2h0bWwiKTsKICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc2NyaXB0cyA9IGRvYy5zY3JpcHRzOwoKICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNjcmlwdHMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0aGlzU2NyaXB0ID0gc2NyaXB0c1tpXTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhhbmRsZXJCZWZvcmVTY3JpcHQodGhpc1NjcmlwdCwgb3B0aW9uc0JlZm9yZVNjcmlwdCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBDb252ZXJ0IHRvIHN0cmluZwogICAgICAgICAgICAgICAgICAgICAgICAgIGh0bWwgPSBkb2MuZG9jdW1lbnRFbGVtZW50Lm91dGVySFRNTDsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gV3JpdGUgbmV3IGNvbnRlbnQgdG8gSFRNTCBkb2N1bWVudDoKICAgICAgICAgICAgICAgICAgICAgICAgICBBYWsuYWRkU2NyaXB0KCdkb2N1bWVudC5vcGVuKCk7IGRvY3VtZW50LndyaXRlKHVuZXNjYXBlKCInICsgd2luZG93LmVzY2FwZShodG1sKSArICciKSk7IGRvY3VtZW50LmNsb3NlKCk7Jyk7IC8vIGNocm9tZS9vcGVyYQogICAgICAgICAgICAgICAgICAgICAgICAgIC8vQWFrLmFkZFNjcmlwdCgnZG9jdW1lbnQud3JpdGUodW5lc2NhcGUoIicgKyBlc2NhcGUoaHRtbCkgKyAnIikpOyBkb2N1bWVudC5jbG9zZSgpOycpOyAvLyBmaXJlZm94CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgbG9hZERvY3VtZW50KG9wdGlvbnNCZWZvcmVTY3JpcHQpOwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfSAvLyBBZnRlciBTY3JpcHQgRXhlY3V0ZWQKICAgICAgICAgICAgICBpZiAocnVsZS5vbkFmdGVyU2NyaXB0KSB7CiAgICAgICAgICAgICAgICBpZiAoJ29uYWZ0ZXJzY3JpcHRleGVjdXRlJyBpbiBkb2N1bWVudCkgeyAvLyBNb3ppbGxhIEZpcmVmb3gKICAgICAgICAgICAgICAgICAgQWFrLm9uRXZlbnQod2luZG93LCAnYWZ0ZXJzY3JpcHRleGVjdXRlJywgcnVsZS5vbkFmdGVyU2NyaXB0KTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgLy8gV2hlbiBET00gTG9hZAogICAgICAgICAgICAgIGlmIChydWxlLm9uSWRsZSkgewogICAgICAgICAgICAgICAgaWYgKCFBYWsudXNlR00pIHsgLy8gTmF0aXZlIG1vZGUKICAgICAgICAgICAgICAgICAgcnVsZS5vbklkbGUoKTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgIC8vQWFrLm9uRXZlbnQod2luZG93LCAnRE9NQ29udGVudExvYWRlZCcsIHJ1bGUub25JZGxlKTsKICAgICAgICAgICAgICAgICAgQWFrLm9uRXZlbnQod2luZG93LCAnRE9NQ29udGVudExvYWRlZCcsIHJ1bGUub25JZGxlKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgLy8gV2hlbiBXaW5kb3cgTG9hZAogICAgICAgICAgICAgIGlmIChydWxlLm9uRW5kKSB7CiAgICAgICAgICAgICAgICBpZiAoIUFhay51c2VHTSkgeyAvLyBOYXRpdmUgbW9kZQogICAgICAgICAgICAgICAgICBydWxlLm9uRW5kKCk7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICBBYWsub25FdmVudCh3aW5kb3csICdsb2FkJywgcnVsZS5vbkVuZCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIC8vIFdoZW4gRE9NIEF0dHJNb2RpZmllZAogICAgICAgICAgICAgIGlmIChydWxlLm9uQXR0ck1vZGlmaWVkKSB7CiAgICAgICAgICAgICAgICBBYWsub25FdmVudCh3aW5kb3csICdET01BdHRyTW9kaWZpZWQnLCBydWxlLm9uQXR0ck1vZGlmaWVkLCBmYWxzZSk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIC8vIFdoZW4gRE9NIFN1YnRyZWVNb2RpZmllZAogICAgICAgICAgICAgIGlmIChydWxlLm9uU3VidHJlZU1vZGlmaWVkKSB7CiAgICAgICAgICAgICAgICBBYWsub25FdmVudCh3aW5kb3csICdET01TdWJ0cmVlTW9kaWZpZWQnLCBydWxlLm9uU3VidHJlZU1vZGlmaWVkLCBmYWxzZSk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIC8vIFdoZW4gRE9NIEVsZW1lbnRzIGFyZSBJbnNlcnRlZCBpbiBEb2N1bWVudAogICAgICAgICAgICAgIGlmIChydWxlLm9uSW5zZXJ0KSB7CgogICAgICAgICAgICAgICAgLy8gTXV0YXRpb24gT2JzZXJ2ZXIKICAgICAgICAgICAgICAgIC8vIGRvYzogaHR0cDovL3Rpbnl1cmwuY29tL214eHplZTQKICAgICAgICAgICAgICAgIC8vIHN1cHBvcnQ6IGh0dHA6Ly90aW55dXJsLmNvbS9uZXBuN3Z5CiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHdpbmRvdy5NdXRhdGlvbk9ic2VydmVyICE9ICd1bmRlZmluZWQnIHx8CiAgICAgICAgICAgICAgICAgIHR5cGVvZiBXZWJLaXRNdXRhdGlvbk9ic2VydmVyICE9ICd1bmRlZmluZWQnKSB7CgogICAgICAgICAgICAgICAgICAvLyBNdXRhdGlvbiBPYnNlcnZlcgogICAgICAgICAgICAgICAgICB2YXIgTXV0YXRpb25PYnNlcnZlcjEgPSB3aW5kb3cuTXV0YXRpb25PYnNlcnZlciB8fCB3aW5kb3cuV2ViS2l0TXV0YXRpb25PYnNlcnZlcjsKCiAgICAgICAgICAgICAgICAgIC8vIENyZWF0ZSBhbiBvYnNlcnZlciBpbnN0YW5jZQogICAgICAgICAgICAgICAgICB2YXIgb2JzMSA9IG5ldyBNdXRhdGlvbk9ic2VydmVyMShmdW5jdGlvbiAobXV0YXRpb25zKSB7CiAgICAgICAgICAgICAgICAgICAgICAvLyBXZSBjYW4gc2FmZWx5IHVzZSBgZm9yRWFjaGAgYmVjYXVzZSB3ZSBhbHJlYWR5IHVzZSBtdXRhdGlvbgogICAgICAgICAgICAgICAgICAgICAgLy8gb2JzZXJ2ZXJzIHRoYXQgYXJlIG1vcmUgcmVjZW50IHRoYW4gYGZvckVhY2hgLiAoc291cmNlOiBNRE4pCiAgICAgICAgICAgICAgICAgICAgICBtdXRhdGlvbnMuZm9yRWFjaChmdW5jdGlvbiAobXV0YXRpb24pIHsKICAgICAgICAgICAgICAgICAgICAgICAgLy8gd2Ugd2FudCBvbmx5IGFkZGVkIG5vZGVzCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChtdXRhdGlvbi5hZGRlZE5vZGVzLmxlbmd0aCkgewogICAgICAgICAgICAgICAgICAgICAgICAgIEFycmF5LnByb3RvdHlwZS5mb3JFYWNoLmNhbGwobXV0YXRpb24uYWRkZWROb2RlcywgZnVuY3Rpb24gKGFkZGVkTm9kZSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKEFhay5vcHRzLmxvZ0luc2VydGVkTm9kZXMpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQWFrLmxvZyhhZGRlZE5vZGUpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcnVsZS5vbkluc2VydChhZGRlZE5vZGUpOwogICAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgLy8gT2JzZXJ2ZXIKICAgICAgICAgICAgICAgICAgb2JzMS5vYnNlcnZlKGRvY3VtZW50LCB7CiAgICAgICAgICAgICAgICAgICAgY2hpbGRMaXN0IDogdHJ1ZSwKICAgICAgICAgICAgICAgICAgICBzdWJ0cmVlIDogdHJ1ZQogICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIC8vIE11dGF0aW9uIEV2ZW50cyAoQWx0ZXJuYXRpdmUgU29sdXRpb24pCiAgICAgICAgICAgICAgICAvLyBkb2M6IGh0dHA6Ly90aW55dXJsLmNvbS9vcDk1cmZ5CiAgICAgICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICAgQWFrLm9uRXZlbnQod2luZG93LCAiRE9NTm9kZUluc2VydGVkIiwgZnVuY3Rpb24gKGUpIHsKICAgICAgICAgICAgICAgICAgICBpZiAoQWFrLm9wdHMubG9nSW5zZXJ0ZWROb2RlcykgewogICAgICAgICAgICAgICAgICAgICAgQWFrLmxvZyhlLnRhcmdldCk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIHJ1bGUub25JbnNlcnQoZS50YXJnZXQpOwogICAgICAgICAgICAgICAgICB9LCBmYWxzZSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIC8vIFdoZW4gRE9NIEVsZW1lbnRzIGFyZSBSZW1vdmVkIGluIERvY3VtZW50CiAgICAgICAgICAgICAgaWYgKHJ1bGUub25SZW1vdmUpIHsKCiAgICAgICAgICAgICAgICAvLyBNdXRhdGlvbiBPYnNlcnZlcgogICAgICAgICAgICAgICAgLy8gZG9jOiBodHRwOi8vdGlueXVybC5jb20vbXh4emVlNAogICAgICAgICAgICAgICAgLy8gc3VwcG9ydDogaHR0cDovL3Rpbnl1cmwuY29tL25lcG43dnkKICAgICAgICAgICAgICAgIGlmICh0eXBlb2Ygd2luZG93Lk11dGF0aW9uT2JzZXJ2ZXIgIT0gJ3VuZGVmaW5lZCcgfHwKICAgICAgICAgICAgICAgICAgdHlwZW9mIFdlYktpdE11dGF0aW9uT2JzZXJ2ZXIgIT0gJ3VuZGVmaW5lZCcpIHsKCiAgICAgICAgICAgICAgICAgIC8vIE11dGF0aW9uIE9ic2VydmVyCiAgICAgICAgICAgICAgICAgIHZhciBNdXRhdGlvbk9ic2VydmVyMiA9IHdpbmRvdy5NdXRhdGlvbk9ic2VydmVyIHx8IHdpbmRvdy5XZWJLaXRNdXRhdGlvbk9ic2VydmVyOwoKICAgICAgICAgICAgICAgICAgLy8gQ3JlYXRlIGFuIG9ic2VydmVyIGluc3RhbmNlCiAgICAgICAgICAgICAgICAgIHZhciBvYnMyID0gbmV3IE11dGF0aW9uT2JzZXJ2ZXIyKGZ1bmN0aW9uIChtdXRhdGlvbnMpIHsKICAgICAgICAgICAgICAgICAgICAgIC8vIFdlIGNhbiBzYWZlbHkgdXNlIGBmb3JFYWNoYCBiZWNhdXNlIHdlIGFscmVhZHkgdXNlIG11dGF0aW9uCiAgICAgICAgICAgICAgICAgICAgICAvLyBvYnNlcnZlcnMgdGhhdCBhcmUgbW9yZSByZWNlbnQgdGhhbiBgZm9yRWFjaGAuIChzb3VyY2U6IE1ETikKICAgICAgICAgICAgICAgICAgICAgIG11dGF0aW9ucy5mb3JFYWNoKGZ1bmN0aW9uIChtdXRhdGlvbikgewogICAgICAgICAgICAgICAgICAgICAgICAvLyB3ZSB3YW50IG9ubHkgcmVtb3ZlZCBub2RlcwogICAgICAgICAgICAgICAgICAgICAgICBpZiAobXV0YXRpb24ucmVtb3ZlZE5vZGVzLmxlbmd0aCkgewogICAgICAgICAgICAgICAgICAgICAgICAgIEFycmF5LnByb3RvdHlwZS5mb3JFYWNoLmNhbGwobXV0YXRpb24ucmVtb3ZlZE5vZGVzLCBmdW5jdGlvbiAocmVtb3ZlZE5vZGUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChBYWsub3B0cy5sb2dSZW1vdmVkTm9kZXMpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQWFrLmxvZyhyZW1vdmVkTm9kZSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBydWxlLm9uUmVtb3ZlKHJlbW92ZWROb2RlKTsKICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgIC8vIE9ic2VydmVyCiAgICAgICAgICAgICAgICAgIG9iczIub2JzZXJ2ZShkb2N1bWVudCwgewogICAgICAgICAgICAgICAgICAgIGNoaWxkTGlzdCA6IHRydWUsCiAgICAgICAgICAgICAgICAgICAgc3VidHJlZSA6IHRydWUKICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAvLyBNdXRhdGlvbiBFdmVudHMgKEFsdGVybmF0aXZlIFNvbHV0aW9uKQogICAgICAgICAgICAgICAgLy8gZG9jOiBodHRwOi8vdGlueXVybC5jb20vb3A5NXJmeQogICAgICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAgIEFhay5vbkV2ZW50KHdpbmRvdywgIkRPTU5vZGVSZW1vdmVkIiwgZnVuY3Rpb24gKGUpIHsKICAgICAgICAgICAgICAgICAgICBpZiAoQWFrLm9wdHMubG9nUmVtb3ZlZE5vZGVzKSB7CiAgICAgICAgICAgICAgICAgICAgICBBYWsubG9nKGUudGFyZ2V0KTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgcnVsZS5vblJlbW92ZShlLnRhcmdldCk7CiAgICAgICAgICAgICAgICAgIH0sIGZhbHNlKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgLy8gQWFrIEV2ZW50cwogICAgICAgICAgICAgIEFhay5vbkV2ZW50KHdpbmRvdywgJ2RldGVjdGVkJywgZnVuY3Rpb24gKGUpIHsKICAgICAgICAgICAgICAgIEFhay5pbmZvKFsnQW50aUFkYktpbGxlcicsIEFhay5pc1RvcGZyYW1lID8gJ3RvcGZyYW1lJyA6ICdzdWJmcmFtZScsIGxvY2F0aW9uLmhvc3QsIGUuZGV0YWlsXSk7CiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgCiAgICAgICAgICAgIH0KICAgICAgICAgIH0pOwogICAgICAgIH07CgogICAgICAgIC8vIEFwcGx5IHJ1bGVzCiAgICAgICAgZm9yICh2YXIgbmFtZSBpbiBBYWsucnVsZXMpIHsKICAgICAgICAgIGlmIChBYWsucnVsZXMuaGFzT3duUHJvcGVydHkobmFtZSkpIHsKICAgICAgICAgICAgaGFuZGxlckV2ZW50cyhBYWssIG5hbWUpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgfQogIH07CgogIEFhay5pbml0aWFsaXplKCk7Cgp9KSh3aW5kb3cpOw=="},{"name":"User Defined Redirects","options":{"awareOfChrome":false,"check_for_updates":true,"comment":null,"compat_arrayleft":false,"compat_foreach":false,"compat_forvarin":false,"compat_metadata":false,"compat_uW_gmonkey":false,"compat_wrappedjsobject":false,"compatopts_for_requires":true,"noframes":null,"override":{"merge_connects":true,"merge_excludes":true,"merge_includes":true,"merge_matches":true,"orig_connects":[],"orig_excludes":[],"orig_includes":["*://tappedout.com/*","*://www.tappedout.com/*","*://*pixlr.com/*"],"orig_matches":[],"orig_noframes":null,"orig_run_at":"document-idle","use_blockers":[],"use_connects":[],"use_excludes":[],"use_includes":[],"use_matches":[]},"run_at":null},"storage":{"ts":1525457219824,"data":{}},"enabled":false,"position":11,"uuid":"2466c71c-a9fc-4009-ae14-73b8e2ccb476","source":"Ly8gPT1Vc2VyU2NyaXB0PT0KLy8gQG5hbWUgICAgICAgICBVc2VyIERlZmluZWQgUmVkaXJlY3RzCi8vIEBuYW1lc3BhY2UgICAgaHR0cDovL2JyaWNlc2hhdHplci5jb20KLy8gQHZlcnNpb24gICAgICAwLjEKLy8gQGRlc2NyaXB0aW9uICBSZWRpcmVjdHMgdGhhdCBzcGVlZCB0aGluZ3Mgb3IgY2F0Y2ggbWlzdGFrZXMKLy8gQGF1dGhvciAgICAgICBodHRwczovL2dpdGh1Yi5jb20vQnJpY2VTaGF0emVyCi8vIEBpbmNsdWRlICAgICAgKjovL3RhcHBlZG91dC5jb20vKgovLyBAaW5jbHVkZSAgICAgICo6Ly93d3cudGFwcGVkb3V0LmNvbS8qCi8vIEBpbmNsdWRlICAgICAgKjovLypwaXhsci5jb20vKgovLyBAZ3JhbnQgICAgICAgIG5vbmUKLy8gPT0vVXNlclNjcmlwdD09CgooZnVuY3Rpb24oKSB7CiAgICAndXNlIHN0cmljdCc7CiAgICBsZXQgY3VycmVudExvY2F0aW9uID0gZ2V0Q3VycmVudExvY2F0aW9uKCk7CgogICAgLy8gUGl4bHIKICAgIGlmIChjdXJyZW50TG9jYXRpb24uaG9zdG5hbWUuaW5jbHVkZXMoInBpeGxyIikgJiYgY3VycmVudExvY2F0aW9uLnBhdGhuYW1lID09PSAiLyIpIHsKICAgICAgICBzZXRDdXJyZW50TG9jYXRpb24oImh0dHBzOi8vcGl4bHIuY29tL2VkaXRvciIpOwogICAgfQoKICAgIC8vdGFwcGVkb3V0CiAgICBpZiAoY3VycmVudExvY2F0aW9uLmhvc3RuYW1lLmluY2x1ZGVzKCJ0YXBwZWRvdXQuY29tIikpIHsKICAgICAgICBzZXRDdXJyZW50TG9jYXRpb24oImh0dHA6Ly90YXBwZWRvdXQubmV0Iik7CiAgICB9CgogICAgLy8gdXRpbGl0eSBmdW5jdGlvbnMKICAgIGZ1bmN0aW9uIGdldEN1cnJlbnRMb2NhdGlvbigpIHsKICAgICAgICByZXR1cm4gd2luZG93LmxvY2F0aW9uOwogICAgfQogICAgZnVuY3Rpb24gc2V0Q3VycmVudExvY2F0aW9uKGhyZWYpIHsKICAgICAgICB3aW5kb3cubG9jYXRpb24gPSBocmVmOwogICAgfQoKCiAgICAvLyBZb3VyIGNvZGUgaGVyZS4uLgp9KSgpOw=="},{"name":"Twitter Play In Background","options":{"awareOfChrome":false,"check_for_updates":true,"comment":null,"compat_arrayleft":false,"compat_foreach":false,"compat_forvarin":false,"compat_metadata":false,"compat_uW_gmonkey":false,"compat_wrappedjsobject":false,"compatopts_for_requires":true,"noframes":null,"override":{"merge_connects":true,"merge_excludes":true,"merge_includes":true,"merge_matches":true,"orig_connects":[],"orig_excludes":[],"orig_includes":[],"orig_matches":["https://twitter.com/*"],"orig_noframes":null,"orig_run_at":"document-idle","use_blockers":[],"use_connects":[],"use_excludes":[],"use_includes":[],"use_matches":[]},"run_at":null},"storage":{"ts":1540395585760,"data":{}},"enabled":false,"position":12,"uuid":"9ba71427-1c5d-4dde-867e-017733f3455a","source":"Ly8gPT1Vc2VyU2NyaXB0PT0KLy8gQG5hbWUgICAgICAgICBUd2l0dGVyIFBsYXkgSW4gQmFja2dyb3VuZAovLyBAbmFtZXNwYWNlICAgIGh0dHA6Ly90d2l0dGVyLmNvbS8KLy8gQHZlcnNpb24gICAgICAwLjEKLy8gQGRlc2NyaXB0aW9uICBUd2l0dGVyIFBhZ2UgVmlzaWJpbGl0eSBBUEkgQmxvY2tlcgovLyBAYXV0aG9yICAgICAgIHdwZWFycwovLyBAbWF0Y2ggICAgICAgIGh0dHBzOi8vdHdpdHRlci5jb20vKgovLyBAZ3JhbnQgICAgICAgIG5vbmUKLy8gPT0vVXNlclNjcmlwdD09CgooZnVuY3Rpb24oKSB7CiAgICAndXNlIHN0cmljdCc7CiAgICB2YXIgcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NjcmlwdCcpCiAgICBzLnRleHRDb250ZW50ID0KICAgICAgICAnKGZ1bmN0aW9uKCkgeycgKwogICAgICAgICd2YXIgYSA9IE5vZGUucHJvdG90eXBlLmFkZEV2ZW50TGlzdGVuZXI7JyArCiAgICAgICAgJ05vZGUucHJvdG90eXBlLmFkZEV2ZW50TGlzdGVuZXIgPSBmdW5jdGlvbihlKSB7JyArCiAgICAgICAgImlmIChlICE9PSAndmlzaWJpbGl0eWNoYW5nZScgJiYgZSAhPT0gJ3dlYmtpdHZpc2liaWxpdHljaGFuZ2UnKSB7IiArCiAgICAgICAgJ2EuYXBwbHkodGhpcywgYXJndW1lbnRzKScgKwogICAgICAgICd9fScgKwogICAgICAgICd9KSgpJwogICAgOyhkb2N1bWVudC5oZWFkIHx8IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudCkuYXBwZW5kQ2hpbGQocykKICAgIHMucmVtb3ZlKCkKfSkoKTs="}]}